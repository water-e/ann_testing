module fnet_X2

! a = 0.016438
! b = -0.68678

intrinsic Reshape
real, dimension(8,54) :: input = &
  Reshape((/0.704206649305,-0.868344412938,1.219647161481,0.050733965080,-0.731568622808,0.522024554819,-3.659139576732,-0.770241066048,-0.189689457390,0.196520948801,-0.067061526404,-0.062766934045 &
            ,-0.318081483567,0.888605102437,-3.074662147815,3.022809285414,3.851745249362,-0.548392772877,2.847330015017,-1.070226830565,-2.213053526957,1.270342269204,-3.671977003824,-0.542646526603 &
            ,6.023138417656,0.219895206466,-1.656616305563,-0.455117119056,-0.230160616591,0.641764650684,-0.007774895301,2.446967709543,7.878781573441,-0.497144282766,1.846814934540,-1.132775980509 &
            ,-0.045769214478,1.284881550894,-0.945329557185,0.885274576953,3.951977263175,1.181420732110,-1.621835379204,-0.032488321524,1.837444961416,-0.308710165526,4.446976275636,3.953479727584 &
            ,2.836276304832,0.118599442580,0.917810540936,0.565423607448,0.988193743449,-0.610998905463,0.178070256100,-0.197501053153,-4.036752229611,1.268326398369,-2.599218364322,2.098550045452 &
            ,2.773214293717,-2.418385605565,1.674940644012,5.059640817472,-8.181447011684,0.928188006316,1.581233783747,0.292068905771,0.115703433014,-0.216224959405,-2.735977130050,5.071288577686 &
            ,-0.557771561187,0.952318048676,-1.821513667664,0.423295787082,0.790187966440,0.036909015936,-2.002136859495,5.371425640322,-1.019678749760,0.015541328909,0.169383594241,-0.041294736689 &
            ,-0.050147361768,0.076833585566,-0.112548040007,-0.587910899269,-0.962531393249,-0.093186477364,0.077566471944,-0.033774602844,0.119368056266,0.049719420746,-0.422362675464,0.634286435033 &
            ,0.462571165412,0.109164315747,0.152246008006,-0.045122952801,0.175047130794,-0.090992906036,0.037785464190,1.183280788602,-1.050454767699,0.147884933645,0.080395923629,-0.109353985281 &
            ,-0.439582644355,0.323357623011,-0.611364775309,-0.543036141380,-0.693823575724,-0.188525992507,-0.033556503466,-0.050637093064,0.026383116134,-0.025278649445,-0.194974837698,0.198061399538 &
            ,0.726178228036,0.095783976740,-0.002314300466,-0.215072312637,-0.426843294418,0.318190865101,-0.515631240025,0.488983519376,0.054542875715,0.050114376340,0.081287679436,-0.069176090371 &
            ,0.206712287814,-0.077792194994,0.097731056992,0.756836025890,-0.883470990183,-0.453901892391,-0.442525890218,-0.202024099990,-0.414276496944,0.254981594909,-0.789291145183,-0.775311533791 &
            ,1.461178990504,0.160622125684,0.131091679063,-0.104219218213,-0.295724980138,0.227316052057,-0.171169257229,-0.223662327209,-1.775944056978,-0.129006898391,-0.005904297527,0.019074566311 &
            ,0.334605612380,-0.156506853715,0.245361629459,0.338257588500,1.356821165012,0.193258713583,-0.207868344866,0.040768598546,-0.754929493112,0.317771861262,-0.515345097713,-1.132322546889 &
            ,1.256074134033,-0.070374824371,0.235432809219,-0.120117801308,-0.322209750132,0.185315989074,-0.438507898057,-0.318330336815,-3.849143877893,-0.117447479712,-0.091474773864,0.119444788166 &
            ,0.628988925747,-0.310259127562,0.705367946356,0.165983074292,-1.618280677956,0.143168330470,-0.168871804798,-0.079966268201,-0.817185402751,0.199960914831,0.450491982804,-1.271927589162 &
            ,-0.246284118235,0.039220181536,0.107513397740,0.016852545780,0.248624490363,-0.116710005118,0.257242183180,0.112143448075,7.445144783404,0.033001073812,-0.190327176462,0.145895741371 &
            ,0.799533497706,-0.245550556160,0.753583138824,0.727123648310,-2.307603639258,-0.002641573396,0.128573532617,-0.163889515275,-0.415314016574,0.317350510476,-0.456717658461,-0.457385601663 &
            ,-0.836760609583,0.013815008404,0.251620311440,-0.078273669447,-0.332987849063,0.153259327213,-0.650502306301,0.186311504435,0.184996693004,-0.100852429204,0.020530022896,-0.005019665670 &
            ,-0.025307268899,0.005207945964,-0.119143227147,-0.169152667736,-2.516048884602,-0.045739948381,-0.038924295310,0.010369831835,0.086131809456,-0.074509913374,0.098257333614,0.287354142346 &
            ,0.109035960948,0.014421246042,0.068601074556,0.030604383674,0.116573388978,-0.044759867314,0.055587317271,0.023544468423,0.609901216394,-0.088219225039,0.170448654332,-0.043465836378 &
            ,-0.496845284093,0.593525742275,-1.926033293111,-0.240538286670,0.903330550583,0.030031074677,-0.024563876719,-0.023803618526,0.136203068341,0.037706974761,0.072451951640,0.259616972162 &
            ,0.262147223473,0.014277098914,0.025937116422,-0.010845564833,0.068805617496,0.051102756684,-0.099709400671,0.252971118521,0.362846579424,-0.005684086246,0.016563997499,0.053878343634 &
            ,-0.025077337530,0.063019091428,-0.304654095313,-0.201182281701,-0.462824056894,-0.004768092121,-0.078636152710,0.022748903545,-0.194968011367,0.062241130467,-0.322275657904,0.238378827846 &
            ,-1.099550836360,-3.199426139989,-0.095692299221,-0.123671862795,-0.792731871090,0.207412473915,-0.050281569299,-5.221336463749,-1.527676302251,-3.454632312999,0.050307052502,-0.075890866828 &
            ,-0.322898301047,0.043289099991,0.304455379455,-6.454788211208,-0.720979911503,-6.665847234657,0.065585530332,-0.257710120036,0.657962426883,-0.542059630570,2.898738005023,-10.873556865826 &
            ,1.130506017966,1.255506316267,-0.318488648311,0.382378646870,-0.581743652682,0.618516951474,-2.755975701094,2.409001662038,-0.365240777233,-7.159932849184,-0.343268480432,0.240380077399 &
            ,0.063805075416,-0.345390162437,-0.105541129369,-9.674644602975,-3.605139704871,-4.164338529724,0.191048017358,-0.167966922298,-0.076641282925,0.085304347522,0.133271033915,2.095669451341 &
            ,1.404189795105,-4.896890935971,-0.247729776489,0.090345705699,-1.112754119641,-0.307302459679,0.000675568779,-0.230160301415,1.458845600865,-19.142794622773,-0.784500704262,-0.099962570062 &
            ,-1.776727645407,0.729972467760,0.935347822882,-15.769870044752,5.744925075173,-14.106045688050,0.106975564533,0.295497383940,3.361486049289,4.868541505527,-6.732331523991,-2.067656130379 &
            ,4.819305345893,-7.360610258665,4.115196689433,0.264783292867,7.656589376502,13.300578641937,-0.732164397034,9.877104728497,5.702408579190,3.720425804197,1.495743310850,0.220090267845 &
            ,2.272046068292,5.457060687903,0.022868637396,-3.143454971619,1.251895953461,0.053107747527,1.022367122373,0.104581351529,-0.251558840421,3.441425222364,-2.071568733707,-5.857113315189 &
            ,0.227823857421,-0.311823383129,1.894228138585,-0.094323020309,-0.987236226534,3.403754637454,-1.199759349392,-4.414753475708,-0.956224829288,1.712281488835,2.841017408570,-0.149777407461 &
            ,-1.985590466627,4.353916374651,-3.132209989891,-4.607682575082,-1.607210008431,0.441452858343,3.500270151863,0.034872092796,-0.817615198365,2.996375023272,-1.830151264496,-4.371656437920 &
            ,-1.892076487597,0.455854854306,3.809970635370,0.387198808611,-1.551527279989,2.647920990545,-2.268893202713,-5.612756958200,1.259242446217,-0.243720511555,2.122217986476,1.142217799449 &
            ,0.437193757799,0.214421371564,4.066654413219,-6.468197490934,3.878436039691,-1.404567027163,3.976202779724,0.935026378888,1.708954974411,-2.132046289510,2.586442853754,-5.397555467343 &
            /),(/8,54/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/-0.098961,-14.8186 &
            ,1.9685,-13.2733,-1.7699,-3.8161 &
            ,-8.4518,7.4611 &
            ,0.47709,31.9785 &
            ,-1.3355,18.514 &
            ,-0.52764,-2.5198 &
            ,-0.23837,-5.5553 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/12.0335,-0.063396/),(/1,2/))
real, dimension(8) :: bias1 = &
  (/-1.046,3.7756,-5.5698,-2.8863,-2.1601,-6.3682,7.9544,-1.2868/)
real, dimension(2) :: bias2 = &
  (/-1.625,-1.3535/)
real, dimension(1) :: bias3 = &
  (/0.19081/)
contains
subroutine fnet_X2_initall()
end subroutine fnet_X2_initall
subroutine fnet_X2_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(54) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  do i = 1, 54
    inarray2(i) = inarray(55-i)
  end do
  layer1 = MatMul(input,inarray2)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_X2_engine
end module fnet_X2
