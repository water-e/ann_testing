module fnet_MTZ

! a = 2.9315e-005
! b = 0.086358

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/-0.143346280201,0.013623044220,-0.010710926860,0.049937068385,-0.057017029513,-0.068466910072,-0.034536015713,0.030481629439,0.179122157518,-0.072828020233,0.042563680653,-0.145201926074 &
            ,0.091121622699,0.088580386876,0.060945534341,-0.117577189677,-0.034537219045,-0.035472191601,0.009987790116,-0.070259685576,0.040436351283,0.266164145918,0.021953478249,-0.144404805571 &
            ,-0.163013502347,0.048846798900,-0.025960475358,-0.090362219808,0.005102801498,-0.134631940414,0.046929987760,0.096569906400,0.121807055128,-0.034996400101,0.038577085411,-0.095435339002 &
            ,0.054313847821,0.213706829040,0.063259820195,-0.162574056699,0.060220188846,0.004719589264,-0.052447764051,0.102106822383,-0.229039019761,0.167590110525,-0.052549519359,-0.043151038416 &
            ,-0.027031091245,-0.096477280110,0.074751061202,0.109734186703,0.001579308215,0.035088311847,-0.102855733081,-0.125648260830,0.071935303032,0.043030691121,0.038967488017,0.045973577453 &
            ,0.109789434249,0.039384134968,0.011822264930,0.033392702167,-0.104242407871,-0.016121288665,0.014008296174,-0.070143778594,0.102188441295,-0.029849823811,0.033888273412,-0.050573506985 &
            ,0.079167661750,0.086466717541,-0.016443236982,-0.110271674635,-0.187317702976,-0.103816024659,0.072388383393,0.176188640811,0.011268060297,0.011802419080,-0.009430395867,-0.052047519133 &
            ,0.035886852155,0.007572362291,0.036485434214,0.005790710976,0.016376703224,-0.015788150141,0.010105470111,-0.009832730280,0.010363473462,-0.031986217039,0.001707938524,-0.021150131118 &
            ,-0.003337966571,0.013599196161,-0.017629568955,0.034699074368,0.007207017295,0.037978151890,-0.008174960177,0.008227006786,-0.071552982716,-0.016303083829,0.002094745866,0.017014235972 &
            ,0.000758931329,0.013802032458,-0.021426463421,-0.031857555310,0.067776264026,-0.011817092155,-0.019097445471,-0.025709898570,0.037543939673,-0.063766228665,0.016565776251,0.009539189671 &
            ,-0.081405662045,0.030195517701,0.020020156858,-0.022664313197,0.041511173286,0.054797721146,0.020432559492,0.003988952009,0.047265973877,-0.002692180216,0.014383623546,0.004189355615 &
            ,0.027800289541,0.041534586040,0.007805832209,-0.027008784905,0.025172075039,-0.053572046324,-0.009744760954,0.115173553021,-0.124719747937,0.028824332644,-0.088463796923,-0.056623992062 &
            ,-0.326947753573,0.152158227160,0.205238769689,-0.289428160992,1.258585205306,-0.920075489445,0.282595770115,0.243638022088,-0.528646059907,0.981759687931,-0.561746494216,-1.034692240933 &
            ,0.017418243472,-1.316876493150,0.941073174913,1.395720496324,0.260018445350,0.126665382525,-0.156070783596,0.637744627657,0.097014648609,-0.179193101894,-0.213353951398,0.292328458354 &
            ,1.210452899057,-0.429877478456,0.309631006279,-0.435088229677,0.176236699377,0.038710377544,0.069543138867,-0.257156092260,0.090272557879,0.144847055284,0.048083624710,-1.025539916751 &
            ,0.064656520288,-1.153211254278,0.422331179526,0.942208319202,0.081566670148,-0.290487831127,0.068175828571,-0.158941159304,0.344053186107,-0.350280890405,-0.061114855448,-0.140385804557 &
            ,0.717420326822,-0.327223705308,0.298735135052,1.127796039427,0.332983294970,-0.014484196790,-0.726460038080,0.078831591330,0.323702212411,0.485457681186,0.125104889781,-1.507109238553 &
            ,0.656381516485,-2.079483965430,0.894319116632,1.298756074482,0.386747547185,-0.427172246232,0.485699194401,-1.027371905172,1.498749031140,-1.942637166777,0.370973251517,-0.027214518874 &
            ,-0.188292112056,0.711070459698,-0.163569393864,-1.226893272243,1.080910302415,-2.943065054713,0.745288902797,1.888386259255,-0.329668922540,0.328727851452,-0.343515455638,-0.326474863769 &
            ,-0.001118002331,-0.961490334685,0.207590156300,0.844958858093,0.209816392528,0.035987975525,-0.064303810385,0.444517943040,-0.304781840665,-0.070424599320,-0.258610991540,0.240498030399 &
            ,-0.247572263595,0.274667725016,0.067596024416,-0.514350438393,0.453760474154,-0.501349178587,0.409760172202,0.288005139268,-0.080145194410,0.316094899874,0.118489102814,-0.503738043272 &
            ,0.049116411604,-0.391519422738,0.360276125174,0.462136135120,-0.045002362953,-0.013078987611,-0.016532229014,-0.017035619321,-0.034633525375,-0.421545685805,-0.063805484652,0.266319993823 &
            ,-0.024089080038,0.083321126064,-0.070095138671,-0.296873084857,0.173241304091,-0.628247280327,0.158983301889,0.335016823940,-0.281598282307,0.146825232245,0.104368079119,0.149486887063 &
            ,-0.021140654925,-0.565411946377,-0.087576519638,0.415567491451,-1.457285027656,0.469545609341,-0.202897375259,-0.317593721851,0.934358222556,-0.679781582371,0.259382415421,0.621513249008 &
            ,0.110867389566,-0.013133173694,-0.401227405190,-0.656329930982,0.491401399262,-1.947312016260,0.250713277592,1.057453920139,0.272368535561,-0.250827920686,-0.180456095752,-0.339325643464 &
            ,-0.080859789215,-1.354669161701,-0.063307139019,0.939895774623,-0.680991831052,0.107183775875,-0.646941095151,-0.870885112539,-0.229929042817,0.110450575353,0.273248302614,0.626644375228 &
            ,-1.593478709463,0.619830203587,0.652131644386,-0.494641501095,-0.093557150683,-0.208955965809,0.064710415930,0.783183821866,-1.590656706444,-0.018776998328,0.463030681650,0.201605993901 &
            ,0.079269560681,1.803835448915,-0.244787388135,-1.361902468401,-1.731392555450,-0.457896005566,0.342009096579,0.439412818704,0.492775034716,1.322409964436,-0.276302542853,-2.245151010287 &
            ,-0.622808947568,-1.035282894909,-0.626159186883,1.152972652393,0.010598244594,1.770394140011,-0.734057743315,-2.526658765063,-0.986003253113,-0.791650302370,-0.160278528602,1.002993698582 &
            ,0.062200673195,0.913030633339,-0.752054740911,-1.694814679020,1.755855307520,-1.357663806079,0.019411586083,2.720685681322,-3.150551768540,3.187610829023,-2.082057839763,-1.479785227731 &
            ,2.184865466377,-0.726628911683,0.934716400635,2.581536802046,-3.100006023549,1.074215593572,-1.995835314103,0.306860815906,0.399480505159,-0.091188664328,-0.204774379677,0.291766949932 &
            ,-0.048671400866,0.386773689822,-0.045350886612,-0.278589371568,0.659474582125,-0.258851376274,0.028329729812,0.368903327926,-0.640556058716,0.167857523516,-0.340087908694,-0.018155176415 &
            ,0.334242281143,-0.106732554964,-0.010303225972,0.350805274211,-0.503474763920,0.239792779499,-0.272993898616,0.079088445929,0.134372824525,0.017596459492,0.040049919728,0.152619264340 &
            ,-0.162610837107,0.032059970120,-0.120432439702,0.227816680369,-0.044004079187,0.029212177429,0.038908062249,0.126420680712,-0.259596007176,0.109739229181,-0.112693373841,0.118031806872 &
            ,0.211230635548,-0.047359442932,0.278853708494,0.101788144519,0.084374562086,0.166597480637,-0.074473037373,-0.119030234718,0.180056688923,-0.147539363240,-0.031898453558,0.438823184429 &
            ,-0.445840009651,0.366453174461,-0.284116533612,-0.310092025786,0.424065726513,0.010456120622,0.517698073707,0.356210045459,-0.445980757778,0.241654702516,-0.273501508830,0.148377793603 &
            ,-0.672142319392,-0.102325518747,0.123632374261,-3.784274416023,0.565029239356,0.605711829110,1.883643658749,-1.006689952812,0.596431289232,0.149247317497,0.191417263519,0.212123419148 &
            ,-0.671397404704,-0.594092609055,-0.044917361315,0.430441365027,2.382770221428,-0.327997193757,0.319706430987,0.040562132427,0.627629748425,0.750362871865,-0.155359711741,0.405856208014 &
            ,1.583723192352,-2.120382285081,0.167029742677,3.997675321272,-1.988940988760,5.194769293698,-2.857442642884,-3.719528513337,3.844446109672,-2.576189086717,1.233339285540,-1.259858575082 &
            ,-0.598555639996,0.786989632212,-0.561571850565,-2.333911323903,-1.730182198684,1.099979559207,0.226653412925,-1.965515858446,-1.262875885905,-2.015126034003,1.212648013883,1.881964839430 &
            ,-0.770351323194,-0.316656801531,0.121257634062,1.564244830482,3.440292946437,0.246808601175,-0.185533816231,-2.239984226484,-3.947695292126,-0.220291586217,-0.873026606147,2.001608907211 &
            ,-2.634405667931,0.752903351964,-0.863566236413,-2.512063461064,-7.770705462650,0.719944701623,-0.288179372809,1.824205736601,-7.047530974044,-2.877371180824,-1.626252019548,3.014710710340 &
            ,-0.594380693932,1.336846769923,-0.475139294768,-2.459971592996,-1.192687686719,-0.875809771449,2.384358421783,2.076734229293,1.873038666819,0.212816360545,-1.562035452076,0.126343448598 &
            ,-0.597442373267,-0.744406744971,0.380893474336,0.968427581825,-0.228443908671,0.167038810117,0.448678361306,-0.160031200487,-1.266855097148,-1.645661079493,-0.079553502247,1.020380907913 &
            ,0.994418151759,0.183041339063,-0.011328350786,0.248775492363,-0.756961169703,-1.241868976872,0.237836442783,1.144045639627,0.699193046622,-0.223989696422,-0.369845557221,-0.514789548929 &
            ,-1.006019049773,0.145649855933,0.070377164952,0.867332383250,0.824932065970,0.371550273551,-0.144745607296,-0.266126308454,-0.968431915439,1.286593054875,0.325821762532,-0.207032329423 &
            ,1.411536588392,-0.352221567168,-0.619545280389,0.510753798661,-0.016541550131,2.244139687547,0.217733975575,-0.365949584803,1.571820475241,0.043206453842,0.330783875066,0.594211091351 &
            ,-0.067015762189,0.735337702797,0.022794172240,-1.828358827669,3.307382796442,-2.728536451002,-0.076024347378,1.089727940906,-1.424264409769,-0.528250847214,-2.159222331241,-0.011377717856 &
            ,-0.623786005123,0.332203659292,0.060830159598,-0.056057820369,0.670543410109,-0.581198476439,0.160013599695,0.378621646902,-0.624521463929,0.747963177840,-0.608370297935,-0.279099058811 &
            ,0.439004619424,-1.516205552880,0.438202253377,1.353608012827,-1.306713679638,-0.119513705036,0.026955786647,1.283140879379,-1.627663833808,1.784726571960,-0.741410790785,-0.956807913280 &
            ,1.589518629637,-0.271585661153,0.657846973850,-2.831715415346,1.096467086833,0.510005854620,1.862524605385,-1.690450842810,-0.301816082560,1.514306846102,-0.957059415543,-0.494151136227 &
            ,-4.526778649347,-1.325988344149,0.755713537140,2.334943916330,1.996270629874,-0.684215006181,0.101855052878,1.071311039716,-6.216254263200,-1.549566164599,-0.853733897144,0.427383807593 &
            ,1.793306195842,-0.011021523985,0.291960235122,-0.642832531945,-9.722426573567,-0.336661064948,0.236698781652,0.746337841277,-5.391509358851,0.500868909595,0.141812357913,-0.727313453130 &
            ,-19.358735823287,-0.691683563859,-0.410420796592,2.178523654465,-4.451773232923,-0.535994007724,0.939829538467,-1.551996988096,-18.992420748869,-0.445092717816,0.883480006855,-0.806175958145 &
            ,-9.421019217964,1.559680257219,-0.768951963525,-3.173080993953,-8.768395232086,-5.978043632337,3.863819840096,4.453290113750,4.391337547009,-0.021255728236,-1.411404405631,0.356036769285 &
            ,4.990886508618,0.203336630337,1.361290015752,1.534499288062,-1.436534765534,-0.201128849220,-0.329641944403,0.155178637796,-0.153882896846,-2.017679511079,0.270897535562,-1.185302155687 &
            ,1.461186937027,-0.105424090427,-0.775894797675,-0.286518894716,-0.062998274798,0.993781327579,0.908647357434,0.159635057610,1.120330729865,0.093816727515,-1.662890242655,0.066898534733 &
            ,1.084654244009,1.263495313273,1.054095323964,-0.704418886291,0.343933695751,-0.705754717526,-2.796111926856,0.158936393605,0.690010236402,-0.408189838317,0.453302845213,-0.910623922202 &
            ,1.767318745618,-0.241187150202,-2.389419993756,-0.436981887456,1.421078300128,-1.366815616090,0.913465033684,1.034667264457,0.719744339919,-0.665278026422,-2.246196925981,-0.575153395088 &
            ,1.922815736523,-1.224390607209,0.780969953204,-0.380467272756,-0.789426721661,-0.500871254456,-1.958885450204,-1.329283064052,1.850206604036,-1.784430022255,0.845855047418,-0.529935295999 &
            ,-0.076688880679,0.229590793576,-0.028197991065,0.330861240270,0.087837715585,-0.151538412051,-0.023582428001,0.215919122300,-0.086500799328,0.178686926439,-0.206215187359,-0.126218464071 &
            ,0.046295869386,-0.614280969922,0.132172160594,0.414787504438,0.102388918358,0.191500004347,-0.094029564394,-0.378170668469,0.265108974161,-0.758874567310,0.282495150076,0.492764874353 &
            ,-0.145835857145,0.168250954799,-0.079202081154,0.304338143282,-1.066594043061,0.271749357218,-0.252439777834,0.430176289492,-0.105148318469,0.022818381553,-0.011017991878,-0.553686936820 &
            ,0.658033402096,-0.582337522529,0.323089967225,0.147058091464,-0.125518114606,-0.017064964985,-0.083254622210,0.017776150110,0.119364648198,0.209782679107,-0.055463399240,-0.037915325614 &
            ,0.053478658189,0.218881976865,-0.081099970008,-0.324870415769,0.309236777790,-0.030395365539,0.264003805842,0.182694190942,0.078371815693,0.066202498890,0.006610700342,-0.368350465754 &
            ,1.200327082903,-0.206206084790,0.225212694062,0.130785067999,-0.482811043761,0.148774519147,-0.208024723961,0.115535847924,0.542804743072,0.188772113766,-0.101249283680,0.070398151085 &
            ,0.200657713794,0.133951636043,-0.139764254087,0.359827847245,0.108328269971,0.169413275098,-0.242291696312,0.005431784373,-0.006492257130,-0.062347983254,0.097621161484,0.029485587639 &
            ,-0.079416195400,-0.063811149319,-0.081188194512,-0.091214738380,-0.009697036428,-0.161436507182,0.018901150527,0.298484812497,-0.059850909518,0.158257676625,-0.245336527342,-0.222584843532 &
            ,0.009663530939,0.016013055269,0.103799457120,0.154200663316,-0.059398776295,0.173488802984,-0.107069327748,-0.025251147083,0.022716469513,-0.027188592747,0.101835498722,0.050173982311 &
            ,-0.007669571707,0.027052505339,-0.082234165512,-0.014458163913,-0.158684464971,0.029956686570,0.117414260635,0.241524967224,-0.177528339324,0.194384150633,-0.179935526267,0.041897202928 &
            ,-0.188045613284,0.088044110449,0.134543726307,0.045977026987,0.190447953113,0.114661657815,-0.025412237949,0.058716219761,-0.058498725372,-0.102111718254,0.133724636608,0.194865776714 &
            ,0.148840292820,-0.081756091757,-0.168068528103,-0.102322263771,-0.125388764309,-0.050329488819,0.212724243179,0.367612555695,-0.118230573995,0.064070016123,-0.279448576970,0.030876988545 &
            ,-0.040217775284,-0.050906225228,0.094352716534,-0.117628519458,0.388730712546,-0.161268829723,0.036909416382,0.040237305410,0.289317643277,-0.112191975456,0.107052889655,0.017362778715 &
            ,0.368575281224,-0.467411761068,-0.051916481506,0.148579296060,-0.147960260219,0.157831684192,0.044332771886,-0.275078254251,0.417018245771,-0.483986979105,0.160123660402,0.457830017232 &
            ,0.114754445620,-0.027730291925,-0.038789827858,0.115028406333,-0.186807462486,-0.012307175265,-0.080636822936,0.027002659082,-0.187025624307,0.072655068644,-0.017777577529,0.004912588095 &
            ,0.099860341972,-0.168557562266,0.025334441005,0.110478897851,-0.263541678580,0.020174210148,0.021584666062,0.097881467819,0.273165035160,0.035228702281,-0.031647047419,-0.044762925787 &
            ,-0.014803498270,-0.087590608595,0.101239522312,0.034375795811,0.307935218273,0.269918456593,-0.010684787601,-0.307275044480,0.151142828026,-0.075255815557,0.027805239210,0.019860013617 &
            ,-0.178312517719,0.056552712610,-0.043906506087,-0.114027268876,0.241553280245,0.065941173129,-0.072919168138,-0.110690500154,-0.217737363449,-0.265645353961,0.076023498727,0.242316034416 &
            ,0.042164466523,0.105555172286,0.055619968730,-0.198339966458,0.086855207986,-0.304095218050,0.145948261739,0.204989171845,0.026712467740,0.018776218592,0.026146203359,0.009928543416 &
            ,0.041593594592,-0.038339338929,0.006428410259,0.038343183685,0.033150653971,-0.022922630265,-0.005998797147,0.007629375753,-0.015525805199,0.043758271844,-0.010571897884,-0.033387951554 &
            ,-0.053406261550,0.017786376286,-0.005160796546,-0.092753268214,0.073864527515,-0.200695931356,0.054415199794,0.058615773866,-0.027345912437,0.005063993280,0.016336076150,-0.000632199781 &
            ,0.093524644443,-0.122237509162,0.006390486843,0.027872306940,0.007237273199,0.012544956300,-0.005990012060,-0.026740105433,-0.002509837282,-0.069621783991,0.020219709143,0.029356274066 &
            ,0.019733134274,-0.015087939560,0.011242622679,0.045563117416,-0.048538021548,0.045073408637,-0.033385535316,-0.018004166827,0.030701934129,0.011122333946,0.055194146233,-0.004971747862 &
            ,0.020471366997,0.025451984238,0.012333283194,-0.009376448384,-0.001184788888,0.031371197101,0.003674855088,-0.042279245576,-0.002585530594,-0.166516772726,0.032863516605,0.066354550579 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/0.032912,-5.2632 &
            ,-0.53019,-22.513,-5.9794,5.4745 &
            ,-0.32581,10.7333 &
            ,-0.02181,-2.2997 &
            ,-0.073808,4.4682 &
            ,-0.28184,21.5854 &
            ,-0.010452,9.3105 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/-0.47876,-0.79869/),(/1,2/))
real, dimension(8) :: bias1 = &
  (/-0.35357,1.1526,0.20999,2.5762,4.5716,7.9244,-1.0294,-4.5995/)
real, dimension(2) :: bias2 = &
  (/2.2033,-7.4446/)
real, dimension(1) :: bias3 = &
  (/1.3273/)
contains
subroutine fnet_MTZ_initall()
end subroutine fnet_MTZ_initall
subroutine fnet_MTZ_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  do i = 1, 126
    inarray2(i) = inarray(127-i)
  end do
  layer1 = MatMul(input,inarray2)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_MTZ_engine
end module fnet_MTZ
