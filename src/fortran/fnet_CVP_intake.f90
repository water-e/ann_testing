module fnet_CVP_intake

! a = 0.00080051
! b = 0.020521

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/0.156484053757,0.217685210146,-0.041463286026,-0.192856269799,0.059802582051,0.142370243012,-0.097301491523,0.002696741023,0.101685317737,0.077635451510,-0.112315229590,0.061565369295 &
            ,-0.023544921930,-0.077333352894,0.042991181034,-0.073787072877,-0.039807183448,0.068984541206,0.304324526919,0.236848924954,-0.184903558499,-0.116851019087,0.180264530479,0.321473488415 &
            ,-0.145258281471,-0.250937572282,0.114712623045,-0.041141280594,0.077383757565,0.078139883816,-0.049543458201,-0.720590786074,0.857416472098,1.182608984498,-0.469832512275,-0.143673775983 &
            ,-0.013303185893,-0.002692678045,-0.058046079823,0.343820113416,-0.416809233909,-0.457346653374,0.402438234759,0.198567495080,0.082519708084,-0.133714420459,0.031294278648,-0.628024053356 &
            ,0.067876582490,0.059095630565,0.051389735207,-0.026635115777,0.087964679415,0.064015175329,-0.020581159861,-0.046108904622,0.293123684638,0.290125510683,0.068671549072,0.090092364766 &
            ,-0.176401652648,-0.135228811414,0.021657076937,1.562080424191,-0.326483334211,-0.419335645950,0.393228905865,-0.115849438880,-0.136703228576,0.004178395613,-0.074539603553,11.283050040829 &
            ,-0.107093832652,-0.189809023941,-0.011183977449,-0.547421252929,-0.204133042057,0.276415484102,-0.174349480617,5.468881994510,-0.138188326056,-0.140573435997,0.062287535674,0.090395265340 &
            ,0.104035577457,-0.038648866817,0.055795201114,5.198373717504,0.036756429196,0.081529502205,-0.026083582989,-0.017517446678,0.035482045220,0.015058891785,0.007083584519,5.048371097471 &
            ,0.021922376673,0.023762234216,0.016315817760,-0.035735244977,-0.006631537690,0.033018666510,-0.014271761478,5.014494351215,0.058504066830,0.048555590978,-0.038631599567,-0.052332469899 &
            ,-0.031760534928,0.033085930019,-0.011880103059,5.022081874043,0.246826609405,0.295009252803,-0.081511654012,-0.012090594708,0.038302301374,0.008978991289,-0.050488332046,4.962059157551 &
            ,0.108112561644,0.110284516528,-0.187880911173,-0.007678888934,-0.120860199225,-0.025432399456,0.060309835061,-1.005546532645,-0.129256304005,-0.152139460650,0.211247676475,0.206396804383 &
            ,0.093276511475,-0.018956032902,0.049554872633,1.100805157546,-0.267648414092,-0.302014140545,-0.205226103568,0.091318339211,0.058999317920,-0.119780315160,0.180421954158,1.295901410523 &
            ,-3.285759117511,-4.291859768806,2.044698292340,1.315711005807,0.649808720448,-0.644286361830,-0.116597755668,-7.891368941193,-1.163075400128,-1.578082106473,0.009579953499,0.331434990297 &
            ,0.418750987008,-0.142294079399,0.048972449077,-2.508460410571,-0.131166119934,0.400981166396,3.082439514986,1.988135429788,0.848152107034,-0.680334803278,0.454689386660,4.318436955203 &
            ,-1.630811151597,-1.967219203778,-0.270006420754,-0.039772941639,0.119266953548,-0.133309963615,-0.195082749171,-6.262956013250,-7.298499983759,-11.050662556593,1.206642413755,2.003039761456 &
            ,-0.542841626360,-0.317851334943,1.444248059746,0.891374134839,-3.658790981608,-4.274981045172,3.157569261010,0.454523812654,0.061640895324,-0.429358826685,-0.061790846114,-3.347701131042 &
            ,0.046817976290,-0.332108080331,-1.099241002293,-1.885546853241,-0.505231850324,1.702059774177,-0.918319016762,-5.684568507418,2.835882203232,4.079499144203,-3.080058763935,-3.614861463852 &
            ,0.120503131129,2.470225958492,-0.432130704136,-1.691930371277,-0.367964383962,-0.871145371905,-0.396503980762,-0.417105990365,-0.361657085225,1.486187601942,0.178598493852,1.824445120224 &
            ,1.402946925603,1.542412770192,-1.221515147017,-1.536662579576,0.526342033358,1.268185984522,-0.829781460626,-5.119662089811,0.895086163425,1.076103986517,-0.327501830472,-1.147547082247 &
            ,-0.264771162949,0.598127002047,-0.396955106239,-1.183763618448,0.310070959526,0.336453238806,-0.521207254573,-0.407080323683,0.276246211829,0.057823474417,-0.270747460494,-1.043087901083 &
            ,0.548879140234,0.773193681536,-0.852941978222,-0.710265547902,0.554765239016,0.267047183634,-0.321374246545,-1.518971187040,0.308677599555,0.570002888704,-0.204168110161,-0.087576669235 &
            ,0.708268627246,-0.035222591409,-0.137136356052,-1.845607424831,0.312297215825,0.510175826830,-0.566913450330,0.256655835554,0.265340027658,-0.081955797892,0.299082133830,-0.758560916407 &
            ,1.624320117649,2.642427514266,-0.941930455097,-0.320285032717,0.258990047723,0.233233746991,0.466349553840,1.043615138699,0.341493770737,0.603525042706,-0.063954481231,-1.261455548988 &
            ,-0.210450086529,0.424404096601,-0.373696934336,-2.545651570838,-0.074641212712,-0.013468717938,1.188522731837,-1.063534414741,-0.932633668497,0.588910541996,-0.213388999444,0.540001841865 &
            ,0.988712965988,0.833586056910,-0.684744028755,-1.452588881927,-1.336835809305,-0.084451332366,-0.629605918469,-8.029665322796,-0.175918867815,-1.314089778611,-1.276624922775,-2.547949779699 &
            ,-1.956918103820,0.786192506359,-0.663900287029,-8.804738754919,0.699519623068,0.084544295480,-1.886197021120,-3.619567896273,-2.765120291290,0.689682078325,-1.055660851045,-14.508903427713 &
            ,2.638495002322,3.022065989688,-0.486746623482,-2.717182557928,-1.560217747309,1.280809362118,-1.245140283597,-8.222936284660,2.242499083487,3.031642058207,0.352145971473,-1.928071948790 &
            ,-1.142270210279,0.438163124003,-1.134373708186,-7.328150465629,3.695465672805,5.842487398412,1.367862324013,0.446624149028,0.935655311692,0.467233698348,-0.649236436915,2.416328622964 &
            ,2.688372021625,4.909971118606,1.663458854674,0.973743502106,0.921494226048,-0.754024972058,-0.550411304473,-2.206345048049,1.782368671633,3.611761261831,2.386876004256,1.868226224483 &
            ,1.531625052753,-0.370033791639,0.013716870901,3.550752220081,-6.760587473044,-7.822142058588,2.354896924274,0.881876991586,0.509132985828,-0.632160361404,0.754892800255,-12.432106903844 &
            ,-6.698813533258,-8.095800544745,2.327510621570,0.600636899618,0.428555578894,0.072001731266,0.638494510422,-9.590011847002,-0.432281346907,-0.531186872943,0.083232020927,-0.307925133247 &
            ,0.024843891119,0.208639660240,-0.082117321645,-1.072610235664,-0.808134698627,-1.081045606422,0.049458162343,0.279787520105,0.124007067147,-0.085038784812,0.124840527080,-1.136181283559 &
            ,-0.973636557767,-1.342438868704,0.080730832353,-0.220908004830,-0.178808589820,-0.011310748061,-0.061699522477,-0.993124953484,-0.501325349708,-0.631401146373,0.041080996931,0.117723423854 &
            ,-0.027512745164,-0.042389327216,0.166707316416,-1.427914491655,-0.936570423499,-1.304983437284,0.132990227829,-0.073990580243,0.070948377720,-0.038770968986,-0.108491901583,-1.523043163943 &
            ,-0.182364378031,-0.183472667551,-0.177748378832,-0.157392859864,-0.083098180879,0.090246100292,0.135174905751,-0.662640291539,-0.186294148136,-0.211176019052,-0.176803558345,0.184114329867 &
            ,0.168550848303,-0.232970453938,0.002096650742,0.547056177435,-0.808100450929,-1.116109369810,0.442001638060,-0.187255935625,-0.125360825887,0.098842863389,-0.017714698772,-1.621280229910 &
            ,-1.282942139401,-1.336705081726,-2.984071538782,0.677156227589,1.046267209870,-2.371419604406,-0.254369324174,1.706706364239,6.622326227060,8.844425743532,3.598661610522,-1.604420426112 &
            ,-1.837332346321,0.985043059498,-0.346695085847,-3.366549570850,5.990505851898,1.452797647560,-4.200624136781,0.681060671641,-0.238459960888,-1.053805048679,-0.188755990055,-1.197427518427 &
            ,2.109629115179,1.091746105862,-4.779044792655,-0.414669290626,-1.053149553909,-1.036504120635,0.729472534310,1.150187004035,5.243081359367,-2.696982903583,-4.078382533518,2.425300080249 &
            ,-1.217956998277,-0.781736132408,0.418436253028,6.134149320699,-1.660994236468,-0.758665618385,-1.114013157935,-0.794586721425,-2.013985899140,-0.937134400890,0.344967989742,3.124673677601 &
            ,-1.219195763202,-3.203124534458,-1.144274008208,0.951637991939,-0.615248027150,-6.990665496094,0.295158201046,-0.065152275053,-1.844533158025,-1.108417833209,-4.391040141006,-0.203531155787 &
            ,17.009157612469,-5.259970400947,-1.423706395493,-7.719730656293,0.644274689746,0.126649099586,-9.448506463255,-2.190840000428,0.140482672582,-14.812724063250,-0.194692587885,2.890448162422 &
            ,-4.315788947546,-7.054866965964,-9.166723394217,0.403298687760,-1.635395330093,-7.917079009979,0.215389306339,4.699859912218,0.273106153023,-1.402851603071,-1.180747966499,1.049345315520 &
            ,1.137718974635,-1.776983329208,0.048412392817,-0.546082481090,-1.071472826294,0.579445912481,-1.878413895048,-0.492696499350,0.236845558243,-1.600329331226,-0.214019558803,-2.868747641402 &
            ,0.471259935981,-0.324101161734,-2.886891622189,-0.018567050000,0.741720977179,-2.795500390845,-0.378517698252,-3.084462139289,1.503503481690,4.041850074765,-4.680536747568,-0.690174906740 &
            ,4.053519620262,-2.754002829492,-2.434581001375,3.613026248413,2.636499272158,16.300611288668,-8.902432541482,0.553907193582,5.250063463404,1.045951558996,4.594377295521,11.516304848973 &
            ,7.779128552700,9.958079477834,-8.940342869009,1.111040696399,-0.448890065997,3.139381999372,10.639646594426,4.451429473554,-1.130780955099,-1.876511459398,-1.228437949409,0.184433533273 &
            ,-5.691614530069,-4.814779949024,-2.621266853094,-3.302889065157,-1.805931632947,-0.413632561546,6.870059836244,1.997513468112,0.309646144297,-0.393108433797,-0.044873928712,0.966346301423 &
            ,-1.754726451580,-3.606648135940,1.377289520262,-0.781715900280,0.772174497252,-0.477862420619,-0.918596154677,-2.504059722922,-1.540431757757,-1.062053545515,-0.096841574397,0.065417217523 &
            ,0.242334619298,-2.151926887409,-0.018655125847,-2.877154173837,2.148398988914,2.567467955463,-2.220145588106,1.008879463457,1.122675196277,-4.238506043167,0.149204402965,2.996282784553 &
            ,-1.497875997801,-3.369661009964,2.196611946471,-0.043392597878,0.608334904939,0.313775600416,-0.484194437947,-4.659617900956,-1.943540904442,-1.348904747313,-0.287040811625,-1.921586120231 &
            ,-1.344570289608,-6.139517941966,-0.352255697662,-2.512971050724,-3.020020430411,-3.933534470219,4.481384321353,1.877900399518,1.180153763217,-16.697613269419,-0.211586835947,-2.604060647638 &
            ,-0.079744942969,-2.951157781086,0.466764456572,-2.047385094306,-1.061043297104,-11.908663894974,-0.640791504379,-4.544660115703,4.487153633516,2.060333108813,-2.136709171201,-1.326729897201 &
            ,-2.005924975020,-25.258235922541,0.004010728276,2.487495385584,-1.926466007602,-2.627566212453,2.598696592249,1.393554888697,0.183067600330,-39.448609476871,0.373890464145,-0.032358726694 &
            ,1.782278019402,2.208520524496,-0.209289968477,-1.328315517123,-0.545833469178,-9.480388063919,-0.337334140196,-4.266823563261,0.724461471491,1.346337323806,0.394944223486,-0.836493721145 &
            ,-0.278132911572,-0.255869074887,-0.339437439849,-0.519849266834,0.351195588879,0.230892687390,-1.214594950338,-0.530667966961,-0.147739944817,-0.476780503394,-0.254871389966,0.057012521520 &
            ,0.332520862487,0.218689091395,0.258191116499,-0.590565729162,0.036605857978,0.067477614874,-0.233860156636,-0.319068316898,-0.806675880543,-1.172226152993,-0.148904863719,0.127494797372 &
            ,0.075028708477,-0.524011804395,0.180797944961,-1.574842968147,-2.245436857115,-4.080150129096,-0.813821262072,0.152411468969,-1.555417973726,-0.379142204518,1.001672175671,-0.327168262086 &
            ,-2.948180170193,-3.714233164932,-0.313430595614,-1.737188516204,-1.762565087859,0.092335830293,-0.180897889404,1.334191412373,0.774753746819,0.907995371201,-0.832987962148,0.190720463743 &
            ,0.427173558468,-0.590524094835,-0.037608949935,4.159343497766,-0.015035968612,-0.416530019324,-1.383511886861,-1.428308754771,0.298487095650,0.598118406776,-0.631953857574,-0.677651899474 &
            ,-0.361713947139,-0.634725983846,-0.964122107609,-0.457942145722,-0.434833777877,0.053274465896,-0.024383029651,-4.254952297707,1.419147694728,1.925047177247,0.272500333190,0.144460453707 &
            ,0.396537786319,0.375408218237,-0.117784573377,0.896135050202,1.545308040345,2.239277177894,0.470362945594,0.351416833404,-0.304019198502,0.089829992256,0.373562843834,2.097755287237 &
            ,-0.636632575855,-0.847397050763,-0.751802756450,-0.552545629718,-0.315390657272,-0.167896532851,-0.209774129293,-2.134123025775,-1.291225150682,-1.604593926831,-0.136792132508,1.082098313402 &
            ,0.646873363125,-0.085762244400,0.552098328906,1.360232909365,0.441131817889,0.619064404704,-0.686519162892,0.272286898419,-0.149707324503,1.028456263851,0.510498513524,2.231014364265 &
            ,0.682749086639,1.054133114825,-0.562337709379,0.392464510804,0.390603007016,0.457116407848,0.018843642616,-1.912385093875,0.148634659590,0.204356278069,-1.003347790379,-0.080315864107 &
            ,-0.842922535976,1.484485450322,0.353302257573,-0.119328317677,1.846226347753,2.331960464769,-0.625123976684,0.026699878933,0.722221466631,3.426842012233,-0.015857600142,2.975183679492 &
            ,0.515636802959,0.556352830957,-0.168640248218,-0.343722179230,0.531204870089,1.484470174228,-0.190059602412,-1.090952389387,-0.207769339883,-0.448280179867,-0.250309912062,-0.074921477867 &
            ,-0.332312685491,-0.004410500998,0.126870934318,0.089341897464,-0.076124273567,-0.231861809210,0.084925201256,-0.000852621424,-0.167337499828,0.073382672187,0.001330706045,-0.041200437241 &
            ,0.109186967276,0.094882871054,-0.189073659944,-0.056529616052,-0.233816922238,-0.043053739711,0.007277025107,0.061651376485,0.086289792249,0.103931814418,-0.057037891469,0.046412222473 &
            ,-0.470753551232,-0.162182406772,0.067685619959,-0.199818338313,-0.116642277725,-0.016180069367,0.600995167732,-0.190380404041,-0.194937293406,0.008264947240,-0.314768456604,-1.085529798173 &
            ,1.294261566243,1.884358155606,-0.483012383925,0.730573237658,1.282398259598,0.200204727938,0.330317667094,0.355763065350,-0.647954631657,-0.602244354579,0.437375710137,-0.446910510951 &
            ,1.336171710939,0.637321784965,-0.219437444908,-0.136037254116,-0.367447838811,-0.097628719733,0.339248340936,-0.161574351003,0.524506591946,0.489828217285,0.332511694718,0.633817681704 &
            ,0.144227447271,0.301368787817,0.501747833448,-0.259049217342,-0.236583131831,0.182681641439,-0.169030058625,-0.172165138429,-0.455338449410,-0.527235332752,0.364742607647,-0.115772120846 &
            ,-0.146615439883,0.055007292657,-0.032551849856,-0.125826149610,-0.201541227647,-0.273584382914,0.210902265996,-0.352044596578,-0.241784882782,0.168506087152,-0.134123494362,-0.191886781660 &
            ,-0.097700429830,-0.061934030466,0.328144714080,0.135853570706,0.177803153090,0.051080615163,-0.004675409722,-0.152485942187,-0.105701466048,-0.272890009831,0.150185432905,0.088549990246 &
            ,-0.065398222425,-0.006511250998,0.045864395393,-0.076138553251,-0.418304814937,-0.605556401108,0.130945775519,0.125333858996,0.229199643430,-0.026975592889,0.052882983127,-0.038062309430 &
            ,-0.534766883662,-0.704785481848,-0.130014551940,0.030339432288,0.595705640238,-0.039910995632,0.018226003384,0.062377950220,-0.045404094702,-0.023621881026,-0.037750527838,-0.472057050716 &
            ,0.101533574944,0.008852134972,-0.192619883003,1.027670376493,0.197554779647,0.317428614131,0.265410162651,-0.113138730992,-0.366335390495,-0.168600751667,0.046245896746,0.648220892426 &
            ,-0.212236059225,-0.227203461271,0.352194160985,0.035693006651,-0.490040074329,-0.513060661687,0.171165592648,1.599537555052,-0.101371202586,-0.130821077008,0.284540351607,0.250425163879 &
            ,0.057967135314,-0.138236696194,0.052606003929,0.157479646553,-0.007512029163,0.005640487342,0.160952511928,0.047709441605,0.002783071850,-0.030109933375,0.017543415415,0.905771797828 &
            ,-0.065128107860,-0.077820749472,0.140059990244,0.067630992926,0.007514238946,-0.045648723459,0.008486774292,-0.669757182779,0.088901461503,0.142220429436,0.117632027384,0.035830053474 &
            ,0.031771649504,0.008391427328,0.013731088461,0.770217348243,0.184378472834,0.281765870291,0.044800395150,0.183437180247,0.030755643659,-0.058286261242,0.097247489210,0.269888553484 &
            ,-0.013515252632,-0.004383798460,0.061600523524,-0.003054100426,0.060201650708,0.052814317175,0.016250767118,0.772542492667,0.069092739180,0.086626888981,0.085487306524,0.061098048164 &
            ,-0.088972575891,0.009092060581,0.062410349429,0.621425440816,0.155166764477,0.186530907867,0.201754045472,-0.090215336719,-0.019339799267,0.098040517206,-0.080171585260,-0.038362755462 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/-16.4551,-9.6441 &
            ,13.6498,7.3879,0.34717,-1.2419 &
            ,-5.4714,1.0819 &
            ,4.0878,-3.8083 &
            ,-8.537,0.79488 &
            ,-3.1395,-12.9981 &
            ,6.202,8.9995 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/-0.35706,1.7241/),(/1,2/))
real, dimension(8) :: bias1 = &
  (/7.699,9.6266,2.9111,8.0147,1.2018,9.7106,-1.4886,6.3167/)
real, dimension(2) :: bias2 = &
  (/3.721,4.4608/)
real, dimension(1) :: bias3 = &
  (/0.4424/)
contains
subroutine fnet_CVP_intake_initall()
end subroutine fnet_CVP_intake_initall
subroutine fnet_CVP_intake_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  do i = 1, 126
    inarray2(i) = inarray(127-i)
  end do
  layer1 = MatMul(input,inarray2)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_CVP_intake_engine
end module fnet_CVP_intake
