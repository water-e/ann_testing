module fnet_Beldan

! a = 4.5804e-005
! b = 0.091868

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/-0.685363053162,-0.097545632089,-0.007758557326,0.083177711127,0.532668023768,0.067898512445,-0.783059301049,0.006710650714,0.381630919742,0.042367433473,0.001265658967,-0.107069216864 &
            ,-0.314865308947,-0.036864257214,0.406186239739,-0.050267646298,0.274312110952,-0.086912404034,-0.002639192924,0.010044644670,-0.053432417983,0.042964535597,-0.209008804584,0.038327480164 &
            ,-0.323777076067,-0.063277074269,-0.016345731529,0.030102545890,0.265643110331,-0.033957893412,0.249936688898,-0.044537771242,-0.186525996979,-0.062147586540,-0.029300668148,0.152850556105 &
            ,0.091190301198,-0.032179275536,1.918192266385,-0.080341332729,0.160074615998,-0.235439826894,-0.040400126455,-0.171690655785,0.058754054847,0.125174012078,-0.016233461351,-0.045756745114 &
            ,-0.214377887427,-0.072995534974,-0.035756849932,0.036342851364,0.069988130263,0.135629626449,0.147448639266,-0.085325038495,0.890849829879,0.171735583785,0.080924835025,-0.028331700502 &
            ,-0.495083581747,0.156190233826,0.566099294897,0.247621387207,-0.377565078068,-0.511050136958,-0.152675684097,-0.095768032230,0.290475892980,0.103349620768,0.165067713391,-0.072212006724 &
            ,0.084189563535,-0.390857010236,-0.127340878236,-0.198076669310,-0.182705087611,-0.009202139898,0.594054647474,0.263832768127,0.138570511962,-0.175252220051,-0.036008028573,0.003606176229 &
            ,-0.015961527766,0.161767670405,0.612756038583,0.124986003048,0.014488960284,-0.108416954222,-0.039655007756,0.009342320090,-0.043762806414,0.012418265115,0.435238590427,0.123274540351 &
            ,0.513078511166,0.092939074908,0.019316122812,-0.232164293431,-0.391389492482,-0.015422804106,0.186373864022,0.061568702674,0.344007005859,-0.146288494443,-0.044647711471,-0.098619125387 &
            ,-0.168097851184,0.077426537599,0.675805147498,0.113317965170,2.818004774994,-0.491334992319,0.055310549123,-0.588611228510,-1.229073558930,0.406156517015,0.842819607990,1.890551466555 &
            ,0.568215167179,-0.341592867509,-0.057360562786,-0.097720731323,-0.040088228879,0.602740029905,1.044906180100,0.552491966754,0.407659003262,-0.437881068568,-0.104897526903,-0.104166550932 &
            ,-0.077048953066,0.476957742972,-0.329786461179,0.432051154919,0.224886860997,0.014123376595,0.016792222021,0.072333824981,-0.283501385857,0.449027452458,-0.005377443564,0.248863850035 &
            ,0.410628399791,-0.219212065347,-0.054739018370,-0.258091194957,-0.257855418682,0.378799209999,-1.718667408007,-0.162802384080,-3.124557101154,-0.389615619686,-0.071098942849,0.216301416024 &
            ,2.032064632585,0.368611812287,0.330559685120,-0.229443869778,-0.810147666241,-0.445916127413,-0.020778429279,0.400667423722,0.780569757235,0.268433825157,-0.373692050053,0.209019012360 &
            ,0.050160169438,0.147245913519,-0.140668438273,-0.767134736248,-0.574253954195,-0.114928918337,-2.488181400979,-0.722771986924,0.450772983463,0.064921853629,0.249964112384,0.594190532339 &
            ,1.140580003040,-0.373103085432,-1.109755928415,1.026134861617,-2.649258817310,0.180570254113,-0.068308574104,-0.664348518627,0.794226138611,-0.428824939358,-3.775690325458,-0.377328662176 &
            ,-1.444095659948,0.034947137306,-0.112276162857,-0.323192627594,0.817887564771,-0.408810286586,-7.628171964295,-0.076887902499,-2.381977716076,0.878877414940,0.548867598360,-0.663870301373 &
            ,1.932995788757,-0.057544374217,-6.815222208080,1.530533883259,0.399410624842,0.699846873059,-0.066426518438,0.287246102317,-0.942120508506,-0.033227403114,2.843664612643,0.150628786012 &
            ,-0.508586392733,1.181661453066,0.005194929574,0.322889438868,0.165402714962,0.526986426665,4.206340771678,0.255956257165,-1.043483801878,-0.039138138223,0.045899814366,0.124358178460 &
            ,0.799575108801,0.284376410120,0.725841897738,0.250739307566,-0.444848371271,0.140400914109,0.024459359282,0.246070491526,0.199409834196,0.194449050531,0.840695672573,0.209681503774 &
            ,-0.069176105017,0.168099418463,0.017633856487,-0.035958245197,-0.141486638253,0.106878290245,-0.395846667820,0.054881589575,-0.195583878227,0.265083955363,0.075422256023,0.381046463349 &
            ,0.123893524317,0.007774122367,0.586460202906,0.331759623180,-0.710231379026,-0.454624971869,-0.149818153076,0.338787067106,0.450960659918,0.035969312845,0.434984196868,-0.172042457838 &
            ,0.022046885134,-0.020498631423,0.034276081171,0.106963375559,0.118381626162,0.038399047144,0.204127184549,0.190054988006,-0.326352553406,-0.282976999300,-0.087598133626,-0.099324122998 &
            ,0.221948042017,0.069906210891,1.304955646889,-0.182292682319,-0.504928453630,0.009657670270,-0.102035656551,-0.097902703472,-0.091982094174,-0.022727012254,1.810703421368,-0.376949890664 &
            ,-1.152931714439,1.010361578424,0.284805219854,0.669197076269,0.578981750347,-0.117144253975,2.658536131484,0.510908503295,-0.373427795247,0.212957211640,0.324360828601,-0.057580477371 &
            ,0.461300723839,-0.104883881267,1.072888115470,0.660577234895,2.669555701979,1.314539469772,0.462457835153,0.476658347054,-1.975164561969,-0.024042551405,2.807143528316,0.863829221248 &
            ,0.793360951960,0.279685035772,0.129276234264,-0.102642589641,-0.343683842347,0.030033765345,0.493200648210,0.539858642213,1.277898165024,0.941893892442,-0.074137096232,-0.051804866448 &
            ,-1.567721364972,0.064060477371,0.520366929974,-0.492228637106,2.152188704361,-0.475979486410,-0.346198897971,-0.726719358854,-1.802591479979,-0.355868013056,-2.761737348118,-0.657990015415 &
            ,2.356926824521,0.549217909339,-0.115509010899,0.299736988800,-2.339734155025,-0.055554116283,-2.084453510750,-0.184634458269,1.357944863716,-1.164790837863,-0.421457650710,0.149259161257 &
            ,-1.204229426023,0.144463089198,-2.554693980939,-0.220654595583,2.940124437285,0.084167190519,0.150691315217,-0.039470065117,-1.698291935666,-0.041764644182,-6.060119735580,-0.096335636688 &
            ,0.363406551542,-0.508538251917,0.079428134987,-0.152715410103,0.667858679737,0.266196494008,-5.900477763567,0.167960915053,0.322502302641,0.240225571293,0.061146771858,-0.074962445261 &
            ,-0.274376081240,-0.019611064080,-1.657472408866,0.084808303539,-0.010795584323,-0.113056991442,-0.042840641463,-0.021543343577,0.142481786929,-0.137450362342,-0.625080783761,-0.140354879476 &
            ,-0.125515573061,-0.020365167575,-0.010403747252,-0.175992131277,0.154671721934,-0.135403355045,-0.489163309369,-0.126581234714,0.063491631826,0.130114159350,0.032537380390,0.031850798734 &
            ,0.018482196621,-0.077472912668,-0.767281982520,0.009596196349,-0.039494558472,0.102224122230,-0.002791883414,0.024438337206,-0.034618891777,0.048405330741,0.580483162217,-0.126319143534 &
            ,0.353831011746,-0.052291873291,-0.041397501472,0.057051706779,-0.221951876633,0.160788786351,-0.488251355459,-0.094240367250,-0.427526169121,-0.090229401863,-0.034840464902,-0.159413347651 &
            ,0.328385934502,0.246275596466,-0.372658789675,-0.131644845710,-0.549603281047,0.080808037283,0.011862407789,0.177125134673,0.201150476894,0.197002748646,-0.881021455243,0.040572509172 &
            ,0.928049222956,-1.044746545088,-0.165639653756,0.721230294438,0.728695799569,-0.099957601907,-1.601062433904,-0.053203760326,0.490155665286,-2.006231132736,-0.545833860920,-0.928687206154 &
            ,0.864508853806,-0.138556430122,-0.573125933373,-1.687183883440,0.393000416535,0.729445218879,0.358120872736,-0.469804982044,-0.262472797158,-0.139621428118,-2.489630422658,0.903982752689 &
            ,0.603329740775,0.354294881197,0.036596824467,1.260221043189,-0.425291555717,-0.079861829470,0.001471362142,0.360610568575,1.658194645804,-0.237881105673,0.212715617273,1.355034200098 &
            ,-0.213125547280,-0.057026556326,0.816627390090,0.523343105038,1.210299740617,2.067800044981,0.112787912479,1.558371051853,-2.373567151258,0.001526632184,1.571608254345,-0.464708650446 &
            ,1.294901062913,-1.660686285414,-0.264889510124,3.138162342379,-3.006688041379,0.044212813347,1.342015516997,-0.617271494497,1.352808995189,-1.171214235090,-0.501390467348,1.001361282396 &
            ,-1.535567885794,0.037971170509,0.906961982619,-3.553492567980,0.461010568318,-2.706161175254,0.530320144730,1.011920829768,0.309810092551,-0.003772241416,0.559189018516,-1.367300850554 &
            ,0.415382499377,1.090411573915,1.704897146649,-0.105046810111,2.434233325291,-0.033966114688,-1.099226661181,1.192930255272,-0.337232191900,-0.891796325101,0.056165135910,-0.987957685664 &
            ,0.834193501862,0.016403128894,-1.120566163836,2.634950670249,-0.387865620062,-1.148351101061,0.822288028386,-0.297525048790,0.753043940889,0.028553482683,-1.062251859095,0.505079219147 &
            ,-0.395886848899,-0.993325340300,-0.117301406128,0.112150353354,0.638826124476,0.040726317525,-1.001030836914,0.306274103087,-0.378843473492,-0.869168004154,0.006089457219,0.425470126271 &
            ,0.507373920487,0.040542328378,-0.970090925340,0.645096160372,-0.649140967397,-0.801803820492,0.601736648603,0.639897355639,0.128534546090,0.038847919861,-0.924019223278,0.554601888204 &
            ,-0.865053090027,0.003977064537,-0.519205330509,0.256295918365,-0.284702549107,0.032505967334,-0.874997075342,0.821750061042,-0.653974147773,-0.091013198950,0.790000530565,-0.343247855410 &
            ,-0.528574448519,0.032481886465,-0.857125907510,0.260799740573,-0.022105601958,1.324361709249,-0.484936871390,-1.020833255411,0.421022916886,0.044518381499,-0.968519696021,-1.286471714084 &
            ,1.855792807483,0.412399477519,0.077308819565,-0.426627218484,-2.839159195150,-0.068262626848,0.671203779096,0.237731567905,2.251574794223,-0.077606256637,-0.037326907994,-0.129790469023 &
            ,-2.755678574497,-0.148155151291,1.796153490185,-0.255727963855,4.518155113566,-0.669458958084,-0.151457790995,1.753796077135,-1.727147190683,-0.131524084518,-0.060028030562,0.095921935126 &
            ,4.114922222044,1.976483810755,0.033811202733,1.732886641704,-4.798955973489,-0.003197854192,-2.373292570681,-0.730677714550,1.174802475663,0.143779281773,0.201631227994,8.106359772087 &
            ,-7.769593295613,0.068162115643,-2.913346551060,1.107660732100,1.770151600924,0.087360061965,-0.075755390247,16.696283731742,0.015010951975,0.063986247197,-1.781934545005,0.058562441827 &
            ,0.692669851769,-1.098093991541,-0.336450467327,16.343740869885,0.945191900131,0.033723374531,-3.099342317945,-2.160844655369,-0.122341905981,-10.539219864262,-1.005919740649,11.505002246976 &
            ,0.221667949513,-0.031953099335,-3.686239809645,-8.252343208836,-1.430941814488,-11.719918353735,0.423808490785,-1.193769868457,-1.012473004179,0.014373072546,-2.028304554291,-12.054785919701 &
            ,-0.327404999776,-10.219972198642,5.980078402085,-1.454337016532,-1.465164438034,-0.061037827939,-0.633762018002,6.586787011894,1.132900005813,-2.108742908109,0.811725403258,-0.837867253710 &
            ,0.642429038548,-0.034413744939,-0.797679447389,2.509860128715,0.816583997846,-0.716138333831,0.829202726049,-0.276281659780,-0.578207238814,0.002771323000,-0.672495465930,1.865669081001 &
            ,0.980888586759,-0.414620493870,1.340851520859,0.237655658749,-1.407315134083,0.052657124500,-0.494129368599,3.938847067421,1.905462467368,1.203639927852,2.249769590038,-0.173238763328 &
            ,-1.189225288237,0.098529256789,-0.527431027228,5.130870671935,1.838747542740,1.306147279521,1.863727075539,-0.875029126897,-0.888615051999,0.122684173872,-0.785350395433,4.115175102183 &
            ,-0.945257617621,-1.093262208950,0.146915794165,0.900097278408,0.836576400078,0.124566196588,-1.216477212926,0.310815806434,-2.080659719525,-0.670344929120,-0.383859969502,0.650572671669 &
            ,0.863832457837,0.114220693678,-1.767962430126,-1.525041522012,-3.013396050784,-0.090697446811,-0.242281057154,-0.719214661306,1.460616057174,0.122655318320,-1.986424082358,-0.951680475894 &
            ,1.352717011229,0.448283920278,0.079019721548,-0.127366464484,-1.135280452317,0.074045768474,-2.094134528517,0.121606817611,-0.368133027794,0.382780547563,0.132565205346,0.637674567154 &
            ,0.266249986846,0.000545537090,0.528714714462,0.558185175056,-0.587100897682,-0.283174042242,-0.033063533751,-0.309179501663,0.457837072924,0.395690190486,-0.507988884198,-0.099764393248 &
            ,-0.308174092991,-0.075259863125,0.030012836737,-0.656740440351,0.130815791228,0.341369808466,0.817804424955,-0.062024723025,0.922996780454,-0.030607136855,-0.071199863282,0.704128428442 &
            ,0.011049205735,0.033137869020,0.810983892818,0.134879755122,-0.178137928540,0.003511923822,-0.058662247603,-0.924765010504,-0.115333059805,-0.280184380884,-1.002527369802,-0.157535660704 &
            ,-0.987700275015,-0.004758363033,-0.025660620649,-0.809374577482,0.482975797588,-0.276412952599,0.355471723946,0.010059697895,1.402261452824,0.757305804968,0.092588409495,-1.137660611723 &
            ,-0.855436846218,-0.667882981564,-4.636387846943,0.567708956120,0.047379298745,0.825756596461,-0.062337829223,-0.154826204135,-0.411317851663,-0.226318637971,-0.258148632996,0.368580930346 &
            ,-0.163871807435,0.484955402003,-0.340587718548,0.366856667665,0.098087840746,-0.184037070262,0.822149990822,-0.328894874947,0.138079651172,0.195226341440,-0.017395262045,-0.038826588841 &
            ,-0.209242998920,0.024113842241,0.356903604459,-0.079385391115,-0.569984390858,0.013797273600,-0.043985323403,0.258104832420,0.356398231254,0.076496346392,0.289308202063,-0.019102918973 &
            ,-0.533514278588,-0.019315007535,-0.024519217021,0.246370348072,0.446767516866,0.014522065427,1.575727069326,-0.013786347091,-0.132583875583,0.099517964276,-0.062017180509,0.284170287209 &
            ,0.075401200011,-0.031076083554,1.020455882082,-0.114420641920,-0.639104057838,-0.035206802767,-0.081497246687,-0.009553685494,0.353245204965,-0.122341233806,-0.073377900023,-0.197407636268 &
            ,0.061203323867,-0.169130971006,-0.108562962685,-0.016361930940,-0.036232731237,0.030053205109,0.092860990876,-0.272703786819,0.457840762452,0.006149503644,-0.011511850759,-0.083434045535 &
            ,-0.280997304243,0.032272516806,-0.214994596009,-0.009089962874,-0.250002641215,0.097767542661,0.044745806071,0.007833035234,0.129905783186,0.092571451843,0.227501135910,0.089622095421 &
            ,-0.285512948445,-0.008629494175,0.061452957625,-0.043497132400,0.279843976413,0.283265283226,-0.251970148405,0.145840829652,-1.343614833384,-0.026008260992,0.009692806776,0.079788726789 &
            ,0.930831138419,-0.236124540022,0.247848094699,0.038368301878,-0.702158048140,0.063170859546,0.029507052132,0.151332606126,0.285270303282,0.001520455506,1.048867726739,0.068769635099 &
            ,-0.408975574817,-0.095947538708,-0.021303382216,0.050275889201,0.151368617507,0.228364253663,0.111902025384,-0.023819135716,0.078495262203,-0.016299422388,-0.006766674001,-0.031329849025 &
            ,-0.070302078985,0.095975342998,-0.042466105284,-0.030485911318,-0.065732507852,0.015500147644,0.043782153133,-0.032924402218,0.111607934804,0.178651206924,1.363449987374,0.104813073951 &
            ,0.394812054684,-0.022006783131,-0.007285576349,0.133356964797,-0.258813985782,0.253060012408,1.861943429381,0.034769583547,-0.375009042138,-0.123390438745,0.016621151702,-0.144649194302 &
            ,0.277246763119,0.257812750631,2.993412449702,0.020927985625,0.116522753134,-0.155138229385,-0.007585091087,-0.096868822312,0.084635227849,0.111535818409,1.427428927967,0.041692329295 &
            ,-0.110144064495,-0.009828874807,-0.018164267803,-0.049899868004,0.052692954808,-0.159493060316,1.878134088605,-0.043725465395,0.087118546090,-0.038645171496,-0.020216606883,-0.038093381445 &
            ,-0.073622852863,0.151054280841,-0.590445828294,-0.041837253574,0.428383733473,0.003770180299,-0.049214133932,-0.080067184469,-0.430939776923,0.090664536849,7.494053499627,-0.228878918424 &
            ,0.030798272578,0.008955035934,-0.005013467632,-0.006983463933,-0.029699918268,-0.045032717332,-0.144306243298,-0.012683534335,-0.068710343055,0.063699000775,0.007192652399,0.011897044902 &
            ,-0.006336532576,-0.048225944896,-0.081289215992,0.005346139582,0.100096973450,-0.010740758670,-0.000465405944,-0.023535472838,-0.049308253941,0.017000144495,0.049859931961,0.001516821878 &
            ,-0.031774823955,-0.025815578990,-0.000099438271,0.013801572480,0.009752363320,0.164168630882,0.004873226168,0.005452941771,0.081168385757,0.029015753637,0.007643807325,0.056849247006 &
            ,-0.054333955245,0.060602299014,0.002483048893,0.036660275313,-0.072300209243,0.007590861811,-0.002097446493,-0.016499567238,0.007739603537,0.076081714494,0.190515282020,-0.012083900088 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/-2.1116,-3.9923 &
            ,1.1696,-4.9368,-0.054958,12.6495 &
            ,3.861,8.2068 &
            ,-1.8602,-5.2215 &
            ,-2.427,-2.7047 &
            ,5.2093,-0.70418 &
            ,0.50392,-4.495 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/-0.24547,-1.4286/),(/1,2/))
real, dimension(8) :: bias1 = &
  (/5.6082,1.9935,-2.1083,-2.6824,-1.5956,0.37071,-0.39228,-6.2169/)
real, dimension(2) :: bias2 = &
  (/-2.9017,-2.7514/)
real, dimension(1) :: bias3 = &
  (/1.5402/)
contains
subroutine fnet_Beldan_initall()
end subroutine fnet_Beldan_initall
subroutine fnet_Beldan_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  do i = 1, 126
    inarray2(i) = inarray(127-i)
  end do
  layer1 = MatMul(input,inarray2)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_Beldan_engine
end module fnet_Beldan
