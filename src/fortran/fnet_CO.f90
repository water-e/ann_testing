module fnet_CO

! a = 5.569e-005
! b = 0.090701

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/0.118681686447,-0.036800247950,0.106942766386,0.080528409814,-0.105421426948,0.295104275219,-0.256747884044,0.220964082235,0.072801833935,-0.060332057271,-0.094899918814,-0.041447133823 &
            ,-0.055191047346,-0.162613489410,0.112287545024,-0.089025523172,0.063500486212,0.004968303297,-0.157699121394,0.097414509263,0.045135976415,-0.344732658210,0.106978558853,-0.193404298996 &
            ,-0.119105784307,0.287260562875,0.200060867737,-0.049695406843,0.118136233803,0.340267507976,-0.327627629430,0.404434319720,-0.149982977376,-0.092947101544,-0.079675836674,-0.211765591759 &
            ,0.026495802923,-0.072765517060,0.457865112058,-0.414286731912,0.285953162188,0.060050505487,0.070028095625,0.164685288707,-0.135083388428,0.059193201889,-0.426379101968,0.414662995083 &
            ,-0.141991104803,0.001780437522,0.118614836469,-0.190963129325,0.025379804550,0.501955251456,0.519381442376,-0.504242326563,0.088357709975,-0.145565103887,-0.243896158981,0.180680897620 &
            ,-0.007244725826,-0.617694784282,-0.122631454979,0.019196614372,0.036920061927,0.417391549489,0.178968524258,-0.027575511017,0.093486517777,0.331559281133,-0.371601426571,0.403633271799 &
            ,-0.062270489958,-0.498558495587,-0.142410196660,-0.011212124893,-0.146286323451,-0.530425849165,0.128424798456,-0.188499302302,-0.142894738054,0.106885981591,0.241035431160,0.056058473401 &
            ,0.053936502972,0.370898755842,-0.264513807458,0.220572880075,-0.130892976888,0.200848884831,0.227784630498,-0.186557489319,0.062894495506,0.568159493300,0.329469552271,-0.256011854036 &
            ,0.074901242719,-0.154409336903,0.024675829463,-0.099642470348,-0.123053968111,0.308774963115,0.151399409632,-0.066368238107,0.144229289642,-0.258675095304,-0.177559207930,0.013447592455 &
            ,-0.131194612044,-0.109726141122,-0.183783408208,0.230718443371,0.023331940650,0.342449177394,-0.121932909785,-0.067483172518,0.217015963499,0.070406283137,0.235621878015,-0.201388632640 &
            ,-0.045390033650,0.046785585473,0.038933109112,-0.078173403665,0.026894090554,-0.258623392546,0.078823695995,-0.016675392191,0.304402856358,-0.091406206116,-0.061057498706,0.096869492623 &
            ,-0.167551649940,0.059912834317,-0.201662615345,0.158108601233,-0.166089929302,0.031823976111,-0.055043157077,0.055800300075,0.121265484670,-0.311721957595,0.129698028351,-0.234428477524 &
            ,-0.509529676929,0.252048779845,0.289078109265,-0.500795014034,0.429795855350,2.826370246447,0.171273347920,0.521154295235,0.158298156330,-0.793449753819,0.852090641153,-0.050877000295 &
            ,-0.769403240200,0.877262181973,-0.649200348288,0.792249154543,0.466859703971,1.815324812968,-1.120106450242,1.082716649859,0.987499498258,-1.092079318428,-1.132083175694,-0.062742997079 &
            ,-0.199073365671,-1.143833783518,-0.509981777589,0.190397374510,-0.080758883250,-2.903046929102,-1.649076132772,2.567115604777,2.286842060177,0.706723235356,0.160256843201,0.340867779567 &
            ,-0.786454411378,4.310760591710,1.246777054733,-1.715646477155,-2.002415793292,0.571570567723,-0.077346494231,-0.491962895457,1.116476127162,-2.651936745004,-0.999148452168,1.083066931349 &
            ,-0.112909227561,-3.416794911954,-0.068697304248,1.289043410092,-1.224022662234,2.587066703790,0.106425165748,-0.984974310417,0.707096262609,2.803757949987,-0.008298783321,-0.198978798538 &
            ,0.868431558749,-0.151371525448,-0.554022280086,0.942367961063,1.264319624889,-0.650201271960,-1.593964239914,1.073312666822,-0.151349742965,-0.733145215210,0.159741701887,-0.508098812113 &
            ,-0.158061659505,0.503483846474,-0.417206774475,-0.969351927735,-0.022115031014,1.061414294819,1.054849286405,-0.400352975667,0.013878177762,-1.570999535572,1.314673351751,0.160447043659 &
            ,-1.311205882814,2.203767117476,-0.336870261517,0.126199100550,-0.156066722898,-0.517359188344,0.063607409098,0.225149388278,-0.198701887688,-0.736330721253,-0.295305741788,0.126635256927 &
            ,-0.123399823828,0.208042204359,-0.333747059233,-0.045093113405,0.364347455991,-0.108924216555,0.569271113930,-0.398796842578,-0.029370714890,-0.880268202485,0.396788754523,-0.031815491000 &
            ,-0.652462066339,-0.063785549329,-0.043371645293,-0.058119490909,-0.550577286590,0.952202782603,-0.064042186550,-0.478510065515,0.789935971223,0.675926407842,1.828543214028,-1.483434273626 &
            ,-0.496001761536,1.993429028728,-0.293885082865,-0.133711700585,1.239730192329,-0.995606260472,0.250461218785,-0.452505206766,-0.155212441732,1.018761765633,0.330375616145,0.109037810912 &
            ,0.530355221128,0.699267004737,0.492664318811,-0.522356155852,0.821609763953,0.203236471312,-0.036819854760,-0.042251705438,-0.116523700766,1.991590208710,0.180959974986,0.381324499397 &
            ,-0.419328838649,-0.140399744205,0.294556605013,-1.123584192374,-0.348263616144,-0.484628225694,1.681974974433,-1.761413258848,-0.800692105465,0.666611399581,0.578840498280,-0.654187723291 &
            ,0.552469070823,0.287627139887,-0.649315768280,1.088512919258,0.360338210667,-1.909201715137,0.132812318807,-0.917280975442,-1.452338104303,-2.020576700458,1.715881284541,-1.686564263621 &
            ,-0.876647533599,1.973735211126,0.541808949964,0.149331249135,1.275029580882,0.915643057903,-0.222566830479,0.572774411159,0.693836155691,-1.709502459062,-0.064873037002,-0.431079986018 &
            ,-0.776932435671,3.751237583750,2.045781555558,-1.259048539053,0.668428696086,0.563873878260,-0.190209990086,0.842376473148,0.553243954810,2.495580973324,-0.096145607104,0.695930535774 &
            ,0.420932010892,-2.266213770625,-0.296120407652,-0.213279617159,-1.282502559216,0.379864556757,3.511546375616,-4.046219299363,-0.505783704013,1.404908912544,0.293403451756,0.503590756981 &
            ,0.791870319564,2.147666238955,0.729835946586,-1.506687029180,0.254407263610,-1.087517985136,-0.121769237877,-0.530903046990,-0.851304417588,-2.849312059786,0.646726738460,-1.262346577037 &
            ,-1.960008776497,1.817181322419,0.596111917944,0.054426011659,1.315827627032,-3.861600506581,-1.631199007520,0.933715654602,-0.544672981188,-0.291909627195,0.399190872443,-0.157146920299 &
            ,0.019020435604,-0.243267748957,-0.364113742928,0.510429513030,0.473584250639,-0.236052065686,-0.266827100907,0.327338908477,-0.236418482867,-0.270934881749,-0.366017686611,0.161415077954 &
            ,-0.444558581200,0.047174099413,-0.129483463251,-0.056063271447,0.282011585882,-1.195606811544,0.500925132035,-0.641875782527,-0.228849426007,0.621782632065,0.255247139820,-0.173489688219 &
            ,0.279651629293,0.164710240930,-0.539837596842,0.703050958567,0.141913171205,0.030872682843,0.184433221769,-0.012388543724,-0.141297654698,-0.158268566891,-0.235526854444,0.295659992636 &
            ,-0.228204132310,-0.199561167853,0.002962383071,-0.029886709780,-0.038596663305,-0.446534549543,0.082336622214,-0.144735453491,-0.431932116284,0.116404094853,-0.115122362499,0.101846454734 &
            ,0.399184224472,0.253560369854,0.226367134790,-0.283113009437,-0.066829427092,0.086534198062,0.314797218970,0.454265396700,-0.028589052011,0.147235164642,-0.390988711529,0.183217952438 &
            ,3.041994015045,-1.234761590773,-0.762235525710,1.776508414088,-2.032157806060,0.821711950296,-1.547948199428,0.006609993379,-0.892983184874,-1.750196804310,-1.966199838805,1.914259637889 &
            ,1.448401678647,-1.178171735621,-0.434672376756,0.255755966734,-0.704746384657,-0.109668868910,-0.193903957108,-0.023345856641,0.126826231821,-1.799589115830,-1.849242787765,1.339704365336 &
            ,-0.074027095038,1.003583093816,2.000668139734,-0.465856999010,0.070621705083,-2.780589680549,0.834828733186,0.183719515764,-0.145205182082,-1.529077188711,1.345416954371,-0.837173588232 &
            ,-3.133308763603,-1.445699722275,-0.648088799085,-2.101214020160,1.904842493783,2.137775524291,2.478691393524,-2.269615964630,-0.921225381277,-0.720965739900,0.766013101308,0.884584719069 &
            ,-1.021922940583,2.729773936038,0.579492562700,-0.539489684291,2.000950790127,-1.046241100699,0.346019255660,1.879983433491,-1.582747668081,0.661806532483,0.812005733003,-0.583516468115 &
            ,0.788381670855,1.255052058505,-1.682058789705,0.651938816282,0.181939295846,-0.931810356365,1.522721967614,1.290542799276,0.671617385055,1.427034589439,-1.542101598978,1.150868212547 &
            ,1.666697492514,-0.382776930139,-0.507988410177,-1.904398714677,0.331260785375,1.403939203609,0.326887456523,1.651665523822,-0.301154751675,-0.779599150788,-1.153547098345,-1.524726367975 &
            ,0.642803785076,1.178418719915,-0.182434742521,-0.108009167290,-0.801599978512,-1.148573729510,-0.117596968831,-0.133406928978,0.670915692968,0.963155986674,0.943064236785,0.730986391617 &
            ,-0.905111754605,-1.222634787680,0.067881634134,-0.105837654145,0.778405326057,0.799445951840,0.842227682006,0.762030212229,-1.012845372102,-0.949080002516,-0.133567935952,-0.310920836854 &
            ,0.656364410712,0.896817620243,0.113872967767,0.317860620012,-1.250424080494,-0.604616244085,-0.201065725382,-0.448104022382,0.408506765497,1.085584006994,-0.790185901548,-0.279679491494 &
            ,-1.609136285818,0.170499598251,-0.376848879831,-0.331335912097,-0.231965367230,1.095915157989,-1.306046579015,-0.503139883077,0.071030294664,0.546571099657,1.026493199150,-0.433322310655 &
            ,1.324182810114,0.407074900083,-1.195153472982,-0.099892543440,0.019442546654,1.439178581092,1.306818075061,1.427870139674,0.453401765357,-0.013067634861,0.239500896515,1.225209609717 &
            ,-0.527434455064,1.190650054889,0.758040948785,-0.764994438822,0.218525880370,-0.041643528106,-0.692482732625,1.003109405556,-1.496634017315,-0.290085008683,0.889071034334,-1.214879818413 &
            ,0.755502755899,2.217959549829,1.351189894538,0.361584272135,-0.999341249513,-1.590671910206,2.488918669074,0.327228385952,-0.528620690424,2.635927742599,0.747062661508,-1.117469304298 &
            ,0.402151410340,1.218998598965,-2.745820997345,0.372565184359,1.212689686186,1.069308071696,-0.985668290121,0.843816855183,0.772767969465,-0.367997094934,2.228043561074,-0.185106686118 &
            ,0.005374059166,1.634938758383,-0.769138560947,3.578356579409,0.259052676196,-3.072115134891,3.881315885114,2.001546349989,-0.292870812234,2.568669301785,-1.593210842213,2.473339790859 &
            ,-1.107678763019,0.675965344675,1.368252931660,1.869311618432,-0.183766807452,3.123779319627,-3.361667133011,-2.010338181429,0.678283910232,-0.271078387512,13.952386136378,-0.450683395281 &
            ,-2.518321039809,-2.109941062141,-0.035175983153,-0.639371285994,-0.354245198177,-1.683727924753,8.927269023055,-2.454513781053,-1.656436104620,-1.389178555557,-2.647927153173,-0.326457979342 &
            ,-1.413539543408,-3.872339424539,7.754746059441,-3.462192601282,3.111402222969,-1.302231487295,-1.908955708609,1.349502689182,-3.819714928889,-2.649966050157,-1.234385343225,-5.089231463902 &
            ,1.763535861776,0.527798384960,-0.321722604040,0.723499218390,-3.017947374549,-1.767738101167,-1.400422190873,-3.679300703004,1.296247093497,0.793984998457,0.274659645233,1.002354786073 &
            ,-1.444095074925,-1.093279023582,-1.367083135899,-2.445812183196,1.993331367682,0.545955000610,0.966645948165,1.069338123377,-1.560310722166,-1.059962307141,-2.273058805290,-1.259898684849 &
            ,3.012079924896,0.369794389995,1.388408420064,0.603248019652,-2.250844472455,-1.396983772453,-1.224794237203,-0.468231301399,3.596308034465,0.030136470466,1.303043617797,-0.131443594378 &
            ,-3.184849953709,-0.549830944391,1.381003008309,0.157718404772,2.487324700330,0.009720259601,-1.169425059499,-2.394521575283,-0.265268611300,0.764897206523,1.572210310833,-1.417457631752 &
            ,0.066239811567,0.702546818097,-0.802520577039,-1.141909268172,2.353890910131,0.631696050051,-0.082746839555,-2.815938715852,-1.218465499666,1.093552827678,0.920954444183,3.794347090124 &
            ,-0.700782032862,0.511541447072,0.122465047051,-0.610465533261,0.461591292263,-0.381221909846,0.663896650425,-0.332703159548,-0.447381921983,0.308672918164,-0.126933938837,-0.177524872951 &
            ,0.459840733774,-0.013218577159,0.986099140883,-1.057842235507,1.814224780402,-0.135062556572,-0.480090020665,0.899483640591,-0.708422385562,1.107581505763,-0.739325906901,0.367564198396 &
            ,-1.133993999191,0.303907057780,0.969909705534,-0.907347366534,0.202957162057,-0.711824513338,0.845807365346,-0.450643113702,0.262662834594,-0.355947346572,-1.381089286921,0.887395438104 &
            ,0.382109714874,-1.308923558086,-0.690937645940,0.292631568102,0.532867526134,0.849770450627,0.271895070320,-0.406083598511,-0.349903824878,0.457569298212,-0.450436469184,0.376721236757 &
            ,-1.482014529526,-0.678678177389,-0.187959432930,-0.290352296436,0.641047108113,-0.631890062951,1.329755422617,-1.043026253099,-0.169789021793,-0.544512170040,-0.160953844464,-0.095639786915 &
            ,-0.409274961313,-0.409819984643,-0.631743630659,0.673831979226,-0.249243017747,0.535349426377,0.042497940629,-0.701068946382,0.110183984756,2.096971253275,1.828040326992,-1.493354199112 &
            ,-0.480016743095,0.825033605854,0.157623712414,0.196549888860,0.346054076985,0.834147215939,0.208237189551,-0.159603433714,-0.305461070165,0.214631666766,-0.052395338864,-0.007963804008 &
            ,0.272175751594,0.354721381584,0.237627656853,-0.161825946776,0.061843758802,-0.002025304739,-0.082942528719,0.066013682700,-0.091924926899,-0.987216358974,1.027473445111,-1.299053082937 &
            ,0.485446483903,-0.079877920398,-0.213025335618,0.464047186806,-0.161966391914,0.111621677233,0.069658653946,-0.295745220124,-0.461644477987,0.317074347734,0.084702646560,0.036557007161 &
            ,0.282813570021,-0.466806339110,-0.503843992665,0.498476270405,-0.461357224950,-0.157302970926,0.153769679477,-0.329910418550,-0.077082824075,0.009491701806,0.496391339072,-0.510095106446 &
            ,0.757913984531,0.212091449763,0.228013634494,0.286540764557,-0.439228814448,0.397509129289,-0.521950239322,0.550875807369,0.845543237036,-0.704336445054,-0.210811341277,0.297467334937 &
            ,-0.764407674183,0.080989047488,-0.522518839809,0.511387698135,0.033487560023,0.435922767948,-0.070137799095,0.028662417102,0.203881735409,-0.047442882074,-0.350066120428,0.411430311801 &
            ,0.161181056663,-0.959968933540,-0.283850581419,0.295563930072,-0.434849657678,-0.682505887994,-0.447779617116,0.306823547768,-0.012503888239,0.329823827589,-0.236213482478,0.088824615643 &
            ,0.268025477701,-0.475591969093,-0.274773023724,0.244064124039,0.226861602130,-0.046502016848,-0.058569597441,0.039321406532,-0.115990103981,-0.395926543256,-0.316453993237,0.404315645237 &
            ,0.408066933838,0.196944615317,-0.229079643668,0.447738171970,0.116023573808,-0.742779290742,-0.753009750279,0.802014838460,0.456909594060,-0.087497328125,0.025950678376,0.129703970791 &
            ,-0.273016479138,0.232681447619,-0.384286606534,0.417041720708,0.580882914283,0.096914442940,-0.270818155836,0.291236994231,-0.058897949260,-0.111832996226,-0.319537310231,0.373474328612 &
            ,0.026400335332,0.198165443056,-0.165183622172,0.027767552013,0.054307396182,-0.647869817429,-0.044469289227,-0.099761978145,-0.337709291072,-0.010377518668,-0.004941228586,-0.084540791238 &
            ,0.213031567730,-0.141051746657,0.179334733003,-0.076055844316,0.170362568380,-0.227161110403,-0.074846390760,0.104967726315,-0.191166990483,-0.370599757108,-0.363280893872,0.369145615980 &
            ,-0.080342599400,-0.097202941826,-0.094587627535,-0.015148232084,0.009819739730,-0.229637152159,0.178889538124,-0.251015005596,0.021649543618,-0.006152370466,0.056364021095,-0.049673325513 &
            ,-0.052561308810,-0.047744075922,0.011712221390,0.036387342013,0.026064921036,0.038699595880,0.021427549018,-0.026017433026,-0.006965211314,0.092236986517,-0.107165240395,0.168216768669 &
            ,-0.014073264869,-0.038861118197,-0.011482238660,-0.015923659638,0.000744255256,0.131511963185,-0.070351984462,0.119422121707,0.060460471390,-0.041252664540,-0.150211629426,0.206585901123 &
            ,0.055259416468,-0.248887156328,-0.486755264384,0.467024813818,-0.019795378797,-0.154034306368,-0.018222279151,-0.024409461458,-0.063248608499,-0.041955656237,0.036014191655,-0.013497254385 &
            ,-0.056764242522,-0.033656128278,-0.033781496994,0.032846418579,0.036694823869,-0.052574625413,-0.115836837578,0.135485500333,-0.015838005405,0.096463845639,-0.011746782114,0.085345966713 &
            ,0.079105906181,-0.068131389549,-0.182038635247,0.171075243369,0.062678780054,0.046606429666,0.044256124859,-0.006250344535,-0.019587021673,0.215829322564,0.126074801365,-0.119937896180 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/-4.5101,-3.3098 &
            ,4.7626,-3.723,-9.5876,10.3202 &
            ,7.3872,-4.2191 &
            ,-9.1407,7.1394 &
            ,4.0956,-4.4762 &
            ,5.9394,-1.0272 &
            ,4.4513,-0.59502 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/5.1613,3.7504/),(/1,2/))
real, dimension(8) :: bias1 = &
  (/3.7889,0.84183,-2.2828,3.6685,-2.5433,-1.9275,-2.798,2.2943/)
real, dimension(2) :: bias2 = &
  (/-2.9229,3.5047/)
real, dimension(1) :: bias3 = &
  (/-3.649/)
contains
subroutine fnet_CO_initall()
end subroutine fnet_CO_initall
subroutine fnet_CO_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  do i = 1, 126
    inarray2(i) = inarray(127-i)
  end do
  layer1 = MatMul(input,inarray2)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_CO_engine
end module fnet_CO
