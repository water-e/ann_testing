module fnet_X2

! a = 0.014976
! b = -0.56379

intrinsic Reshape
real, dimension(8,54) :: input = &
  Reshape((/0.280811591417,0.684617773169,-0.132829706236,0.414745172900,1.175403059537,0.752529891474,0.829830052661,0.001375914867,0.904639448680,-0.344781632896,0.195677801774,-0.857029832844 &
            ,-0.185443382511,-0.091631131069,-0.053698306105,-1.158840569893,1.996086444708,-0.053591933240,-0.569870970906,-1.391320056398,-2.616171402356,-0.106387096573,-0.160844352313,-2.398057215402 &
            ,0.148994768783,-0.347007290593,0.215285973340,-1.037209444652,-0.595201649118,0.351797751397,-0.091792241961,0.535918610109,0.320193332135,0.397330107074,-0.446421455918,-0.477136303917 &
            ,-1.544132265373,0.276110491161,-1.240226806560,1.797475507697,0.629971101804,-0.605413969535,0.919882041659,-1.383063191699,-1.249895030586,-0.543012623564,-0.795137654560,-0.595790766963 &
            ,0.097951286754,0.382720001348,0.503095148426,0.510812233437,-0.215226597505,-0.364974244016,0.287527211187,-0.414159938895,0.263962117916,0.269985936070,2.063326401695,0.749105061972 &
            ,-0.379831022833,-0.623422675698,1.856942070588,0.355969819974,-1.195526342057,0.402944739621,-0.430227899351,1.023701272414,-1.267944534937,-0.215594488477,-0.503381147559,1.404679989557 &
            ,0.070420395831,-0.061699105978,-0.587476081869,0.617298339064,2.056171986541,0.636262397767,-0.113334745169,1.448681788390,-0.245331478068,-0.176824298929,-0.199494514055,-0.149907063230 &
            ,0.059433099039,-0.174570900953,-0.249663184322,-0.710460297864,-0.135556367622,-0.000431869133,-0.164828292184,-0.377522284133,-0.154994675129,0.135451412624,-0.120987911205,-0.274189499569 &
            ,0.111754529806,0.071750477641,-0.092059063389,-0.173586641012,0.018632900725,0.122468085454,-0.008349247080,-0.088384801487,0.348525298311,-0.004216232255,0.082063158432,-0.002927713706 &
            ,0.044397400692,0.015170878548,-0.039658021028,0.234887953012,0.476920050196,-0.084746402986,-0.403937302512,0.361855240041,0.232574798342,-0.045169676604,-0.174051938119,0.195717882002 &
            ,0.575255011402,-0.092613231916,-0.244087329109,0.042624825106,0.284838405184,0.188321350863,-0.056357948462,0.223500354175,0.548155759929,0.069663849396,-0.154526763312,-0.054290031778 &
            ,0.130163217471,0.026693913167,0.074747836634,-0.079463985075,0.333384978132,-0.403149552768,0.038787082413,-0.102647935174,0.016515684222,0.179807206647,0.229377095498,0.029739204074 &
            ,0.335305833417,0.149543663130,-0.336994645144,-0.332798866865,-0.135700203084,0.137764802980,-0.182790144578,-0.088232062379,-0.080959395120,-0.134674051358,0.729156835511,-0.049432642380 &
            ,-0.030912006404,-0.242126893562,0.348389221741,-0.260330918403,0.329400643382,-0.121571807933,0.531779761049,0.690699704698,1.190187318718,-0.488635165832,0.189956869442,0.416706271763 &
            ,0.187503305867,0.054173274918,-1.439761864912,1.462096626331,-1.293828422536,0.052200041176,-0.258298596087,1.139721078803,0.058110671823,-0.134743957361,0.658612626444,-1.017698576978 &
            ,0.838951592237,-0.124275613943,-0.232931683958,-0.914879109073,0.187838122806,0.003588838790,-0.126284386216,0.222926066772,-1.009584700401,-0.115070434684,0.072272649841,0.117628740656 &
            ,0.309413163722,0.072942678343,-0.205164087426,0.370991574556,1.162248524635,0.161472275219,0.004747549694,0.299098329596,0.324466275721,-0.140577801544,0.830915678695,-0.405998986258 &
            ,-0.741322620090,-0.093620288812,0.289225605867,-0.325702972591,0.051636969340,-0.179866606059,-0.764273556402,0.816310257055,-2.079985859380,-0.198358669993,0.031525368367,0.510053943897 &
            ,-0.115727658468,-0.009108392622,-0.435588573569,0.758113935434,-0.106696049253,-0.614071437109,-0.300112689654,0.458371329225,-0.236270999465,0.020983337118,0.149208682548,0.447537289150 &
            ,0.965218591950,-0.233324084572,-0.257527061048,0.605895008840,-0.057520522116,0.014268667244,0.423904947435,0.188142338093,0.596146835031,-0.244141396470,0.098172098615,0.217181614415 &
            ,-0.011404756504,0.071517988455,0.494725225235,-0.133680252541,-0.062680652926,-0.104035577033,0.198845751268,0.082632505439,-0.001624483190,-0.110301574684,0.276063480626,-0.081085266481 &
            ,-0.130734540688,-0.223966681224,0.076523846993,-0.227161596835,-0.010448943782,-0.094110979470,-0.014899305245,-0.264920461210,0.347436050920,-0.188071971726,-0.317768239524,-0.230842317001 &
            ,0.061384326082,-0.211112138182,-0.015412486783,-0.204720474748,0.251366407434,-0.141860531604,-0.192239437200,-0.375546961190,0.097266964505,0.185595159383,0.166391297510,-0.340592668857 &
            ,0.686996856529,0.134654163462,0.203326252014,-0.266036370999,0.109415514631,0.640043396855,0.852696971067,-0.783981398495,1.319192228064,0.109545218495,0.589231647045,-0.215229698620 &
            ,0.280918883657,-0.118635376846,-0.020023781651,0.334332189498,-0.016929245209,-0.431969001903,0.078503693060,0.038886869764,0.209253591433,-0.115946895939,-0.538349012708,0.898657594295 &
            ,-0.737525013479,-0.219779468191,-0.440461571303,0.772116086170,0.335062202512,-0.221163112032,-0.424988085988,1.077706343451,-1.014850438954,-0.469689093660,-0.178153795284,0.590433856570 &
            ,0.227622170509,-0.275002906041,0.810502831577,0.090695750737,-0.281282722483,-1.160763683467,-0.039759578135,0.100650682832,0.282397271645,-0.294397103810,0.805817399223,0.107304903850 &
            ,0.888976846952,-1.048172585043,-0.665413714418,0.188491140639,0.201948206607,0.103773544882,-0.827477912884,-0.101743478265,-0.776581142142,-0.369160313857,-0.158665614365,0.061666116314 &
            ,0.748515276136,0.294729540265,-1.312921328950,0.744434724005,-1.317641756261,1.225005658974,0.957041448178,-0.231963818999,0.698461530500,-0.190797428161,-0.473702480836,-0.007425901211 &
            ,-0.870711151082,0.529581389582,-0.342460037657,-0.082634305643,0.460609821992,-0.421781490737,-3.238876199291,1.211576871612,-3.479471157251,3.674240170093,-4.506176539994,-0.309638062104 &
            ,0.001098710355,0.209640555962,1.417006059448,-0.152814483141,-3.778150102371,2.757631020067,-13.831371124152,-0.448798231576,-0.437655173244,0.901537950501,3.566818846978,-1.269506008926 &
            ,0.262255514321,-0.637096189090,-2.834029190959,0.024458093553,-0.521407464240,0.267564170446,2.772979242348,-0.937978631655,-0.008238726026,-0.315134945192,-2.347703444095,-0.077144296758 &
            ,-0.517323184155,0.899807010201,2.180814558848,-1.006920100580,-0.286508302906,-0.679269555245,-2.436186584000,0.015991650191,-0.586987472118,1.516638449652,1.831555273845,-0.919477224433 &
            ,-0.221580742701,-0.369375541132,-2.451252635956,0.213649440801,-0.689134819004,1.916041165369,1.732487875995,-0.310783494311,-0.191818504398,-0.594789697334,-2.171728618939,0.248417968204 &
            ,-0.940946284871,2.145966387682,1.624149336108,0.663738627257,-0.345638140808,-0.857902063772,-2.290096269331,0.230395431400,-1.163064518498,2.009329628128,2.131398116390,0.858433030201 &
            ,-0.122886080522,-1.132099373717,-1.618209371214,-0.265170687172,-1.196082203525,2.102443685933,2.725584912656,1.092289094937,-0.774839743507,-1.147135623558,1.142596205878,-0.732838008838 &
            /),(/8,54/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/2.9449,2.9576 &
            ,-4.9981,-0.59532,-1.514,4.8697 &
            ,-1.8165,3.518 &
            ,4.4932,-1.0452 &
            ,0.53829,4.5891 &
            ,0.81653,-11.652 &
            ,2.8275,-1.7113 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/0.39455,-1.0712/),(/1,2/))
real, dimension(8) :: bias1 = &
  (/1.104,-0.90709,-1.3504,-1.1623,-0.51909,1.9866,6.1908,-2.2109/)
real, dimension(2) :: bias2 = &
  (/0.89346,1.9168/)
real, dimension(1) :: bias3 = &
  (/1.2339/)
contains
subroutine fnet_X2_initall()
end subroutine fnet_X2_initall
subroutine fnet_X2_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(54) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  do i = 1, 54
    inarray2(i) = inarray(55-i)
  end do
  layer1 = MatMul(input,inarray2)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_X2_engine
end module fnet_X2
