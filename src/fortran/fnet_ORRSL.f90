module fnet_ORRSL

! a = 0.00057239
! b = 0.038113

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/-0.157750281436,-0.219567392955,-0.003306988844,-0.401437944206,-0.192003750613,-0.005882399350,0.177093263013,0.158594658806,0.051393768739,0.107576427649,0.076063623576,0.499296940660 &
            ,0.104877702989,0.052892847374,-0.285813220556,-0.056269720155,-0.013382262440,-0.337443819531,-0.129237408815,-0.398156392327,-0.114064125219,-0.083198587486,-0.382664887424,0.002208403926 &
            ,0.025524178753,0.234641547432,0.077103259889,0.186488294202,0.087310009373,0.068265766453,0.207417080898,-0.029343546710,0.148843115927,0.121615183623,0.090537031245,0.315851397892 &
            ,0.194221847060,0.055324684570,0.297465061563,-0.150080061932,-0.194196180512,-0.635734421632,-0.115596479161,0.091884028681,-0.274784984720,-0.076672812717,-0.113573512717,0.193857892347 &
            ,-0.102083349192,-0.018804849920,0.038750367933,-0.103455410898,-0.165211737973,0.063795198327,0.315257528616,0.101662367318,0.176030318163,0.064116128849,0.402022468405,0.403786592696 &
            ,0.326878525231,0.329963152381,0.777881514020,-0.214237595237,-0.226166900633,-0.527533727824,-0.103445201386,-0.198152762329,-0.384428855214,-0.018575272037,-0.284461695877,0.211739885216 &
            ,0.206679819836,-0.118534536964,0.163765482031,-0.011978568657,-0.038798472020,0.148862035763,-0.272642866943,-0.220792451895,0.073648229835,0.153861227533,0.054587206484,0.167056852137 &
            ,0.150004277857,0.024687173044,-0.130307277357,-0.077425925445,0.031389542129,-0.007685295306,0.039063625088,-0.036969843135,0.001700040646,0.035081331405,0.000414467941,-0.040250826416 &
            ,-0.005570104865,-0.064659831607,-0.025675537056,-0.082902766528,-0.008041749934,-0.022628639086,-0.069872885702,0.007022919843,-0.042638519637,-0.060367490054,-0.010623695800,0.102204068965 &
            ,-0.017721451885,-0.006148309346,-0.187925084561,0.031793219277,-0.009385651789,-0.001769838371,0.019346495320,0.050074840404,-0.016145632044,0.014711305364,0.016094793790,0.012999837344 &
            ,0.012497376825,-0.006470161611,-0.020406223623,0.058159404688,-0.018394055553,-0.019773737194,-0.021319676654,-0.001796704615,-0.073351054815,-0.119337599859,-0.058581495227,-0.026078483483 &
            ,-0.095131749469,-0.040050817518,-0.035683360102,0.076743084252,-0.128127100118,-0.028732572204,-0.069928325698,0.313328739052,0.005151006917,-0.056425710726,-0.172400905380,0.123785188548 &
            ,0.593556599060,2.661141260836,0.001761155712,2.399318634199,1.221487116068,-0.043743562055,2.001942615373,-0.525584289024,0.234086060203,-1.222669907202,0.458492705304,0.020915053136 &
            ,0.047351359305,0.441128595812,0.470264140458,-0.409821818062,-0.175616504002,0.444265887521,0.527218473212,4.274099477266,0.432673980246,0.475473258260,1.091109429591,0.082720905663 &
            ,-0.063109866877,0.386337285537,-0.770107008203,-0.647736118810,-0.203871912999,-0.576627498671,2.428216316052,0.100445994362,0.222418975516,1.238802530506,-0.065316413936,-0.552253999471 &
            ,0.106480658384,0.025829010962,-0.159567679512,-0.239198978489,0.510347316606,2.625320060751,0.399666987624,-0.878097583732,0.592101961599,0.258525148407,0.297348546707,-0.502202670455 &
            ,-0.348142521524,1.677102443720,0.757647507875,0.882253311888,-0.147864397827,0.585686756883,-2.082466279076,0.070963793609,-0.374640709606,0.801423919392,-0.112453088649,0.514959437956 &
            ,-0.918655641876,-0.255068606528,-1.690821407553,0.422516234440,1.773686744987,1.886273712364,1.067669586496,0.811711498619,1.407911635686,0.290420573768,1.095980637859,-1.825967553750 &
            ,1.719306450219,1.549434099302,1.182326183186,1.881949163930,1.170462560363,0.457653308788,-0.337442215872,-1.732708169088,0.407426314798,0.288327574222,0.402012883567,0.192260049475 &
            ,0.119119967923,0.295178942181,0.027178152376,-0.384676393254,0.072616787617,0.477161276869,0.226617856204,0.444081666037,0.060263725429,0.163900886871,0.055971528678,-0.049903670762 &
            ,0.175409943563,0.960205302841,0.295643864772,1.790010192307,0.562127891147,0.153362452884,-0.851999917598,-0.174449971780,-0.026880642382,-0.587441075532,0.081164898396,-0.163062941536 &
            ,-0.295115558027,0.081256641718,-0.485209370494,0.017609620833,-0.050712731290,-0.457851700698,-0.184504078116,0.733861725005,0.041779174216,-0.152053560663,-0.962472277829,0.025775197102 &
            ,-0.223079058391,-1.065874467677,-0.033716052603,0.770967682606,-0.265657416826,-0.050848985706,-0.440295338537,0.213172110029,0.079577574005,-0.260497865068,-0.258302144121,0.214999207441 &
            ,-0.000111258192,-0.191388135741,-0.694507530823,-0.056877180498,0.072687203036,-1.318471380502,-0.361115976375,-0.682974150870,-0.550491343537,-0.213262080630,-0.533232806509,-0.079387937337 &
            ,0.873792177127,-1.065399395172,0.374499836285,-0.114566908949,0.190138017463,0.182806316714,-1.318983318946,-0.825135034506,-0.656836665038,-1.936802824343,0.133672857950,-3.001161695208 &
            ,-1.642358719764,0.216683763578,-3.140524357562,0.685545798691,-0.023892442507,-2.542920245341,0.502490720502,0.734393322520,-0.724362042079,0.369671565495,-1.503795430286,0.068362818904 &
            ,-0.072120092131,1.048912837757,0.482267978918,-0.006795192382,0.249233579565,0.467999701477,-2.625193951974,0.032601049442,0.030681035578,0.747305339072,0.638195750819,4.159524286331 &
            ,1.171091026034,0.409532049464,-0.083062490604,-0.048672841678,0.448695566487,3.886136831037,-0.097213855363,4.250067758066,2.503923822599,-0.220312282733,-0.127055442290,-0.470599747211 &
            ,1.451417329371,2.674009025333,-0.301320041193,5.759184928300,2.968047976768,-0.578840201858,0.733715038067,-1.398606646428,0.606086217309,3.092815906440,-0.535269842268,2.511919695480 &
            ,1.900387219522,-0.524386241748,-1.790492538703,-0.691854520602,-0.714289218543,-4.693413859907,-1.526328155406,-1.783336098412,-2.064534084646,-1.087190011228,-1.677655439531,0.757439864058 &
            ,-0.771647393790,-4.655306238503,-1.426251672365,-5.407487935134,-2.662623670809,-0.870884466187,-4.677730528883,0.733761501273,-0.254195849991,-0.335315118977,-0.156741834021,-0.356829937138 &
            ,-0.291860825535,-0.112940042807,0.070277024035,0.266966563683,-0.112027481573,-0.825257466013,-0.143356986877,-0.651122106637,-0.469675622804,-0.093780018760,-0.481070538827,0.116061943384 &
            ,-0.354098367939,-0.501072511480,-0.140302940053,-0.769978435590,-0.454369885066,-0.080115476094,-0.484538846788,0.348550318113,-0.127017754498,-0.597567073518,-0.156638107844,-0.698257323661 &
            ,-0.388323309917,-0.113437472372,-0.240559800036,0.147337432484,-0.141681679049,-0.634611636755,-0.024026162634,-0.279467174109,-0.371644299506,-0.007684998708,0.039753029765,0.150331983563 &
            ,0.054317446422,-0.461530775681,-0.071743667777,-0.473604267056,-0.159660975063,-0.077493608978,-0.115009335220,-0.019011062469,-0.176612457584,-0.266922273311,-0.064486557334,0.089735922502 &
            ,-0.156917424860,-0.036741385570,-0.458218789376,0.159707952077,-0.042095271691,-0.197973307119,0.014036612770,-0.455606293492,-0.251650498735,0.030574898897,0.057347277015,0.056025813753 &
            ,-0.434540819281,-1.099865170513,-2.044207359385,-4.136868781709,-1.020175929058,-1.665067645409,-14.523995761691,0.894663745001,-3.221692739169,3.102756655913,2.715680751258,0.835269497582 &
            ,-0.885857739558,2.176260411830,-0.034626250289,2.943187754855,0.774890562673,-0.453152677309,1.312068374278,0.386858837976,0.883896413385,1.685379632866,8.394548045768,-1.018585579679 &
            ,1.399127346256,-3.222128072905,-2.735689421710,1.997327956153,0.304020407803,-2.291364735695,11.693860749751,-1.428538542399,-0.600542503994,-3.429304069966,-4.040188522783,-4.359443170053 &
            ,-2.176991224514,-3.278872609142,-1.835241291369,1.989665574310,-0.945336972206,-7.972859193706,-3.007371446811,-3.332532717675,-2.646084261538,-2.443141166941,-5.705817861555,1.487217025530 &
            ,1.273454760575,7.756476091816,-1.755373075771,5.439717407324,2.516232461867,0.546894883935,-21.434201990483,-1.498900763376,-3.437956247789,4.846632041216,1.559990839552,0.040557587363 &
            ,-0.680726099763,2.412703507529,0.483994627024,5.627691053469,-3.171491268432,5.028029544402,1.549265094757,-1.059360771692,-0.926134008050,5.120468890297,1.562413464951,1.767304425641 &
            ,-4.212081755305,-0.993914022214,-2.648420162310,1.542315106358,-1.204557504698,3.249686632557,-2.717390651272,3.067686417425,-2.918113614214,-5.587825419732,-1.832080910198,-2.044449757268 &
            ,-2.786515372866,-0.147475098117,0.914703682597,2.587380943935,-1.607313339786,-2.893696881247,-0.413604690247,-0.544335821768,-1.907992939284,-0.770096815324,-0.181333018996,2.316257887106 &
            ,-1.413358259973,-2.153103248924,-0.146048918446,-1.038867497862,-0.947644506125,0.075174475874,-0.506321137855,1.698863809752,-0.698416916263,-2.141833772905,-1.005137223962,-1.212734032155 &
            ,-1.220531126134,-0.551359758465,1.031757407067,0.781003072757,-1.420726093877,-1.946232473196,-1.549151726845,-1.933905289230,-0.569732856795,-0.412215387236,0.005913262697,0.997684748154 &
            ,-0.822350234288,-0.987187540288,-1.322422426406,0.320632843763,-1.185314901010,-2.774947492216,-1.363785815949,1.811959782383,-1.099284673034,0.208065534306,-3.221575944156,1.861343776265 &
            ,1.691413040387,-0.171472256492,-3.396862857867,-0.160803963109,-3.355674764132,1.309195180009,3.741479235392,-3.602129819670,-3.464166358448,2.302310760322,2.890836240991,3.712617467000 &
            ,0.966910998219,3.482052552865,0.506133936138,2.618440730602,1.699253626071,0.177698442765,-19.900522018872,-0.585701133437,0.730428805412,-3.673475409508,-1.432745720217,0.637556741225 &
            ,0.032124564542,-0.825795063407,-4.489526230810,-0.066011146332,-0.669052489733,-1.366209948378,-0.895485303053,1.204435261930,-0.815405701347,-0.277382792832,1.218772149586,0.119092013132 &
            ,0.191859738134,0.724828018228,-2.756986853923,-0.727162291513,0.031829656770,-2.075316996989,1.155774121448,2.212205559113,1.495260335016,0.645095985852,-3.427968035661,4.695173364368 &
            ,2.122231218118,-2.856719518184,0.178931223438,1.930854189546,1.988259271106,3.070472550712,-5.886773390460,1.763308284511,2.031118451246,-1.665396153785,1.722404316647,-0.547008632714 &
            ,-0.403140645256,-0.167030465325,-7.233089803519,-1.574354346971,-0.570255454766,-1.029555859994,1.522612751019,4.492826893778,0.618447497278,-2.009416801055,-0.527626199233,-0.725527995643 &
            ,-0.459870289031,5.018826407853,0.636835405772,4.350140067460,1.775407193883,-2.261131189441,-16.463165726911,0.480854891597,0.873278438143,1.109268014281,1.756529664368,0.036361764825 &
            ,1.140640726926,0.031412572684,-11.467610781084,-0.430566729835,0.417764249902,3.125651282118,1.471129848214,-1.406796564629,-0.109031242424,4.359388477250,-0.484808916591,0.125686916339 &
            ,0.478282375924,0.498993535077,0.160702780697,-0.139009163336,0.766598290734,3.365782267529,-0.782754882128,0.969847403218,1.021072172528,-0.319029374311,0.019658952953,-0.345796645624 &
            ,0.348574103831,2.774870909827,-0.791731967323,1.154257231254,0.499113467449,0.210928463015,-0.392063570014,-0.391324056054,0.215700349617,0.088421321648,-1.203892273411,0.801218774037 &
            ,0.509289557387,-0.601635800956,-0.001443313241,-0.165582921875,0.070861008942,1.121063462330,0.418781546342,1.592266593095,0.486185257435,0.639791524426,-0.407438226933,-0.334174918290 &
            ,-0.700630384055,-0.404584246261,0.227119704890,2.136160269952,0.176909450028,0.237493679989,-0.146359614379,0.650355931464,-0.184240683555,-0.627299244573,-0.327508079046,-0.286780932598 &
            ,-0.360081212473,-0.287136647883,-0.248358622096,0.346941361904,0.710735873171,-0.718961472296,-0.185439477958,-0.059743999582,-0.094421183412,-0.068280301728,0.005474095657,-0.829563728669 &
            ,-0.128962593678,-1.766968873679,-0.922261920275,1.068458745509,-0.361075714927,-0.761393027969,0.155337915520,0.186958818359,0.603501512289,1.839291213872,0.878996340346,-0.901282843178 &
            ,0.668857766467,0.684249572988,1.354796600484,-0.640746454807,-0.209766436061,0.022670548529,-0.038563204312,0.679801720916,-0.039846532627,-0.099954264846,-1.886788187584,0.256277393917 &
            ,-0.228288656754,-1.497713764300,-0.361027029955,-1.280098285319,-0.491800763912,-0.262331409773,-0.540879347640,0.085160112302,-0.196079828088,-0.020169804264,-0.046951104087,-3.746301074744 &
            ,-1.011622803876,0.017212378311,0.323333824307,0.066634747895,-0.127278801118,0.327883534353,0.266860397799,-0.557569019418,-0.090304746748,0.069892019364,-0.317161619904,0.010388737974 &
            ,0.171441153668,-0.173967550123,0.616638785414,-0.535410059979,-0.075723165802,0.260089258591,0.477268088495,-0.435614770820,-0.452837871595,-1.065544448620,-0.470254264023,-2.602323427661 &
            ,-1.248717302306,-0.641607244352,0.182047497057,0.199472191786,0.822743991675,0.306713168971,0.933269307958,-2.015096457966,-0.312613814950,-0.123876975310,-0.663819806506,-0.909657550610 &
            ,1.772010289878,1.619589431369,1.436110941684,0.988123272595,0.796173761688,0.063771735789,0.970930914677,-1.647667462797,0.729413198449,0.000019567773,0.242706399095,0.638193118544 &
            ,0.438150060814,0.065163309849,0.164399274526,-0.686968609023,0.288110138211,0.249703831246,0.167907392180,0.160415744250,0.171686037128,0.035673936042,0.670256981005,-0.226118781711 &
            ,0.236207500106,0.252759528243,0.221110885412,0.375507162324,0.213143594804,0.110348309433,0.190393557740,-0.242424981336,0.543059309752,-0.121744833408,0.174189763244,-0.084752962329 &
            ,0.167254146922,0.084310673804,0.464478281193,-0.501548219912,0.539069916798,0.474168781590,0.246443004103,0.110603441400,0.369999950729,0.158107979890,0.249649842221,-0.512321576400 &
            ,0.624543745625,-0.247741016850,0.068818487285,-0.286637968084,0.096680272956,0.049422603207,0.172842392728,-0.606829878831,0.609960828387,-0.014092476557,0.105994476019,-0.137785319884 &
            ,0.109125265313,0.077572150555,0.200273646944,-0.584034442318,0.398401141449,-0.138061623518,0.122250174794,0.046174748130,0.076913329674,0.094029801757,0.392392414293,-0.393621193349 &
            ,0.114389804078,0.612206937504,0.112538671646,0.737447608244,0.378447322071,0.095326838210,0.091482065724,-0.121259947271,0.089397697058,0.068216227400,-0.004738344120,0.751402335108 &
            ,0.406830537138,-0.040119744022,-0.280864626901,-0.096058511187,-0.089518707607,-0.637027726128,-0.126181179278,0.549834366034,0.045173733734,-0.100333513951,0.166843774670,0.087336991084 &
            ,-0.115136308829,0.216299165322,0.066086784428,0.683030675485,0.228829268369,0.036043087423,-0.066991512102,0.101535237793,-0.147360290630,-0.065310339417,0.068888144124,-0.232232071524 &
            ,-0.208101701691,0.077981714606,-0.005162690711,0.135716932520,-0.268488449863,-0.096710837841,0.059892679070,-0.593882141939,-0.355043243352,0.089114837976,0.399355470439,0.258199745917 &
            ,-0.130818979745,0.008729863034,0.093632939078,-0.262686962309,-0.251831304397,0.099638519006,0.108402360254,0.135895031461,-0.011416930923,-0.062490235132,0.158027475449,-0.079401523756 &
            ,-0.150019083100,0.153393529605,0.182875829952,0.020152055128,-0.094625754524,0.151586254837,0.208839331280,0.040482753795,0.047765874204,0.203052497726,0.239625600735,0.086351151235 &
            ,0.425941124025,0.399564172683,0.647752460142,2.632928367665,0.599161149844,0.573128693309,-0.766636903791,-0.475621821565,-0.044705349993,0.103300263111,0.120492514610,5.278949102365 &
            ,0.055799753239,0.111436101674,-0.358288092386,0.027126017514,-0.046576990544,-0.030105830660,0.016447451440,-0.278350307747,-0.038075919946,0.036141012688,-0.031273762595,0.035125016797 &
            ,0.053655186596,-0.016917891572,0.067853784101,-0.775515241380,-0.024843596632,0.066044326077,-0.231613221207,-0.058876503692,-0.002020019937,-0.064037101152,-0.029333013092,-0.259683573905 &
            ,0.022205536889,-0.001326741547,-0.071599616323,-0.012156322442,0.024416985814,0.075772335899,0.118157050406,4.446468364717,0.050029616541,0.105041184498,-0.094051402172,-0.035455149740 &
            ,-0.019407478011,-0.061204261374,-0.010156260948,1.366315400744,0.007580564922,-0.004491210666,-0.190223410661,0.013020716266,0.012439004664,-0.006312087776,0.070708360269,0.167550533162 &
            ,0.030493115077,0.053403181843,0.067096858829,-0.016324451216,0.053482774440,0.271556064834,0.199011783212,1.576473593353,0.217508865136,0.135003789416,-0.160518072542,-0.059588695364 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/-26.8655,-4.0813 &
            ,24.5619,-1.9294,9.6678,-0.98929 &
            ,19.4218,-12.2491 &
            ,-19.564,10.2726 &
            ,-12.6319,-0.35312 &
            ,12.2946,5.5468 &
            ,-33.3688,0.08851 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/10.0226,7.5302/),(/1,2/))
real, dimension(8) :: bias1 = &
  (/-1.3942,1.4085,3.0782,-4.4315,2.1737,-2.2579,7.1081,-0.43339/)
real, dimension(2) :: bias2 = &
  (/0.85185,3.1598/)
real, dimension(1) :: bias3 = &
  (/0.11636/)
contains
subroutine fnet_ORRSL_initall()
end subroutine fnet_ORRSL_initall
subroutine fnet_ORRSL_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  do i = 1, 126
    inarray2(i) = inarray(127-i)
  end do
  layer1 = MatMul(input,inarray2)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_ORRSL_engine
end module fnet_ORRSL
