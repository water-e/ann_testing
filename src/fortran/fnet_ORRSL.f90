module fnet_ORRSL

! a = 0.00057844
! b = -0.0047462

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/-0.329846201674,0.247745261804,-0.550588728405,0.207927602986,0.947720356291,0.063830888752,-1.105626133368,-0.135223787443,0.338010170799,0.392369091978,-0.459516432277,-1.573464549761 &
            ,2.040873757732,1.645206240227,-1.849727202288,-1.945536887895,-0.310014163051,0.561035818449,-0.139802378500,0.435006618776,0.066506213930,0.166753540634,-1.316858375045,0.750346409602 &
            ,-0.505572833530,-0.074238339372,-0.392587223129,2.512674068733,0.004254182337,-0.523114733230,0.613268746385,-0.767511854533,-0.344276860759,0.172621412874,-0.142093447132,-0.395020477250 &
            ,0.022735682604,0.273679825052,-0.670686694924,0.787057994268,-0.247022788467,0.670328927913,-0.002696855174,0.595962622298,-0.202837780599,0.136784796308,-1.136150419490,0.241706630313 &
            ,-0.086119347228,-0.107911334420,0.009647602351,-0.862968164167,0.227117169332,0.667358440197,0.288322414996,-0.176955519804,-0.530469929680,0.135229404305,-0.075335173518,0.688352770150 &
            ,-0.315663651748,0.517090276262,0.310081944203,0.301706921127,-1.528556108956,-0.258557581620,-1.036237725878,1.570023788097,1.287114661268,0.283809716780,-0.162615326937,0.570347716780 &
            ,-1.192197729722,-0.237633554221,-1.166839772865,0.447860329784,-0.595874550357,-0.239555921972,0.993894850815,-0.366594728502,-0.100852502267,0.093959641139,-0.086431457169,-0.142155569361 &
            ,-0.004104875348,0.245125087359,-0.028937695074,-0.103889450370,-0.006938833610,0.025986482713,-0.016730898177,-0.128861019597,-0.332240811848,-0.129314138740,0.088861594240,0.174317729196 &
            ,-0.163039795091,-0.051561745770,-0.159265668227,-0.039563828281,-0.148238715282,-0.071496275555,0.198946730296,0.037277550854,0.015593472944,-0.160870911184,-0.057587563038,-0.458916524407 &
            ,0.132638337217,-0.022561776735,0.066241008431,0.105114344680,0.279561012311,0.020339059708,0.149403504080,-0.371327626449,-0.251119914529,-0.109578780355,0.031553931612,-0.087577295410 &
            ,-0.076616345738,-0.066422319602,0.146329323178,0.221660343976,-0.003842992352,-0.111262060483,0.126802184755,0.411105186918,-0.037998289708,-0.105763021100,-0.015083417807,-0.101646321638 &
            ,-0.134992734310,-0.071167195706,0.193723580422,0.241269269798,-0.083781742525,0.043345635155,0.060831577795,-0.165604015373,0.032855444164,0.065417120009,-0.054307415981,0.321788861372 &
            ,-2.007939090651,-0.145393684389,-1.941399777932,2.379573557386,1.157229450719,0.751837128379,-0.146683088703,-0.264982562782,0.029799507327,-0.480356994356,0.250125899996,0.796908413189 &
            ,0.118843609758,-0.513151201303,0.987689231247,0.057283467900,0.032889956487,-0.517167823030,-0.122375227528,-0.816651740568,2.170711908058,0.712854004112,-0.320727950841,-0.628303542644 &
            ,-0.194594100717,0.264659885594,0.070544403609,-0.405828102748,-1.178473961681,0.329556440332,0.055725972902,1.182225801686,-0.130496310014,-0.476785608075,-0.211544361838,-0.380453870038 &
            ,-0.200955748309,0.200319806241,0.809367611137,0.399533813282,-0.520427317477,-1.202087752331,-0.593560967852,0.164561007578,1.065284507948,0.371536904784,1.271365340700,0.106303101733 &
            ,-0.594778285644,-0.253434486777,-0.307805011873,2.383041649048,-2.210896830859,-0.554756304869,2.208907219409,-1.040712152269,-0.651329921187,0.456759475680,-0.393139695246,0.941672230109 &
            ,-1.638292977461,0.342385242195,0.318712656402,-0.130915805931,-0.199625006006,0.642180225190,-0.062813219039,0.575496472460,-2.283808464067,0.108726359063,-0.410185551310,0.418584320040 &
            ,-1.080931462095,-0.209630136131,-1.177211009379,1.363932538187,-1.294503835701,-0.279532885127,0.782076823262,0.342427507849,-0.239048208371,-0.030132978780,-0.300569493939,0.058621934137 &
            ,-0.464714363954,0.013320608286,0.435853626360,-0.026767380841,-0.002562678645,-0.130323196595,-0.027549534625,-0.175413245073,0.369607070202,0.053756275944,-0.041358444682,0.098477342666 &
            ,-0.408548620858,0.026351479274,-0.244451350799,0.634058270032,-0.623111620032,-0.009290280978,0.454526261431,0.279246136598,-0.230997234575,0.001885765015,-0.175365271815,0.458746955916 &
            ,-0.213262404870,0.206900657407,0.316909294219,-0.220526429201,0.047270019050,-0.108609509943,0.069160097825,-0.433475130652,0.043699388745,0.065855222313,-0.008388882378,0.437216838425 &
            ,-0.154777450151,-0.065830567315,-0.041679876627,0.426597302014,-0.063034119877,0.074182866944,0.284678764645,-0.230323163868,-0.151363546297,0.107571551894,-0.168760640371,0.562112269386 &
            ,-0.315225645827,0.009763187595,0.159462466355,-0.174671742349,0.228637048314,0.483021457570,0.176787136111,0.476118813035,-0.466576611797,-0.041208369033,-0.430945616202,-0.612690408368 &
            ,0.012352137506,0.446868663556,0.024830396011,0.189030636673,-0.926942930218,0.247496022865,-0.176911862946,0.412690502048,0.679840950875,0.366403533492,0.198391199388,-0.479355609450 &
            ,-1.090424093061,-0.526369838898,-0.249359843342,-0.499058194115,-0.370784053367,0.325215209376,-0.586588804409,-0.354703463626,0.538891657655,0.623559759815,-0.984914449399,0.000085754426 &
            ,0.352641517495,0.560844313222,0.503455665865,0.931220442648,-1.072878774833,-0.262016265370,0.060441945379,-0.167412948667,0.297998778356,0.299263361995,0.006610856805,-0.004788710904 &
            ,1.166118844228,0.257821251042,-0.808753449848,-1.232529958267,0.324102307625,-0.022119740233,0.387289487592,1.194041926344,1.061061471426,-0.409968773138,0.108707823626,-1.336774721365 &
            ,-0.001655461874,-0.035923079669,-0.144232114052,0.723036157120,1.590255074709,0.266491959024,-0.297879623036,-1.294309383317,1.113982172547,-0.006462794202,0.683214719797,0.520817253765 &
            ,-0.186413555419,-0.876852520125,0.508489455868,-1.877732260771,-1.122374361656,-0.770408630741,-1.957046476438,-1.351937313670,2.772377001771,1.291143916071,-0.585630901236,-1.157196549760 &
            ,-1.159262058606,-0.345144270371,-1.101966551935,0.427139440786,-0.256919928826,0.840787611690,0.797175448236,0.257405361030,-0.150603902642,0.017922565507,-0.159427019669,-0.062503824777 &
            ,0.115808558726,0.070513251119,-0.197336205017,0.096431124808,-0.012397491048,-0.094982535230,0.020139451426,-0.076602920884,0.180825947747,0.052939725180,-0.004114680099,0.162032577585 &
            ,-0.229716227076,-0.046061979954,-0.341295390510,-0.126110910094,-0.137259717262,0.126205829217,0.146117088962,-0.136304652296,-0.013655808605,-0.088611315066,-0.109402881864,-0.187507577334 &
            ,0.414927383190,0.096309104421,-0.190060778324,-0.022220471692,-0.195507186460,-0.047875821217,-0.221439805075,0.005286421105,-0.091567823593,0.016151347479,0.110716011778,0.020351848650 &
            ,-0.029653667269,-0.007364814849,-0.107428458968,-0.275947127870,0.232197989579,0.207957926089,-0.188936419368,-0.025005264506,0.097412452162,-0.064702904381,0.098603507191,0.011304936223 &
            ,0.040437573917,-0.207683716198,0.047773573805,-0.020979711277,-0.064526226734,0.032301192185,-0.283866105221,-0.359050808863,0.032922978550,0.264450567969,-0.118716117966,-0.167447470705 &
            ,-0.848515326647,0.230651083834,-1.400401674550,2.885611974723,4.633096831273,-1.701927083783,-4.067803823121,0.810904394933,1.924182591879,1.405454419350,1.730926160897,-1.614570749346 &
            ,-1.737811925866,-0.286570985791,-0.953002293670,-1.624832537619,0.542849472232,1.678494118596,0.730540097541,-1.417096485513,0.475165263657,-0.473778147704,-3.992209953795,1.495669981998 &
            ,-0.075048304462,1.192382754500,0.197984248587,4.432308801670,1.036276323498,0.801554584231,-1.785561175882,-2.982472008846,-0.839894184334,1.792474498642,-3.794598276767,-4.956185366814 &
            ,3.660479900277,3.832761773237,-7.273018277206,1.629444254819,-1.638069030124,-0.346849588613,-1.278051996813,2.069365272449,2.239822425998,0.301249647404,-0.868369692472,-0.519431985483 &
            ,0.528268980014,-0.358057913656,1.244905791712,1.698517791558,2.086349376636,0.451249875998,1.712732286723,-2.221996476004,1.898682707016,-3.234800768120,2.232832065157,-1.944412859561 &
            ,6.069426018309,1.913454688862,8.018341129391,-5.557355262183,-1.681871153840,0.719418782889,-1.554326126867,2.954161141427,8.071956906465,1.930687620620,-2.725818755930,-2.543212948605 &
            ,-0.662388690169,2.013969000639,-1.439036879228,-0.421214298087,7.823046530497,-0.099409570241,-5.861772967041,2.317814900360,-0.403286401883,0.369602333206,0.833496471533,-0.090832164941 &
            ,3.402430128043,1.262710987008,-1.020229280303,0.987242855187,1.687674207175,-0.755692879732,1.836947086526,-0.757157947735,1.681518459907,-1.661579731992,-0.128187018997,0.576564803712 &
            ,2.026098261188,-1.004285274061,3.624056095929,-0.023026375867,1.112757134151,-1.751394109745,0.548027351694,-0.117903127071,3.214963862656,-0.190364916480,1.936093546515,-1.053872820659 &
            ,0.879193845015,-1.873496403791,0.281581017090,0.168126384831,0.643029685813,-0.654028677436,1.872309889851,-2.267633019432,1.193436587278,-0.627502634007,-0.083226423608,2.272505008585 &
            ,0.097808010804,-1.313602956256,1.177008767805,-0.732939216132,1.474502376218,0.880683294964,-0.214994383581,1.823170550625,-0.308723870346,1.628474545752,0.432553980332,-0.335087657462 &
            ,1.102211530810,1.156973784938,-0.369568619331,-0.855802854817,-1.841532825873,0.481884896032,-2.535571945428,0.560388465337,-1.173833679946,2.017913340866,-2.044030394160,0.063865653536 &
            ,-0.220254776208,-1.007385219982,-0.535814614174,-4.189569963429,-3.420841597779,-0.974350507402,3.049469203813,3.540749924726,-0.958831101328,-1.473840181009,-0.738300107241,-1.715343457183 &
            ,9.276445156457,1.669636987806,-4.463669050591,2.659429819550,0.680693229907,-2.572368015688,0.667940805771,-2.134626694045,4.226376824304,-0.348281939987,1.733837569950,1.152924859978 &
            ,-0.286160431226,0.421010389317,-0.158756777090,0.525040964036,-4.772655963750,-1.299964170551,4.181566190212,0.421232552236,-0.876206955106,2.038741169785,0.748390894921,1.545620466200 &
            ,-5.272749588425,-1.169690985142,1.768831418839,4.077813545541,0.627284644262,0.757553557342,0.241435633112,-1.875430849178,-3.919049666418,-0.347343766719,2.825368788543,2.613416713734 &
            ,-0.240933259682,1.696274770841,0.185715969463,0.737172038607,-2.220013483124,-0.708782251957,3.285449202243,2.468261778423,0.023772388197,0.509173018287,-0.601244151793,-0.574441110480 &
            ,0.251254638022,-0.495073295430,8.798176746330,-0.374809260301,0.758372502867,0.415419764545,0.215277937268,-2.462480254740,7.904032750892,-0.299141280931,5.997116149210,2.562317363979 &
            ,-0.708259263890,-0.254497213118,-0.617676692269,0.378045858579,15.034437590376,0.732454836950,1.359289429783,-0.551628272784,-0.044228372795,-0.061894554518,-0.451301646615,-0.385268592040 &
            ,0.796878886765,0.223885229593,-0.022961387227,-0.874987585634,0.676321956646,-0.389473565546,0.339423834510,-1.472541717732,1.293290199019,0.371942244992,0.303058983981,-0.661231083276 &
            ,-0.062941948106,0.018711051460,-0.261819510263,-1.071162078651,0.682450721694,0.812575078502,0.083064362475,-0.431570023312,-0.269999701807,0.203027330060,-0.370953000173,0.135568343954 &
            ,0.765965905579,0.932280447882,-0.264709915957,-0.715823855795,0.036366960507,0.574216512652,-0.019809161426,-0.353529644609,0.860083265505,0.731671902208,-1.303235599958,-0.207589271276 &
            ,0.192038838534,-0.065314217314,0.146053855457,0.153343430229,0.153213143495,0.083384485679,0.316348233845,-0.965544243546,0.088882686885,-0.003978918791,-0.227712966784,0.577582992174 &
            ,0.560868553202,-0.171165564160,-0.069786018203,-0.658479783582,0.319960002932,-0.341259913868,0.808881296200,1.745779000944,-1.593944491263,-2.331304580066,1.274129933735,0.680746585793 &
            ,-0.725569673456,-0.113614710056,-0.799930541809,-0.384113036003,0.544974973597,0.787807945011,-0.091096091877,-0.082660444690,0.680364280596,0.139820918127,0.621339036175,-0.620050944778 &
            ,-0.498439817568,0.007909317626,-0.097130915519,0.162864827817,-0.226507601264,0.248849172141,-0.242671348494,0.785573493770,-0.382234494335,0.231019581822,-0.044452619589,-0.243138997930 &
            ,-0.525616096999,-0.210512136281,-0.523924704281,-0.099453548411,0.323680593491,0.065463698811,0.037284802537,0.103247103008,0.276475431193,0.091490655338,0.520373983517,0.093368044737 &
            ,0.012506802847,0.004639829342,-0.324658658089,0.315449695966,-0.174415031737,-0.149727331064,-0.317870799023,0.215652992759,-0.048992826361,0.216900920492,0.379746445221,-0.698270192866 &
            ,0.130592036744,-0.501634126724,0.212879894389,-0.723564633796,0.096902546404,0.018296151079,0.493199645257,-0.022604258900,-0.581580443009,0.204787676259,-0.434105938548,0.586831078562 &
            ,0.037599127400,0.840708572510,-0.857962781732,-0.072045580142,-0.293271501974,-0.131248132477,-0.611061979637,0.196364834241,-0.631923410088,0.571351416531,-0.191176534166,-0.557367134511 &
            ,-0.768837045320,-0.137579031719,-2.040506394391,-0.769803040066,-0.928890390045,1.430850764712,-0.188911802265,-0.799215313475,-0.401929750722,0.068886662120,-0.596495889986,0.094353542166 &
            ,-0.257949411708,0.395209332101,0.025918061803,0.007687156469,-0.279442969221,0.096903410324,-0.389602189280,0.393173173249,-0.392264763320,0.259235049695,0.126818328321,-0.046164196328 &
            ,-0.263797890247,0.057149912833,-0.336744811495,-0.186107443117,-0.120635059230,0.185041464247,-0.055294407888,-0.043393658870,-0.192500019778,0.040604158760,-0.235116944188,0.280625489120 &
            ,-0.108552496223,0.301647297899,0.000312493079,0.109968920278,-0.286395397391,0.083517670287,-0.418501462817,0.244741737922,-0.323114407603,0.254772889264,0.148313250948,-0.158591144425 &
            ,-0.129214550141,0.103941688777,-0.151810963864,0.222501736660,-0.280941204429,0.355992213846,0.026610214154,0.163561590499,-0.303518534648,0.027733372867,-0.432619974843,0.247281986264 &
            ,-0.155270570435,0.422387419524,0.097158904931,-0.037833953536,-0.056958962043,0.022688276813,-0.164113533213,-0.229574478833,0.200245522458,0.400063851245,-0.124649825752,-0.134425563497 &
            ,0.054061378389,0.077527834310,0.006333925003,-0.019580815049,-0.107787577173,-0.039185471566,-0.107495000279,-0.009865431152,-0.063834698460,-0.009062324820,-0.053542599002,0.011457262759 &
            ,0.077283033281,0.036571489703,-0.036151020854,0.070900895780,-0.015327660244,-0.001917393746,-0.004199792028,0.141531102604,-0.085984782159,-0.099686103251,0.065405017202,-0.007784800113 &
            ,0.013769191510,-0.013159007543,-0.038493334457,-0.114087751854,0.110496597672,0.088460974369,-0.025114403478,-0.149967862245,-0.072676150909,-0.035421990444,-0.001041243113,-0.044036464747 &
            ,-0.027481334123,0.098208766376,0.096156715988,0.190205082222,-0.095681213578,0.030284176137,-0.131424305090,0.127270809604,0.103331366048,0.021126899824,-0.116157731996,-0.026086144432 &
            ,0.017864953048,0.001536641618,0.092706233221,0.107124861832,-0.301004524953,-0.184438008770,0.160056945094,0.196484229806,0.031873666515,-0.027749158691,-0.051044165176,0.060579082219 &
            ,-0.198370135790,-0.097296554522,0.264778141190,-0.246057089864,0.050244800200,-0.070882741951,-0.012302894074,-0.069012407068,0.043353128623,0.009978115484,0.176587264809,-0.181493723666 &
            ,0.036042142286,0.109227382144,0.000802843998,-0.124579891406,0.098316311716,0.179209736519,-0.037914456094,-0.219448937228,-0.011571238432,0.035577394019,0.023293114339,0.039130945465 &
            ,-0.085423812476,0.035052760786,0.049515578687,0.010152996760,0.011447947192,0.000219613554,0.022994373123,-0.013567898125,0.039200025688,0.019034726117,0.003024639455,-0.010860263275 &
            ,0.007907417247,0.035786367056,0.021191928345,0.036941630641,-0.039952585343,0.017212050240,-0.004880499526,-0.007222660407,0.007045847775,0.018477470683,0.011118804502,-0.018590789629 &
            ,-0.012699967049,0.038163937328,0.011708763114,-0.029152338085,-0.006678874330,0.012842978562,0.039004138409,0.005347658056,-0.017975344406,0.026993604189,-0.009216876455,0.103763651934 &
            ,0.027417567806,0.007494649523,0.024452808979,-0.025200106620,0.002910789310,0.013191094664,0.003863933892,-0.035727506983,-0.013321366318,-0.009082048893,-0.013877095074,-0.016749939420 &
            ,0.037330769870,0.007518016051,0.002734472355,-0.006440304546,-0.025253273806,0.029023598027,-0.049228391392,0.016613848064,-0.010870410443,0.062542100666,-0.001540519713,-0.120563939961 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/-25.2393,11.8151 &
            ,-25.3709,-2.7848,10.5486,-8.6071 &
            ,3.8504,5.8794 &
            ,-9.7408,-2.4327 &
            ,6.0238,4.3979 &
            ,-12.563,0.60725 &
            ,-9.9804,4.5263 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/1.9535,-0.79292/),(/1,2/))
real, dimension(8) :: bias1 = &
  (/5.8925,-1.0664,7.8649,-3.7736,-5.002,-5.2182,-3.6353,0.53291/)
real, dimension(2) :: bias2 = &
  (/8.8007,-1.348/)
real, dimension(1) :: bias3 = &
  (/0.90497/)
contains
subroutine fnet_ORRSL_initall()
end subroutine fnet_ORRSL_initall
subroutine fnet_ORRSL_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  do i = 1, 126
    inarray2(i) = inarray(127-i)
  end do
  layer1 = MatMul(input,inarray2)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_ORRSL_engine
end module fnet_ORRSL
