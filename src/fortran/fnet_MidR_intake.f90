module fnet_MidR_intake

! a = 0.00084822
! b = 0.0059421

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/-0.296926701852,0.007942999748,-0.123720694978,-0.203452949278,-0.199943991702,-0.169234124488,0.223378981045,0.053305263539,0.108660616944,0.026537188891,-0.068767478797,0.063023463958 &
            ,0.130171187905,0.275067205612,-0.328114241539,-0.021777286543,-0.107577785135,0.096239306571,0.059709752959,0.030551301381,0.493411381566,0.315827212715,-0.331434453815,-0.035932763855 &
            ,-0.019853752384,0.089620970277,0.083774710029,-0.044681632092,-0.273310221278,-0.069149781263,0.090951938618,-0.039434728157,1.139280742542,-0.259359894997,-0.082387085771,-0.026793521794 &
            ,0.101581132730,-0.449687520077,0.510993273498,0.053074217957,-0.457472232066,0.292232141015,0.165915068918,0.013524341253,-1.077087982551,0.560872908738,-0.595896655717,-0.066549051701 &
            ,-1.499562838857,0.096410879730,0.077625620268,0.019170460698,-0.720115452195,-0.058098986168,0.045598962574,-0.100016393503,-1.949790450526,0.016943326629,-0.235794928899,0.081901119819 &
            ,0.998503309411,-0.217778564004,0.082424628528,-0.122213898372,0.477391049299,0.948074991436,1.054056636115,-0.098414407706,-1.066325555701,1.079175139526,-1.057775104484,0.049435713670 &
            ,0.518170651465,-0.617989044174,-0.660595604582,-0.130067428973,-0.634508469099,-0.681025909371,0.724991855799,0.145067101492,0.073951045770,-0.035527893624,-0.020514295130,-0.033029121033 &
            ,-0.021214908717,-0.163808816908,0.172807214882,-0.002199212683,0.155368026306,-0.069211115194,-0.085391694057,-0.014101708500,-0.028264833630,-0.119886009857,0.126930308108,-0.000051835329 &
            ,-0.454066350680,0.048821635681,0.049913600237,-0.004068653418,-0.166928419118,0.067234289117,-0.071975314045,0.023037090897,-0.009620950910,-0.169675395838,-0.244186398812,0.048569553946 &
            ,0.079158463256,-0.181008646245,0.157841855597,-0.040460579795,-0.388727545087,-0.072590712288,-0.051426575665,-0.046409065588,-0.017609042496,-0.109740909624,0.127931703694,0.044425288328 &
            ,-0.335093583809,-0.164738558312,-0.195906293268,0.026758359171,0.265859778256,-0.067550285376,0.055096242131,0.023728872326,-0.076803923021,0.059415905920,0.058782812109,-0.029016958604 &
            ,0.229854515205,-0.049296797157,0.034160774273,0.043116905985,0.315247573575,-0.015340613660,0.069112182029,0.150441965158,0.465359108544,0.014469491491,-0.068980466399,-0.082715060080 &
            ,6.770012460699,1.450985714278,1.946011234972,0.153895136631,4.044048404943,-0.792645531659,0.639894289522,-0.223387227566,-0.847537777490,-1.628954679874,-1.294515538393,-0.034583369969 &
            ,0.660236408283,-1.411037139520,1.639529565050,0.018306999578,4.154475020106,-0.267618366129,0.371720594877,0.482727449381,-1.448889050811,0.134431611722,-0.128211878114,-0.082769272023 &
            ,2.226539330216,0.285491215838,0.199715260384,-0.246888601769,0.868838161872,0.813802289997,-0.739022761282,0.525204487081,1.138682157655,-0.572382773941,-0.153779342786,0.998230295425 &
            ,-0.533351517293,1.267326855368,-1.399322944460,0.023868467315,1.056023636505,1.613124249135,2.574738529642,0.330282198953,0.130239440138,-0.507366217249,0.224575293500,0.314226995211 &
            ,1.544801645743,-2.202390920675,-1.653225082549,-0.980047290676,2.064667785662,-2.145945340615,2.464261099110,1.823499469579,0.603648059445,-2.408212088378,-3.058935180597,-0.088460693180 &
            ,-3.569323729532,0.169680138100,-0.003339741923,0.773069546937,-1.696533790301,0.727835079307,1.079776835684,-0.391896023156,-3.972387450785,0.653249014520,-0.665424549009,1.505652622673 &
            ,1.559300622678,-1.524154217730,-1.445256505914,-1.083694718198,-1.680515102558,-0.945373882244,1.213051589048,1.382959767509,0.430840880424,-0.449798174173,-0.499335880207,0.077102723667 &
            ,0.482857741329,0.749092158199,-0.717205525092,-0.067418435952,-0.372763549526,0.118969854106,0.273668348930,-0.240451974350,-0.698303062204,0.087944340012,-0.000089098541,0.189667814174 &
            ,0.088321965472,-0.231803751533,-0.435834732225,-0.049991755525,-0.837761095618,0.145485724185,-0.106925044381,-0.021341810426,-0.657210064014,0.146881678864,0.439103979470,-0.276130031484 &
            ,-0.759409969674,-0.129261018407,0.272850894427,0.088759804901,0.265015552556,0.242876368788,0.223333776374,-0.290490804773,-1.130658128122,0.453225834269,-0.353997034908,0.196417942634 &
            ,0.292797732159,-0.128888917820,-0.045713784772,-0.418353409903,-1.284473385562,-0.108744608447,0.265430568462,0.256278702289,-0.735297215357,-0.709806473075,-0.709478999844,-0.219397037414 &
            ,-0.602918261459,-0.318552321249,0.373768673739,0.212341503331,-2.488212381242,-0.890933625031,-1.119145467123,-0.616429122171,-0.424602498593,-0.691218693678,0.814158725866,0.413218459655 &
            ,1.463173963033,-0.526692039680,-0.853919165009,-0.204787285490,-0.637413809253,0.800171779605,-0.771736997021,0.230767764338,1.262628703497,-1.599226146425,-1.394008847290,-0.203941922812 &
            ,-0.383717730723,-1.369569111481,1.487136558903,0.139670221174,1.787824039033,-0.477946127125,0.147592044169,-0.511654477543,-1.436953981202,-1.171074052799,1.328646952274,0.267400696622 &
            ,2.080764383806,-0.888574042472,-0.970943485940,-0.125805999387,1.164436101071,-1.731558416951,1.699019447829,-0.173744103723,1.407085266441,-0.174899987909,-0.075640666928,0.172505562440 &
            ,0.420616214015,-0.848318951845,0.867888295957,-0.638530915668,1.753696819541,1.011956354438,0.537452615759,0.319676520733,1.481340510711,-0.374164155204,0.233424834672,-0.730431529623 &
            ,4.656195196047,1.997704762271,1.494585992733,0.183055509320,1.683620432610,2.031525845700,-2.055336086625,-0.455546378145,4.013722155365,0.781024121348,-0.039561254699,0.435668324775 &
            ,2.483038414636,2.128871155352,-2.067388643672,-0.548586187665,8.321065851907,3.661887409005,5.062518333645,-0.645952534053,1.593522213818,1.121295606370,-0.822224282580,0.747265703047 &
            ,8.336145607643,3.339476756019,4.367722697497,-0.902825994904,2.103174470934,0.240730150762,-0.129331551491,1.233003895683,0.733713199000,0.362072390530,0.614522451104,-0.036702629700 &
            ,0.063366017892,-0.390848447162,0.355593998530,0.128971080881,0.587731460267,0.346935785880,0.481924353765,-0.129890361376,0.060473973290,0.200028204141,-0.147709746076,0.113966397976 &
            ,0.793088214278,0.058586118733,0.183471993873,-0.118042410301,0.138291245256,-0.440445323036,0.448704577495,0.213532166136,0.333346160436,0.104713164865,0.223998191016,-0.091564495050 &
            ,0.284837742683,-0.199642260039,0.218299491695,0.081258221441,0.910210849583,0.395317070675,0.607441192882,-0.079222100828,-0.295487135385,-0.215317152968,0.228155247011,0.123331221945 &
            ,0.140205506822,0.003238165772,0.086998512235,-0.052400237836,-0.065708954343,0.275415899204,-0.238143073195,0.124590735503,-0.111175973948,0.298968486773,0.403723075638,-0.011416615451 &
            ,-0.200700696024,-0.048794552474,0.033482562626,-0.013446981742,0.784235768842,-0.060993929443,-0.044712280734,-0.062613353189,0.541917697788,-0.121379050260,0.144677013921,0.076509328677 &
            ,13.704380270703,-0.989069160811,-3.038210854431,-0.477084539900,6.391254123126,-0.384038671829,-0.368560778485,1.263656752575,1.647131007081,2.504330810255,3.748985131619,0.416606551251 &
            ,1.627813462528,-0.213845089028,-0.101134522617,-2.557430455282,-1.313436327829,-0.367561061852,4.520761077543,2.809627157106,-4.506965226321,2.644880260195,-1.888913597737,-1.736665492778 &
            ,-3.204831381116,1.868285318293,0.235391138841,-1.796434778626,5.144482467826,0.648911730062,0.130075663275,-1.605372412314,-0.696517946764,-2.273755264169,-3.963756652947,-0.745662622444 &
            ,0.922917243652,-4.023711158072,4.002110522295,0.066867528702,2.000501057491,0.670987126128,2.651259255817,1.545791347014,1.853203511213,-1.471478394417,0.009745053073,-1.072370092911 &
            ,4.124478375697,2.651853179891,0.002861570977,-1.164615143847,5.543902319195,2.108978626359,-2.485357544666,-4.526563683498,-5.347854137305,-0.354126356530,2.057157769331,-0.398631872975 &
            ,1.258155896767,2.441724899248,0.191330367473,-11.819990235812,-2.822423481257,-3.918612453314,-0.852797888781,0.905440480032,-0.791262011296,6.301908935390,-2.361879317792,-10.729397605738 &
            ,-7.667332023654,-2.623102316771,-3.177424706760,-1.097019522748,-4.775663399718,14.356619429939,-8.409316604055,-4.642777958446,0.868789184933,-1.483056375962,-0.125711603190,2.269500933170 &
            ,-2.123731911733,5.002506883675,-4.382077677264,-0.564027843195,0.925615991648,-0.564771682315,-1.016003367015,-0.084658283102,-0.428671031893,1.928726882931,-1.286662200455,-1.969434473282 &
            ,-2.888468516576,-0.948357581022,-1.318008153722,0.295255377987,0.794396025627,1.939895947475,-0.970673600413,-1.588712197875,-2.330147116278,-0.907187648711,0.112981992101,-0.439057277783 &
            ,1.834075599971,3.017837929933,-1.709319086748,-1.118196602925,0.696107793752,-0.210769935849,-0.476048166455,-1.838631926584,3.073908164336,3.544466996097,-1.411811552448,0.120693425726 &
            ,-0.419952858595,-1.544374021875,-0.471840641827,-0.260227113397,4.542104941743,0.851673410082,-0.138230267656,-0.591648998637,1.155439536455,-0.679071695291,2.305995592488,3.794996776224 &
            ,4.610034823431,-1.478605138655,1.354861128222,-2.657851856840,4.368379966476,-0.540996903880,1.381998868585,0.865709994677,2.581781477705,-1.436382674390,0.168270726233,0.664798049118 &
            ,-1.265645962195,1.654118104432,0.244885110922,-1.105530086134,-6.208717838870,-3.579913927289,2.961310020082,-0.313060957568,-1.509865803914,-0.626157965591,-2.854082766769,-1.136638883637 &
            ,-0.117372156013,-0.018702056122,0.071368101893,-1.503934928916,3.815740377759,0.555969541664,-0.784745764213,-0.573011101438,0.240812374383,0.432147440801,-0.381661087319,-1.828903837079 &
            ,2.187069470036,-0.474778251858,-0.728877280779,0.297639486046,-0.148132712655,-0.301916382517,-0.056005177319,-2.146673981037,0.415255321769,-1.188251895505,-0.555949392237,1.063904246131 &
            ,-1.739009668238,3.272971164258,-2.970020353767,-5.596476690628,2.193013850055,1.046877045555,0.374598898042,-0.454564739999,1.410084543371,-1.636495731381,1.512381526799,-12.906764854583 &
            ,1.185452773729,-0.835161149645,-0.600749880180,-0.531324911680,-0.836009899234,-2.040696865231,1.720505954286,-12.521951015111,0.054187195490,0.514452010287,-2.628062324919,-0.417969188146 &
            ,-2.386644849382,4.853233983992,-4.492111691343,-26.458678073844,-0.894788578707,2.204551912555,1.743825044533,0.125378439334,2.398280662437,2.182715303095,-2.938057549221,-15.720272402776 &
            ,2.736291964094,-0.778556098689,0.824395686548,-0.462188713604,9.279334592495,-2.784463789116,2.454009636274,-6.188545180469,0.558672607857,-0.071168480086,-0.178686992713,0.064946613875 &
            ,0.262413423925,0.601785646864,-0.268125346903,-1.101259768915,-0.223717506940,0.042133569287,0.186479842255,-0.133380718579,-0.356916671286,-0.461205627968,0.286957881963,0.089259824740 &
            ,0.163451455175,0.161280807456,0.590024209487,0.079345641537,-2.110558317495,0.159102221138,-0.123398127877,-0.046402915407,-0.423749831123,-0.137254684671,0.663288293774,0.040893024685 &
            ,-3.500606267540,0.507665736828,-0.034217668967,-0.437518470307,0.811321205442,-0.126704186177,-0.340545612651,0.299153812468,-4.659820824305,-0.110597314996,-0.150192126853,0.076844540685 &
            ,-1.570047803014,-0.863034853535,-0.002916381405,0.394826666753,-5.745830121805,-0.179056244646,0.252293608608,-0.394367469363,-1.332056186163,-0.467910261561,-1.006270043203,-0.072584492605 &
            ,-3.675221436220,0.670958043119,-0.567060311434,-0.258269440196,-3.141028127322,-0.950181207225,-2.172300316717,-0.581552247407,-6.782414704799,-0.002922902087,0.383528410339,-0.002475229312 &
            ,6.183289714421,1.152002786609,1.383273224723,0.404878578422,-0.667717413964,0.635783874943,-0.780583009768,-0.232494444672,-1.074970007980,-2.405737385711,-2.721088676091,0.002569055721 &
            ,0.139916843440,0.425653648624,-0.131382385424,-0.016760650913,-1.920257664809,0.049860268791,0.232231835687,-0.259333451494,-0.371798243709,0.086666668701,-0.012809709812,0.321934154352 &
            ,3.926185185535,0.854691365847,1.037690630662,0.021752218980,-0.270724864010,0.605243164341,-0.649992170950,0.179504516303,-2.247305303421,0.652224440707,0.444373015227,0.494821973296 &
            ,-0.105803536620,0.988353246270,-1.318420123392,0.139072900805,0.235691380464,1.009647801252,1.319514286905,-0.306289257912,0.342437968120,1.395226429545,-1.162287852273,0.836996792100 &
            ,3.771238795075,0.396224556673,0.740288117372,0.035078758270,1.629670519371,0.166618940125,-0.168767229119,0.889492313425,2.375351598837,0.550085013193,0.880374875396,-0.039531898216 &
            ,-0.641542596149,1.110764310723,-1.158771866184,2.146414056150,-1.165619790029,0.268153746341,0.563058552957,-0.698971580154,-4.119796496286,-0.564291912448,0.726144748455,2.223804492234 &
            ,-1.043841972778,0.440562025007,0.626916105031,-0.681906489055,-7.947837283462,-1.485826119326,1.361224502525,1.547560719377,-0.311565807058,-0.180827887453,-0.193730324036,-0.013807502501 &
            ,0.449534227877,0.078998992529,-0.111128234836,0.092536040866,-0.576586136406,0.215436659062,0.302240525202,-0.161027072051,-0.776785652576,0.062715283095,-0.026004307334,0.131415963022 &
            ,0.569441398806,-0.161764815307,-0.185514829752,0.120188304165,0.545069384346,-0.230254601276,0.138033131989,-0.024837849842,-0.989679502847,0.229150849379,0.435395477188,-0.178566333327 &
            ,-1.249681054268,0.072239295884,-0.010471217371,0.102244092413,-0.585308411468,0.741612764777,0.860889280633,-0.181449327740,-0.817748792340,0.102590743938,-0.164206941957,0.156033912443 &
            ,-1.664824691914,-0.084824054934,-0.171631818872,-0.469022148154,-1.218182673842,0.385280357033,-0.238021571331,0.376475460866,-0.785342733120,0.012457339704,-0.115340361010,-0.491929839716 &
            ,-1.620681813468,-0.298371966056,0.366625545357,0.427881703168,-3.168559965370,-0.600985681648,-1.120368016904,-0.761251580328,0.065100020052,-0.955352325180,1.025466244855,0.602008059363 &
            ,-1.027910776288,0.140156741755,0.106279988596,-0.085933455938,-0.553993597383,0.301757686164,-0.270642277692,0.058725791803,-0.230619515667,0.053258543448,0.070262257098,-0.045751549084 &
            ,-0.334334658210,-0.467345390851,0.462545191452,-0.048808583471,0.036847192146,0.044718127198,-0.151606694376,-0.058068297488,-0.266788179101,-0.075444527976,0.074203765342,-0.003830974436 &
            ,-1.108807262978,-0.269273072870,-0.471565365863,-0.061985657578,-0.316860553178,-0.295246064195,0.305730049740,0.011179055093,-0.509725776452,-0.394123127387,-0.400132243331,-0.041871580644 &
            ,-0.367389052842,-0.368935988579,0.393152524671,0.014505583710,-0.726825261264,-0.344691956147,-0.280090979218,0.014751924287,-0.294977926126,-0.083309657799,0.098172124023,0.003159007187 &
            ,-0.698868708024,-0.164669894194,-0.330579255963,0.030141186634,-0.059474525493,0.068071114056,-0.068017213745,-0.130693358180,-1.278962721496,-0.345377652188,-0.439594616007,0.015408828110 &
            ,0.191247766468,0.227429461165,-0.250933796608,-0.075295717362,0.423494516084,-0.739748673656,-0.845293913923,-0.258079785290,0.740445289666,-0.437671722071,0.548017307008,-0.096962116378 &
            ,2.220308387671,0.117937381789,-0.147926024466,-0.179318553607,1.405140765711,0.001643903058,-0.019304110233,-0.321338591479,2.493856165855,-0.174946936508,-0.340316890632,0.032035067389 &
            ,-0.016466208127,0.013572593782,-0.054292529019,-0.037850628869,0.396345138843,-0.077727558600,-0.105077668630,0.032476284006,0.110226988489,0.031299203449,-0.036114291256,-0.043893517082 &
            ,0.063760887235,-0.073174501928,-0.091655208086,-0.009586147611,0.168513835871,0.066674569485,-0.060134294175,-0.000926613444,-0.023338948603,0.043409486219,-0.014758278939,0.000487750775 &
            ,-0.096796226090,0.049609426807,-0.062013786808,-0.023388204485,-0.339770486139,-0.113211280492,-0.139184704480,-0.018568846821,0.223865320290,-0.047173055709,0.063946045175,-0.014800942863 &
            ,-0.575754130960,0.010034166213,0.013977748644,-0.044108891235,-0.074553425095,-0.077256787382,0.092584898065,0.015261397277,0.268607988862,-0.019393935110,0.055443640822,0.091084219076 &
            ,0.095560164459,0.066053980743,-0.072462247568,-0.024382045968,0.463036063459,0.068409539396,0.092312584515,0.036069857750,-0.050619247377,0.085293043617,-0.088208548974,-0.030915760722 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/-3.3131,-1.8505 &
            ,4.6624,-2.0707,-3.4275,1.4259 &
            ,6.0018,-1.0163 &
            ,1.4011,3.4158 &
            ,7.0252,-6.2821 &
            ,7.5225,-7.0425 &
            ,5.264,0.87191 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/3.8913,-0.29157/),(/1,2/))
real, dimension(8) :: bias1 = &
  (/-20.0263,2.7383,-0.59663,5.1237,5.0087,-3.2384,0.062427,5.3282/)
real, dimension(2) :: bias2 = &
  (/-12.7412,8.2683/)
real, dimension(1) :: bias3 = &
  (/0.2669/)
contains
subroutine fnet_MidR_intake_initall()
end subroutine fnet_MidR_intake_initall
subroutine fnet_MidR_intake_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  do i = 1, 126
    inarray2(i) = inarray(127-i)
  end do
  layer1 = MatMul(input,inarray2)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_MidR_intake_engine
end module fnet_MidR_intake
