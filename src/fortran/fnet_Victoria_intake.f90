module fnet_Victoria_intake

! a = 0.00083096
! b = 0.017867

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/-0.652420423671,0.347500736174,-0.659265546094,0.159128669447,-0.054000380903,-0.569310932094,-0.574575201060,-0.084547124202,0.870154015926,-0.656330978572,1.021212717948,-0.121744333816 &
            ,0.217937046774,0.976085701117,0.958840039181,0.140160525051,0.419587795040,-0.105943729833,0.682502796634,0.015371902497,0.225326569206,0.090750529362,0.655067764536,0.036127344663 &
            ,0.139384730264,-0.223077817584,0.294916733326,0.026352650105,0.293685841067,0.245364177266,0.324441479872,0.003338428493,-0.192794022322,-0.288016578597,0.550922443565,0.030250280914 &
            ,-0.638341447928,0.335715818353,0.499874898838,0.022762130678,-0.859619534271,0.577411380332,1.718792222914,-0.072864139754,-0.226426209675,-0.752495971119,1.662651779421,0.027825642075 &
            ,0.750739200743,-0.283426475414,-0.757780194788,0.032408187289,0.334974893457,0.401132001985,-0.699233066754,0.041494024850,1.208071831709,-0.260948008647,-0.589533792873,-0.011936570921 &
            ,-1.939407993471,0.441732417945,-0.645504639791,0.065324352333,-0.952648377503,0.655824461787,-0.094028923324,-0.077889689220,3.695394689421,-0.766975953941,-0.512923302509,0.004718340931 &
            ,0.225877482633,-0.281861791170,0.170511635587,0.136585102153,-0.386069834055,0.324200940759,0.270209249087,-0.067335694309,-0.335296054868,0.101901711769,0.076524772419,0.002281122041 &
            ,-6.358623448319,-0.166923933303,0.129432161380,-0.004854708858,-0.196560020332,0.195121325484,0.156793503633,-0.026667557036,-0.942209183738,-0.229191652813,0.163254213021,-0.001962486810 &
            ,-0.042007272138,0.152395152728,-0.531381901617,-0.008481400505,-0.612317251084,-0.167292923379,-0.464403154680,-0.004516233272,-0.226960991591,0.093969087538,-0.078585529651,-0.015053432411 &
            ,0.005591817439,-0.135194283946,-0.070902160712,0.007634122866,-0.647951906911,0.098938719674,0.112436524230,-0.024067680360,0.949100632908,-0.153916538842,0.116531393299,0.019357114427 &
            ,0.295792841179,-0.093534493398,-0.680159838989,0.071473584127,-0.416854602201,0.077048610782,-0.622477291532,-0.014311339764,-0.269308569696,0.294918537552,0.066026578818,0.022397346650 &
            ,0.259807953575,-0.387858731626,0.065752873847,-0.031337659558,0.154226166856,0.363001680168,-0.037708890249,-0.099684240368,-0.537184114578,-0.314869974153,-0.043742670396,0.026499117683 &
            ,2.492106596602,-1.314490922442,-1.216279564451,-0.196465130397,2.165460995359,2.095322244329,-1.391663258779,-0.111746436426,-1.547144887653,0.179372611596,-4.208282281286,0.013896397202 &
            ,-1.893769588292,-0.150033240747,-3.683707258453,0.521596465398,5.915381322976,-1.546039258646,0.361402279114,0.385250507304,-1.206823862863,1.584252221959,0.209712494773,-0.071401695095 &
            ,2.092682420237,-0.254267559908,-2.658545109080,-0.260334670287,0.778346958648,0.700616386318,-2.830891293815,-0.147532072035,2.201651061782,-0.494275832428,-8.452330777888,0.316701404681 &
            ,-1.437085236898,0.031111612798,-8.783054788178,-0.642517640750,2.444625589036,-0.341789985574,-0.956274150566,0.176968838711,-0.505106922191,0.967044390078,-0.961638019776,-0.636925612680 &
            ,2.715574300992,0.074281146432,2.500358034446,0.246944880437,2.681532229394,0.349952752483,2.086124310232,-1.124108702878,3.002578190253,-0.473327180873,-5.687277118778,0.681839382079 &
            ,-2.261550727117,0.701029417643,-5.595941798957,-1.065589614608,6.172726550927,-1.674298434143,-2.364364421278,0.663160982821,-0.403894004194,2.475841265879,-2.435857069541,-1.149202992181 &
            ,-1.153053514212,4.851523615983,5.859893050378,0.626255093377,0.264359432126,-5.710789965818,5.291788094928,-1.476974782582,0.849909969746,-0.516623272188,0.322755461036,0.337617063288 &
            ,2.291783559026,0.593259319418,0.222055327396,-0.060071203745,0.252330143913,0.184078824661,-0.975742357556,0.281831865911,1.367818186943,-0.271846118586,-0.992959537508,-0.146923335793 &
            ,-0.724064356481,0.788529814692,1.259660945905,0.108579947152,0.329108202740,-0.993298002953,1.272960614526,-0.103216395729,-0.433009613645,0.052257135272,-0.116031002772,0.382526675614 &
            ,0.683150912636,-0.410294409571,-0.191462466149,-0.014882844739,0.654461093915,0.021033973465,-0.739301478173,0.316332516779,-1.286011535079,-0.155589929961,-0.635186537326,0.019436699903 &
            ,0.614305043456,0.059182477019,-1.967141023858,0.404692762827,-1.880917108883,-0.152809441996,-1.642563859903,-0.153960886394,-2.119204328611,0.505915472766,-0.063133757260,0.270163647315 &
            ,1.024128744278,-0.610776775704,-0.126197030004,-0.181171690244,-0.045734058302,-0.314857527558,-1.752605275512,0.464702766244,0.016627025005,0.513782614090,-1.483361049013,-0.100372048226 &
            ,5.559485204478,-2.076979754161,-3.451475189880,0.490880769499,0.827390236513,2.673747880843,-3.420527466429,-0.010748991761,1.083966528310,-2.299391658308,-0.849685551999,0.514799739823 &
            ,1.893274979386,2.541009753095,-0.717197438700,0.562225593755,2.691540844480,-1.627286734360,-6.725358547813,0.689851489740,4.862508838607,1.745703601702,-6.738198795762,0.362939497707 &
            ,-3.082006742067,2.489304060137,-3.143841286522,-0.144604972441,1.453074722724,-2.674914023680,-2.584121755640,0.620429501409,-6.117510256264,5.117019917068,-3.905109687267,-0.590011109600 &
            ,2.472808481079,-6.079712648576,-3.795898873031,0.501876012891,-11.151904216055,8.284025345700,1.626549893653,-1.291989690553,-2.736744069284,-9.697257653567,2.114852174191,0.125397526149 &
            ,-7.471301506387,5.704186183930,0.357200056721,-1.041840172528,-4.751750326166,-6.786562210460,0.542833932076,-0.236037339936,-8.516304016532,3.731900688620,7.698077923127,-0.867109730330 &
            ,-6.361901419430,-4.623814877027,8.025993171770,-0.168411911636,-5.509538806218,-3.905517170081,2.114265773166,0.670762073714,-4.749632109491,3.318282794962,1.941478706008,-0.224594768783 &
            ,-3.300745531750,-4.830667091630,1.316815599438,0.734281128772,-6.724538933039,5.151024617116,1.656996631152,-0.147531563418,-0.305663879547,0.149759629337,0.176716273516,-0.036426359559 &
            ,-0.788134761967,-0.180744015576,0.135041728496,-0.075876864696,-0.486454704467,-0.671245213830,-0.811226609790,0.055808048050,0.196813382173,0.727844605593,-0.830240541791,0.064575074137 &
            ,-0.728658826758,-0.445470437941,0.036892176362,0.173673761655,-0.355435618335,0.332278122039,0.114968621079,-0.002155984412,-0.334858792178,-0.578768883261,0.432631022017,0.046819831215 &
            ,0.027069296870,0.639577661073,0.377020088159,0.021690316135,-0.254463895928,-0.548887968677,-0.360570614484,0.108592358840,-0.185037050965,0.510092643977,-0.409238385085,-0.052129816221 &
            ,0.113525418602,-0.488148029753,-0.018756042434,0.184711652565,0.029237902055,0.506205590640,0.005682052160,0.011998202076,0.402808220677,0.044409079547,0.059505526163,-0.205627780908 &
            ,-0.651727954210,0.025704762192,-0.011066213988,0.048859848818,-1.027046366215,-0.290176566706,0.567052643913,0.105960352464,-0.008170884497,0.221194568609,0.534466219294,0.025344511691 &
            ,-4.531927623653,-1.135789120600,-19.300936249621,-0.210128915567,2.318755024556,1.589087446192,-17.170985969747,-0.185540474126,2.596916874001,0.074865713444,6.002526058892,0.045520650647 &
            ,10.577426901433,0.630245792845,4.805930934867,1.877688398005,-1.856053153793,-7.742666152265,1.956548603451,-0.428572970434,-8.474117246758,8.206869812209,3.593399419959,3.201089784893 &
            ,1.839097297287,-0.862825091249,-4.786131278477,0.174705084498,-1.461442028505,0.445090064146,-3.750936647741,2.670363842694,-1.203758343310,-0.350766092152,1.072411531331,-1.945934716602 &
            ,-9.168686517173,-0.159381778284,-3.486976517075,-0.068331179149,15.645502377920,0.747401701809,1.128406281812,0.580094537661,4.396511351890,1.812506479784,-0.487085618093,2.925357930647 &
            ,-8.302793796069,-3.525948932526,-6.083569282598,-0.243281505598,0.628925469557,3.292365123536,-4.006213202669,6.076016604029,-6.426498485989,-2.791410461913,6.103714410923,1.696064551781 &
            ,-10.974760868301,-0.178279187269,8.838240290722,13.505119965895,2.907330822733,-5.778707896105,-0.512553748914,2.183954269832,-0.899416252571,3.148409572923,2.146206838931,6.872702574879 &
            ,-0.037916986623,-17.849507552628,9.535217849818,0.677458153090,6.002094005756,10.180001176985,6.201692821889,7.081301938753,1.354930153399,-3.181331453516,4.841223347213,-0.694046241408 &
            ,-4.618442994832,1.000139348279,2.569315309085,-1.863367836750,-4.222843174305,1.623022480465,2.294282504576,-0.915692642666,-6.685498984060,2.135423590685,4.644871894768,1.429161849490 &
            ,-3.526256428486,-0.888399201524,3.903984913274,0.617296084826,-5.279247252966,-1.381289405971,4.731350560726,-0.995031829406,-0.052190888263,-2.872593286512,2.461065731642,0.881123442125 &
            ,-7.091908965847,-1.986377062971,2.616479170930,2.773517104980,-1.934891416691,-3.041956418310,-1.402356270797,3.193781416029,-9.280263374803,3.487461256297,1.558474455215,1.102346872561 &
            ,-4.105977141595,-4.926350440934,-0.256027918944,-2.036776382143,-8.024717933348,3.437949415586,0.353233855643,-4.626503811738,-2.618659914165,0.491612090552,0.441157580354,-1.852009322244 &
            ,-3.442359777038,-0.359395180579,0.735342722292,5.066501073574,-7.006427291948,6.818114949820,-4.016086018187,-1.175403318250,-7.380816486811,-5.196612878879,-2.468683726901,0.130027506175 &
            ,2.436471329145,-1.604980511919,3.452113502135,-0.437081274012,-0.117609425227,2.104179557716,2.287932702717,2.402666395445,-6.489678458227,1.096112264826,-11.176268239105,0.013946795145 &
            ,-2.059430251049,-0.009099090753,-8.478973401031,1.883796307021,1.865963024695,-0.423695266163,-3.172533006696,0.360605466893,4.259726168737,-0.957324989981,-4.058458823983,1.557484673949 &
            ,2.343944815803,-7.543996309640,-0.148735407252,-0.350613374186,-0.605077490448,9.569760269351,-0.004668325776,4.679473451614,1.666516654393,-1.524281673898,5.350474409020,0.621730664610 &
            ,4.990555720406,0.992408105863,5.561818839851,9.164619044535,-4.546834992550,1.958139476025,-3.146409637910,0.153825980746,-1.429357164624,-2.755359312580,-2.579302385802,14.107710835015 &
            ,4.818748375124,2.775357600349,1.788399270966,-0.067393364864,-0.463605319629,-1.707754584046,1.261517852158,16.889347276094,-1.029234226256,-0.603624534718,-9.039524656995,-0.025746430627 &
            ,12.207323978602,-0.083207426930,-10.078276213148,32.851976325246,0.688511471529,-0.104279637086,3.051212740293,-0.009839993775,-0.737528842898,1.148155087599,2.776283622432,17.807692446857 &
            ,-0.681067117254,4.488636532623,5.903126880950,0.225364006696,1.706911033668,-3.771130901918,7.266651488406,5.813707170361,-0.008121562257,-0.887413648734,0.528280101551,0.184031166862 &
            ,-0.211532836494,0.669388982571,0.385084536601,1.240324763097,2.547269939893,-1.754709346949,-1.225974288590,0.272978343421,-2.622435189705,1.329841582931,-0.998853308767,0.898145230278 &
            ,2.299380005274,-0.536392671596,0.883804313214,0.025807339022,2.026635864390,0.771965288185,0.550473589838,0.166458863249,1.368153460923,-1.040032815462,-0.760038227261,0.086100248699 &
            ,4.135672892277,1.090891929464,-1.497409521486,0.262208688413,2.939948345185,-1.406943288646,-1.658597073843,0.087945113078,0.167709540718,1.597753009270,-0.905148050782,0.165290696780 &
            ,0.264438099787,0.003939210622,-0.977814169502,-0.064378728295,0.116287418505,0.302157561159,-0.825355688149,0.049843898762,-2.895914938610,1.372200351274,1.706164676193,-0.502239378500 &
            ,-6.444664109361,-1.364802270931,1.039391522951,0.147577879992,2.078085489389,-2.697688099105,-1.858495550297,0.699007811158,-1.606905090986,2.489133274542,-1.828695293607,-0.453911072485 &
            ,-0.109270407033,-1.268984304137,-1.123719061137,0.397257630718,2.356641748156,1.366670186202,-1.109016563410,-0.129804317846,2.811093810953,-0.573655173142,-3.870778339455,0.118292415860 &
            ,1.349306256456,0.662255438636,-3.776908215599,-0.034892937224,-1.479882231663,-0.446805799898,0.841661131121,0.239306235164,-1.497938730424,0.358511807253,0.764462304509,-0.047035370843 &
            ,-0.284220840791,0.831866151834,1.084852608190,-0.119828928090,2.207274871466,-0.784923392885,0.812351539295,-0.434779632224,3.217557875595,-1.660126108370,-0.859427759836,-0.042165779466 &
            ,-0.321018324902,2.144621046334,-0.938103683389,-0.499347633248,2.245141555425,-0.536173179393,-0.913849108707,0.502562504422,-2.294244219837,0.506429699431,-0.551264200052,-1.130347085016 &
            ,-0.370916834411,-1.898291091862,1.399605994721,0.097114959209,0.537794070189,2.235632186101,1.456730537365,-1.092480611437,11.940154875783,-4.765173518394,-1.757247574855,0.649779019061 &
            ,-0.197720618737,6.766574645444,-1.734743251286,-2.673842204382,3.646212930979,0.156187712854,-3.398129753146,0.454684853988,-2.061359477277,-0.380044606904,-3.913508149151,-2.033232679064 &
            ,-0.379263301187,0.814322154683,-2.413986058723,0.792320206177,1.741029246849,-1.235944879745,-3.360195099721,-1.366452672048,0.437145556207,-0.301177284042,-0.376610367689,0.191959873715 &
            ,1.646177964390,0.481338555633,-0.492599119308,-0.148639222647,-1.465692524118,0.816444197723,-1.729985321794,0.174074725185,1.933319050831,-0.936715893634,-1.714654879731,-0.166712436136 &
            ,-0.707010674456,1.050676059285,-1.934026377676,0.035937245417,0.074243329471,-1.136296923395,-1.739819332721,-0.096851761975,-0.387792279507,0.260109665459,0.564149070786,0.052988953771 &
            ,1.207423528455,-0.299146877224,0.486297423744,-0.033220088970,-0.511989273017,0.284690172721,-1.006133919941,0.130140824968,2.319320640993,-0.309913287208,-1.029482032404,-0.115997864988 &
            ,1.602843620791,-0.073420032151,-0.113013336413,0.194371605594,-1.323860595954,0.253598246855,-0.046008242177,-0.140290493381,-0.049467382228,-0.878503071221,-1.013507118720,0.243442619216 &
            ,3.801272541835,1.104409862994,-1.039993287893,-0.087395476165,-1.841429520171,0.417023543013,-0.319332561650,0.269023644395,1.791814178557,-0.409545793001,-0.062325384791,-0.211750742889 &
            ,0.039156731277,0.137257084422,-0.312884076484,-0.058123425124,4.687325833910,-0.063385417654,-0.281685660513,0.028305457109,-1.927043037404,0.936473943055,0.557127451009,-0.142355111118 &
            ,6.899860939767,-1.159735943382,0.456997244447,0.048957987834,-1.455395227991,0.823124172847,0.272967128567,-0.030176665071,2.783455588540,-1.028890256153,0.349089888511,-0.021087810936 &
            ,-2.654284146125,1.282130189806,0.072650514189,-0.097971209912,1.583678939214,-1.759087517688,0.069056088598,0.059916508109,-1.728190553062,1.138376401596,0.293650945264,0.015182892668 &
            ,-0.766810091168,-1.500335663838,0.288267899270,-0.062030145942,-0.089636719469,0.753175913351,-0.158357824573,-0.031825465465,1.220083336091,-0.909505295030,-0.167281804877,0.000278279647 &
            ,0.683998466695,0.237997245336,0.356436629418,-0.022132436147,-0.785907539264,-0.246832184359,0.336891184049,0.096942041942,-0.048740433605,0.524647071970,-0.716597137675,0.171904331712 &
            ,1.661965251736,-0.617656916195,-0.602408414390,0.067843622621,-0.495439284315,-0.507326381208,1.237072638313,0.083336014907,-0.167303126763,0.503052161027,1.217091721250,0.353665187343 &
            ,0.704376320657,-1.485326106183,1.057600510200,-0.038439826406,0.282343787463,1.816216445380,1.187231820686,0.751353712922,0.098645522331,0.134185318799,-0.515948611565,-0.097270444246 &
            ,-0.010180497103,-0.069723668944,-0.465643894626,0.083219246131,-0.076389487093,-0.051751133023,-0.016991220391,-0.035935413934,0.029035368571,0.073294265673,0.003967464805,0.058340969802 &
            ,0.338927514717,-0.247678863313,-0.308453257000,0.021775367579,0.215533661633,0.353551010872,-0.296190991183,0.013350933926,-0.255331759186,0.044038081377,-0.158647392747,-0.008851407490 &
            ,-0.043468797780,-0.088103215762,-0.135203493142,0.018662094543,0.146471637679,-0.117098859891,0.041527394832,0.009134844733,0.061051578648,0.141900425295,0.036913430048,0.002265508565 &
            ,-0.184929019419,-0.065924141915,0.061033853079,0.025615122907,-0.023454786480,0.011406987673,0.065053803511,0.007469841063,0.067653608673,-0.114581564823,-0.120544270464,0.018461285039 &
            ,-0.107289452782,0.131930692690,-0.129902162692,-0.025567797317,0.230772108956,0.072099133128,-0.250619987308,0.017777906907,-0.428058565833,-0.147580669374,-0.240681992167,-0.013175780090 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/3.5119,-0.071257 &
            ,-19.1371,-1.167,-2.0232,-4.5453 &
            ,-3.4726,-2.1284 &
            ,-0.73898,6.8149 &
            ,-10.4599,-1.063 &
            ,1.1747,4.9925 &
            ,-2.3588,-3.7112 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/5.42,12.0897/),(/1,2/))
real, dimension(8) :: bias1 = &
  (/0.85505,3.79,18.9861,-5.0725,17.178,-2.6176,17.883,-9.4013/)
real, dimension(2) :: bias2 = &
  (/8.3506,-5.0422/)
real, dimension(1) :: bias3 = &
  (/0.1083/)
contains
subroutine fnet_Victoria_intake_initall()
end subroutine fnet_Victoria_intake_initall
subroutine fnet_Victoria_intake_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  do i = 1, 126
    inarray2(i) = inarray(127-i)
  end do
  layer1 = MatMul(input,inarray2)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_Victoria_intake_engine
end module fnet_Victoria_intake
