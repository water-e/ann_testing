module fnet_antioch

! a = 8.5267e-005
! b = 0.087541

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/0.168777011870,-0.172690541827,0.057597638746,-0.413920154214,0.393525682080,0.319743946370,-0.012928292067,0.433909981015,-0.337979373575,0.236113643029,-0.092677059557,0.440648862026 &
            ,-0.507892451974,-0.305770039547,-0.018348978946,-0.117504711383,0.719057196404,0.231608599979,-0.243006622277,0.023618042475,0.507475678375,-1.087790062214,0.049580120505,-0.010885006861 &
            ,-0.425923433554,-0.251927938128,0.224833910881,-0.349510117187,-0.049130829069,1.354748582552,-0.131737214357,0.092212667646,0.099086186846,0.056701879488,-0.071207022165,0.139880211013 &
            ,-0.128112780768,-0.417442436308,0.141807321995,0.346926363647,-0.036224122627,0.280386981277,0.030504119380,0.472392896213,-0.168432552022,0.048642190092,-0.177637652219,-1.098353421065 &
            ,0.421974669596,-0.328140948316,0.020539070349,-0.839626047943,0.703512279142,-0.098115865252,0.089253397293,1.344472127614,0.165494355622,0.244986396618,-0.067312540454,0.439549246977 &
            ,-0.096580838919,-0.846993966488,0.008585000553,-0.445176307916,-0.297795823381,-0.120231850502,0.090117003887,-0.070458122111,-0.243267524087,0.974243895353,0.022875344938,0.195881170796 &
            ,0.465024450624,-0.125071818282,0.060715172999,-0.141879612900,0.421470203275,-0.871872368752,0.155625993166,0.236453727180,0.001685442089,0.013933109947,0.049384426861,0.069003140299 &
            ,0.010410201055,0.051582787144,-0.010148991214,-0.029276235873,-0.118652047536,-0.040500210851,0.105663289268,0.216085725407,-0.121642268481,0.082910177462,-0.026784964369,-0.692313759348 &
            ,0.100778466092,0.050974472096,-0.114823120653,-0.200123260793,0.133540141009,-0.023401228181,0.016915275082,0.542629001739,-0.052377283053,0.305103266161,-0.131638177981,0.099086409196 &
            ,-0.126561257871,-0.208318981621,-0.161788016859,0.076793397721,-0.018802989076,-0.181122817774,0.031212930325,-0.183009816996,0.122570015919,0.399842946621,0.090150866702,0.184443533832 &
            ,0.026349735190,0.044120124251,-0.014495562638,-0.016409323930,-0.011093852124,0.150702133936,-0.011259010586,0.019626767253,-0.125900120296,0.056079418979,-0.021565652323,0.063728281194 &
            ,-0.130925351189,0.269660992525,-0.029228920817,-0.097572181661,-0.038637315136,0.005052299628,-0.005570650650,0.149611208874,-0.089444841567,-0.227328264078,0.027864033903,-0.226257558120 &
            ,-0.937464804249,-0.610778519235,0.635493139566,-0.724188754553,-0.331525325068,2.007486865980,-0.438741360005,-0.759720068135,0.759693383384,0.452978015544,-0.576810863949,1.695993434969 &
            ,-0.687888571129,-2.495270088866,0.988510574814,-0.107819544292,-1.699536720222,0.049938738051,0.827435147830,0.388224277331,-1.267642260092,0.787147917676,-0.821452849499,-0.053246633212 &
            ,0.846083258468,-0.357466422065,0.546871739515,-0.549219801313,0.102837303258,0.913614594110,0.192176688062,1.103389352750,0.818785245418,1.403162443144,-0.727091336566,0.772900230453 &
            ,1.208137007264,-0.508384007150,-0.769275008530,-2.517981337358,-1.988926645680,-0.398580996094,1.033623038424,-0.321676775050,-1.864136169334,3.204188097111,-0.614634268301,0.105088331029 &
            ,-1.446910646111,-1.723773787710,0.236722821693,-0.099334103726,-0.409227885658,-1.315685058426,0.735703163276,0.771584442028,-0.170546991202,0.698772951287,0.287367702954,1.154839282015 &
            ,-1.187948773427,-0.819184396432,-0.176220206233,0.472095122842,1.000541000307,1.573558575209,-0.060068892243,1.069609647263,0.807428227319,-2.240247389246,-1.503955575239,-3.041064336259 &
            ,-0.499135562811,-1.715610355720,0.415814506997,-0.507106199601,-0.501819876322,2.755862952798,0.663487844183,0.281393324052,0.578524864060,-0.003385287383,0.004899082522,0.034849501894 &
            ,0.349576455411,-2.117045693483,0.231868595756,1.945889139364,0.410311774374,0.373296158518,-0.234434189764,0.462907473691,0.069049983432,-1.627158117807,0.027835209090,0.037020446519 &
            ,0.377548924322,0.634114249714,-0.240690873703,-0.048035968142,0.310475191583,0.007934608330,-0.449200795165,0.037317789732,0.154164120620,0.052367305145,0.253179936497,0.030969895974 &
            ,-0.207808433508,0.096267896159,-0.137955601781,0.125549245438,-0.216550316321,-0.148908408512,-0.143352058916,-0.543987707316,0.316007104529,0.578665961815,-0.094682959740,0.563116497118 &
            ,-0.857462222244,-0.636148853666,-0.279881867139,-0.280205254507,-0.688349925091,0.622601905220,0.573314538511,0.737700030633,-0.131667058861,0.324289323861,-0.383075643063,-0.501079110907 &
            ,0.702990385080,0.924075547436,-0.446217822958,0.081801225672,0.069616423912,0.412817130116,0.232607750720,-0.464093924568,-0.099342504023,2.224159579083,-0.613913941043,0.259056547395 &
            ,0.333930304400,-0.610524828435,-0.126927867384,-0.103332724991,0.803862812140,-0.619819477315,0.565028274535,-0.708137519806,-1.789885708468,-0.518249283181,0.467786511088,0.182748914684 &
            ,-1.002535435107,2.820718101511,0.131650819121,-1.134205452340,1.558219011278,0.529589752692,-0.924513783031,-1.235546734422,1.543284700971,-0.039433299569,0.232812905842,1.406947437168 &
            ,0.232780680501,-0.069678149508,-0.295080902812,-0.862107807720,0.030593130409,-0.571545279084,-0.058211231858,2.819725440286,0.460306293372,2.062261757855,-0.788539279046,0.605766446422 &
            ,-0.056165929949,-0.068147984110,-1.180483639162,-1.648764656008,0.700643961812,0.710668283568,0.044273643295,-0.182381822941,0.167869408717,1.132148401828,-0.581331423521,0.396547878400 &
            ,2.624321951061,0.511853206148,-0.471220863323,0.165479588369,2.320706019617,-4.057877656629,0.014907715611,-1.249302073224,0.966001648112,-1.041134057309,0.596312983092,-0.530634528693 &
            ,2.266984822219,-1.521625152617,-0.120857082121,-0.009345455020,-0.585589470848,-0.951589236689,-0.028810939595,0.202158984092,-0.776503325436,0.010130733053,1.330498366411,-1.089045879885 &
            ,-2.426778654875,-3.003135025888,0.968247779673,0.441627311204,-3.122821021897,-0.432942783810,2.209574384310,0.367449958477,-0.887545157286,0.080778876467,0.111726346188,0.275185365322 &
            ,-0.944960339047,0.615879629148,-0.129355461518,-0.547123436853,0.400220804219,-0.070382958122,-0.096929325486,-0.043505738543,0.100982717055,-1.117390115653,0.315575943422,0.859546069963 &
            ,-0.690242222454,0.009669020461,0.061388427207,0.606161494383,-0.868500317701,-0.472705915242,0.035034693618,-1.010204376140,-0.453965272646,-0.164228216848,-0.134872611942,0.033437092476 &
            ,-0.273417519847,0.836844894469,0.183619212708,-0.422214344733,-0.499003345765,-0.188296623925,0.397404392983,0.530672745008,-0.986387604067,0.436449051233,0.134812238866,-0.865523929207 &
            ,-0.112685380724,-0.231491098954,-0.272347418546,-0.342009084673,0.146162032524,0.368790695988,0.241698873091,0.312880267119,-0.385676816930,-0.250539347604,0.117877680266,-0.047171480971 &
            ,-0.232913749802,0.628079837300,0.000089626654,-0.264647520041,-0.404385780105,0.436506604775,-0.105714271334,0.642080859172,-0.794017356208,-1.301729832382,-0.276883798739,-0.396341976645 &
            ,0.090811690533,1.556131593597,-0.684194154578,-0.128960598499,0.879129747930,-3.357007079832,-1.593487000547,-2.760723522260,1.149538406471,-0.171441492260,1.303366482009,1.237980705587 &
            ,0.054629667169,-1.620830769705,-0.113513342782,-1.610859424213,-1.273881447769,-0.446445752496,-0.609491719949,0.508046135240,-0.225266924715,0.026286798888,0.552605436263,-0.579791145991 &
            ,-0.775634618155,1.088350699917,-1.767000018369,-0.870643531357,-0.083312667940,0.626717863146,0.008062102797,-0.519664965396,0.627285889366,0.832907837326,-1.804658833998,1.559215890068 &
            ,0.674608130866,0.043559102010,0.961878763636,1.419341994123,2.831437057904,0.326032991346,0.393880403370,-0.229419091454,0.063756957050,0.006058668923,1.348296869950,2.554960007142 &
            ,-0.169537440651,-1.306515636927,1.174411351835,-4.431061113952,0.381995018589,0.717336702760,-0.941232879442,1.148689877098,-0.327759931231,-0.961171914284,0.430762325863,-2.448959653752 &
            ,1.178825100993,-0.079486965838,0.128601649523,1.639340623769,-1.052317588882,1.849973446222,-3.575612011109,-1.556355059173,-1.174708649806,0.190229137059,2.321724469973,1.290608934457 &
            ,0.229281547951,1.577008599038,-0.810732665060,3.315501586834,1.568243347466,1.932202801315,2.668649914788,1.314185156341,-0.824147962441,1.304583043015,-0.022698364155,0.601722035456 &
            ,1.553812181458,1.301032031898,-1.807822779982,0.184098142747,-0.164264686106,1.585214567059,-0.382504131242,-0.866670887900,0.665500956039,1.233621116796,-1.211679186262,-0.379026987706 &
            ,0.325007738453,1.362710821420,-0.182997914381,-0.956444230859,0.182272986373,1.166811349518,-0.920412030453,-0.544405574497,0.032051879285,0.955664540361,0.514821755975,0.014556778236 &
            ,0.139038082290,1.003927685144,-0.951861325135,-0.337110034520,-1.042637958075,0.955128501250,1.183058671966,1.013223232937,0.398622294375,0.750388312604,-0.438881364008,0.061905182660 &
            ,-1.187266849298,-0.031293806811,0.886386682766,1.617144382040,0.304730947740,0.538050011073,-0.538899222748,0.767010822852,-0.583202662965,0.533319255208,0.411179036266,0.016677248504 &
            ,-0.663463575809,0.317219561739,0.973279040241,1.154372683548,1.088785145955,-0.322884921061,-0.593257516231,-2.138831670773,-2.397265138992,0.133422509975,0.113200059167,0.831915787851 &
            ,1.110785402416,-0.098056964171,-1.334748444577,0.547965186145,0.505677167255,1.955472125870,1.833581739503,2.006156069608,-0.317845427611,0.300176924286,2.313239608586,-2.618493217756 &
            ,-1.345140000136,0.522727212556,-2.181380246735,3.082720411434,-1.647675441197,-1.026275455496,-1.302906868034,-3.642420209982,1.962497106082,-0.593305572714,-0.001178332071,0.914068471056 &
            ,2.969630498297,-1.118167413545,0.692533491199,0.004037505345,1.627557579741,-0.963804595278,1.248983763889,-0.678220833067,0.805195698691,0.865135040008,-1.221675188322,-3.044424811101 &
            ,1.315442508240,-2.202589840532,-0.207413470745,1.896089549839,-0.626022126748,3.475306166341,-3.785388376575,-3.747139173154,-0.452565240790,0.069416650636,-0.313166892590,0.943483292616 &
            ,-3.926285209369,1.814901087749,-4.889472054895,-2.488851276586,0.182112884335,1.252774077734,1.324469832435,3.274245520566,-3.538900739067,4.111759129229,-8.201403101178,-7.172261894834 &
            ,0.080528391235,0.781813886310,3.505326862118,0.310735283333,-3.260894422043,2.869594959807,-8.346883618245,-2.323458878161,2.821779361491,0.936018268540,7.489709553242,2.109435013191 &
            ,1.777047607544,2.230367372931,2.074056054765,-4.752569783725,2.478094426843,0.169133685077,8.489972643671,3.103245725632,1.773416871645,-1.948869090817,4.295841542561,0.791184263604 &
            ,1.355660430822,0.029890649434,2.605569915538,5.236909791900,1.497033844865,-0.732593978808,3.386445925770,-0.754902181156,0.720014549955,0.130065083633,2.025427742594,4.026361187729 &
            ,0.497139766009,-0.961911665382,1.624838174261,-0.231237710566,0.581786142791,0.404948731265,1.316042485944,2.627671491392,0.096900288171,-1.635294840068,2.707599398455,-1.005904527814 &
            ,0.193721638852,0.897204413782,1.116721120537,0.637490112586,-0.520519330650,-1.701400191949,3.718723398922,-2.065088349622,0.125015252106,1.614731088641,0.932998120196,-1.058234614147 &
            ,-1.493172380701,-2.683477209688,3.501434775011,-1.697886923939,0.466864721408,2.203429863562,0.946394823715,-1.309968735705,0.016455502006,-1.673598776320,1.269250903050,-1.161607917772 &
            ,0.884879991133,2.957247172257,1.084115686804,0.118528062360,1.224205464056,4.839043106709,0.080780772201,-0.529076460925,-1.179594404005,5.310495642341,-4.471569949599,1.247941109720 &
            ,-0.413161106783,-1.542898481655,0.727018142202,-0.668946591849,-0.107088722708,2.047940505435,0.610335558785,-0.950597955126,-0.400259428680,0.514991516922,-0.464702493256,0.118013273103 &
            ,-0.397712738110,-1.531535298116,-0.169672945367,1.255438939969,0.054357297231,0.025014816698,-0.216557025904,0.080575445150,0.353182121964,0.873787696332,0.142754472003,0.307968140912 &
            ,-0.462747179624,1.678056318794,-0.563388450194,0.678159280521,-0.739389878275,-0.168766496073,-1.166964243473,-1.491653474431,-0.140944177481,-1.457813866268,1.079245564209,0.209032566288 &
            ,-0.589398498045,-0.435184151361,0.834440133572,0.580399244069,0.061871692038,-1.220938554747,0.290691880224,-0.501721234330,0.430124567942,1.410661255261,0.771105772847,0.858197488577 &
            ,-0.988128684533,1.058947432380,-0.041061035172,0.212808696144,-0.352393153380,1.318733102134,-1.484431866518,-1.702418246106,1.307818660770,-1.381520100735,0.473566563338,0.373855822198 &
            ,0.731214953078,-2.158526796496,1.179893368522,0.207694260719,-0.381143221054,0.382637100538,0.332116926938,1.017907322452,-1.197759558551,0.450761979494,-0.494810724985,-0.318918953042 &
            ,0.127658129645,0.124192421038,-0.186212936893,-0.878047532790,0.543110358085,1.221385628908,-0.975499533896,1.200307617693,-0.119715833680,-0.444313499735,0.169263297586,-0.038850085830 &
            ,0.074438274548,0.030067911502,0.060723080626,-0.517402561598,0.016384723531,-0.425751949465,0.065869035339,-0.287768767185,0.398017644019,0.370601912290,-0.007527241274,-0.759559377808 &
            ,-0.278296317657,-0.095530082387,-0.079874354760,-0.205825093573,-0.115094325400,0.434761613200,-0.117491967503,0.073483029982,-0.115124514855,-0.188144697164,-0.260621140139,-0.128925373738 &
            ,0.029399082390,0.527928516492,0.199962146989,0.339624868240,-0.014524500592,-0.081202017230,-0.195285910230,-0.037702327660,-0.128523533356,-0.374895831816,0.109451690057,0.402101078280 &
            ,0.371796448070,0.333915576872,-0.163767608713,0.704962781104,-0.378726908319,-1.873080493538,0.073101330038,-0.193337227222,-0.183116756720,0.403395978344,-0.354797121111,0.804380802367 &
            ,-0.748672621784,-0.370027986394,0.076175215190,-0.827824710629,-0.098154530270,-0.538903711038,0.108800812162,-0.333816599086,0.374597799459,1.104290323384,0.249154207688,0.307904040167 &
            ,0.016526341704,0.438102474290,-0.081935288256,0.535621172749,-0.115693912972,-0.490807144145,-0.247324989931,-0.995051254301,-0.146812155692,-0.277218071433,0.328602320694,0.104903124876 &
            ,-0.067454822369,0.220661219136,0.042913906083,0.048002186223,0.131598331402,0.079580246405,-0.039317518731,0.146595459491,-0.217261794992,-0.169950815818,0.077714639403,-0.352756973071 &
            ,-0.295099952230,0.098133342158,0.032077037618,0.213375617475,-0.567860579370,-0.365107532986,-0.039869207912,-0.134940167568,0.006863030734,0.069151093983,-0.111118547576,0.208722899991 &
            ,-0.212276994019,-0.876786415167,0.147678834023,0.505237796376,-0.332740498183,0.230956474882,-0.044221158094,0.365680802032,-0.488210013410,-0.041216391593,-0.134680086707,-0.673621740599 &
            ,0.141106291388,-0.010199673981,0.106177846040,0.260398832270,-0.077061605764,-0.197308858556,0.073210282739,-0.368216983926,0.296395448052,0.062294475544,-0.059610323412,-0.667575611818 &
            ,0.453271547895,0.332334963428,-0.157197411697,1.092421579443,0.102232880543,-0.003702130295,-0.066791500227,0.114576840334,-0.043083992112,-0.110119715668,0.106794180885,-0.156341266155 &
            ,-0.103346637077,0.016711035766,0.117625356061,0.295535082954,-0.160463418675,-0.587581607451,-0.055896170207,-0.555886113890,-0.153212547497,0.004829752233,-0.070931269306,0.000299037301 &
            ,-0.145209149186,0.347329503073,0.030550457177,-0.038876435254,-0.065838795472,-0.070418836034,0.047808686817,-0.005819132318,-0.047208592976,0.211508936167,0.018578493225,-0.051315914388 &
            ,-0.083804559077,0.043994187516,0.016967767374,0.049109141069,-0.080692411376,0.133643463503,-0.048176695363,-0.030651676100,0.026277800450,0.153695519503,-0.048933915570,0.019187499315 &
            ,0.051483919913,-0.097036676919,-0.115218983190,-0.014600786073,-0.148762712303,0.092235129607,-0.073466307025,0.053872564487,-0.125192290587,0.122743019103,-0.052488121903,-0.127370694381 &
            ,0.000262456462,0.101963646767,-0.023666392756,0.044634753926,-0.017966014863,-0.013498858171,-0.063968164641,-0.068768279767,0.031573772906,0.088208604327,0.002454584537,-0.092958887887 &
            ,0.038895129952,0.128736201602,-0.089098786828,0.204191211857,0.040322252618,-0.019946855826,-0.013995527958,0.037783954896,-0.054173275450,-0.206606848054,0.075658995944,0.052006559367 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/3.5071,6.5736 &
            ,-2.064,-8.8332,0.1479,-9.1905 &
            ,-4.2186,9.1324 &
            ,0.94089,-6.331 &
            ,1.0815,4.8453 &
            ,4.464,-9.2401 &
            ,0.60379,5.4695 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/0.67552,6.7977/),(/1,2/))
real, dimension(8) :: bias1 = &
  (/2.144,-0.89192,0.82974,-0.054998,0.58265,0.84916,-2.665,1.7849/)
real, dimension(2) :: bias2 = &
  (/0.9024,0.95216/)
real, dimension(1) :: bias3 = &
  (/-0.56861/)
contains
subroutine fnet_antioch_initall()
end subroutine fnet_antioch_initall
subroutine fnet_antioch_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  do i = 1, 126
    inarray2(i) = inarray(127-i)
  end do
  layer1 = MatMul(input,inarray2)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_antioch_engine
end module fnet_antioch
