module fnet_JP

! a = 0.0002308
! b = 0.06699

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/-0.212156601026,-0.016455859684,0.007048296099,0.712874451828,-1.371499778029,0.074465160583,-0.165738256022,0.169851557874,0.210407273678,-0.113380916000,-0.023557948025,-0.608606990194 &
            ,1.077049573588,0.017625012424,0.218915624939,-0.179557500750,-0.042944111905,0.075990970587,-0.036410324229,-0.582582213664,0.396313030053,-0.061684421005,0.196760186261,-0.137816318620 &
            ,-0.304774558279,0.035580325603,-0.030979241547,0.664514547251,-0.780518821736,-0.033515137329,-0.211879995244,0.097497241470,0.092071152544,-0.024971040883,0.054364433012,0.084661200437 &
            ,0.072103811137,0.086497607331,-0.143079456771,0.119768064344,-0.069563526850,-0.042487163022,-0.110387079753,0.500542261122,0.064918464064,-0.001417771757,0.001898304285,0.168686198352 &
            ,-0.189947663482,-0.259304434225,0.026146213033,-0.024946948085,-0.759194370513,0.197271918868,0.036846413105,-0.223372808062,0.193919180571,-0.009486325317,0.045790170167,-0.014889665277 &
            ,0.159025531628,0.037711818946,-0.155429383320,0.206845691031,-0.094297345906,0.347270563616,-0.039023160433,-0.309083444754,0.123269348976,-0.289007680255,0.051745815376,0.030908230128 &
            ,-0.113862051581,-0.338989437787,0.037471028797,-0.316957709013,-0.029801968890,0.205795993608,-0.092554108942,-0.229746534076,0.259376103456,0.167731983972,0.010829935943,-0.067192036061 &
            ,0.408062600345,-0.124809423572,0.003043932918,0.195144704626,0.045899157408,0.059677099145,-0.018852616344,-0.085873834239,0.389619708423,-0.041878598654,0.092932661740,-0.000724436866 &
            ,-0.224463087759,-0.147611653357,-0.039895380473,0.412929788533,-0.349917024265,0.150764068967,-0.021945558579,0.003109240957,0.429669526759,-0.318316398524,-0.105949340949,-1.978103670789 &
            ,4.188927524114,0.194075585983,0.038462680306,-0.127573739328,-0.057572262951,-0.024513464242,0.020508473382,-0.241138405560,0.250127205125,-0.000330827150,-0.069706892324,-0.120239482769 &
            ,-0.068403263167,0.035988665418,-0.016014511347,0.090257480517,-0.012768511050,-0.006493287799,-0.015792634589,0.040808448054,0.015640275169,0.016213439104,0.024567537082,0.063548989277 &
            ,-0.165278701547,-0.008435572778,0.031270057972,-0.035661312885,0.160545884380,-0.072457231326,0.059659273496,0.287454864284,-0.274575877982,0.093094693868,0.048865303537,0.021205006732 &
            ,0.453915424154,0.800640210375,-0.003796423999,-1.000024991870,0.538262337327,-0.580780244453,0.352764149657,0.246411515358,-2.087146992017,-1.411099463372,-0.955393001604,-0.102863847517 &
            ,1.373611570411,0.341581580345,-0.453123881038,-0.343662370993,0.192294583190,0.495065540758,0.680217229881,0.272145854081,-0.987643802550,0.082989166006,0.019856125779,-0.649001366076 &
            ,0.199030449510,0.855181133628,0.010195174940,1.368119932142,-0.398450542182,-0.788929869644,-0.693528765914,0.761389488901,-0.497882731804,-1.045769011898,-0.415157678531,3.479779661138 &
            ,-4.869649631288,0.837201950238,-1.422585888584,1.900821611824,0.012823123694,1.867595496791,0.425986164817,3.801252670806,-2.955436469979,-0.724384815881,-0.526915411025,1.136602109830 &
            ,2.053396571626,0.744035213866,0.421019944541,-2.888057367130,1.416271190877,-0.588238492717,-0.562956065816,0.368928372836,1.340624858899,0.337378356956,0.407381642611,0.118896581425 &
            ,-0.326981312684,-0.201829075437,-0.281383730011,0.247095190252,0.427850418633,-0.769862397484,0.027829381106,2.727793722729,-1.849887099651,0.883518164718,-0.519150345820,0.781646351675 &
            ,-1.597042672591,0.790808253097,-0.515418897029,0.239152855244,-2.924089378472,-0.141432560482,0.535941734556,-0.414377720393,-0.799487665082,0.226770556681,-0.366430691600,0.152759535126 &
            ,0.896347240122,-0.141483565096,0.168386428939,0.084550116382,0.516138266390,-0.451214461375,0.038062173644,-0.671513451156,0.158046072791,0.160693348949,0.027081783394,-0.111085096788 &
            ,0.827883211815,0.930487410362,-0.217908215516,-0.454480560295,0.572755211416,-0.827446551659,-0.274103939741,1.388478215145,-0.041976713856,0.889611833511,-0.246806996166,-0.724027194878 &
            ,2.371561699782,-0.939770475994,0.185842010080,0.203767969580,0.315722737920,0.506065057087,0.201747441886,-0.024214706657,-0.457869470974,-0.087127982245,0.383541362529,-0.054607292091 &
            ,0.519067931961,-0.229865128882,0.377288648431,0.531250574484,-0.122235581623,0.434793279946,-0.120267354190,-0.223270018399,-0.240859104906,-0.315061805197,0.146714431558,1.616371649170 &
            ,-2.509269139938,0.469476047960,-0.097797821315,-0.025190654087,-0.000079154729,-0.015427908515,-0.094633359271,-0.297171145774,-1.006236878856,-0.057260749821,0.239967925823,-0.100971395542 &
            ,1.654242282623,-0.688494078419,0.168397895668,0.209766162516,-0.815245760180,0.947605004410,0.391707269305,1.027241688274,1.009551407512,0.939104985333,0.562410177089,-0.313720287305 &
            ,-2.397879049884,-0.795197148672,-0.210898416121,0.132349502358,2.065830569713,-2.217476973920,0.787846741553,0.596317846151,-0.495483357538,2.134224597336,0.159032590959,-0.204629054036 &
            ,0.686299941468,-0.021634132324,0.978260296751,2.052957645501,-2.881402674153,0.558594139638,-0.543990084881,-0.737688501152,-0.743124548087,-1.135043510583,-0.034575893652,1.195234074918 &
            ,-0.296874917296,1.067856823067,0.665222082361,-0.893942322907,-2.350944751545,0.583959081401,-0.068569723421,2.006293470585,0.355371419023,-0.329381310310,-0.227012476795,-1.157227146885 &
            ,-0.506950989095,-0.600812183952,-0.591926579617,0.078354138373,3.861704190117,0.572938722851,0.549540772946,0.406265819894,-2.117852132726,2.332942776745,-0.985030777317,-1.415923249234 &
            ,1.752046566314,-1.963320570168,0.213882542060,0.786012159852,1.479497433381,0.110169187238,-0.030142678416,-4.760757147285,5.768090012048,-0.818419439350,-0.071982936147,-0.013117086925 &
            ,2.561108148486,1.506189222332,0.852361362043,-2.421132217012,1.923552650506,-1.394888011037,-1.095097824350,0.188725897858,-0.307279503915,0.078331174222,0.031763106912,0.613330736229 &
            ,-0.892800441812,-0.107492190030,-0.009931367819,-0.169144827200,0.517060266522,-0.537072110711,0.125840635278,-0.921053771993,1.442928744143,0.217043893321,-0.080645301887,-0.361173797581 &
            ,0.455567775451,0.324071460412,0.350920111882,-0.040024113250,-0.001190523374,-0.148678019242,-0.205758287475,-0.163004647086,0.264909569840,0.007067588878,-0.007065088261,-0.333353172960 &
            ,-0.127973784252,-0.024705057074,-0.078268267723,0.234304385583,-0.160675454534,0.344534473261,-0.012329144092,-0.135885941013,0.079686366038,-0.211514324195,-0.002557200078,0.042349376683 &
            ,0.475051886848,-0.324451132497,0.123359363537,-0.163901699360,-0.080980787887,0.193985497202,-0.005850773178,-0.117559163093,-0.449622390820,-0.029785116757,-0.110674649489,0.245332703997 &
            ,-0.353497609614,0.006780621627,-0.027348026392,-0.091921396376,0.253980564757,0.271017259013,0.079889830716,-0.640161553342,0.293493624292,-0.156999894444,0.118077279471,-0.104841978165 &
            ,0.131556094940,-3.927332388079,-0.154629843258,5.583904489299,-2.967605899694,2.852572058228,-0.991116055157,0.838774563794,1.116822052226,1.145779902049,0.673362936623,3.819718512696 &
            ,-6.682167597414,-0.851761179916,-1.142703844884,1.169440365613,-1.428352857287,0.251324702783,-0.534712022970,-0.369725310356,-0.482910131812,1.432413127370,1.340731259053,1.286544071825 &
            ,-4.633000323153,0.723756091107,-0.885581650970,-3.027448984822,-1.439926038030,-1.067825519384,1.371012062227,-3.046525795289,-3.938975370592,-2.745939835660,-3.787153714839,0.620982436680 &
            ,5.421363769776,0.461137641945,-1.106293249348,4.754118736445,-1.516922300709,-1.100014198273,-1.233969819105,-4.328168959368,6.346460811226,0.475838715676,1.903469376222,-0.960997090959 &
            ,6.081362782196,1.166380182907,1.195338427580,-5.305288489052,0.501488816188,-1.534328177833,3.122470037618,-0.574902289716,-3.103123600540,0.311316631784,0.641863644587,1.827964197619 &
            ,4.012873698727,1.209471521206,3.014385372894,-0.300077218821,-0.603250124801,5.310071695739,2.063943212518,9.191502926343,1.649782051861,-4.374625924382,-0.584356494788,0.385761659753 &
            ,-7.388301628088,1.829317313200,2.638211767938,-1.934231571740,-6.466970692161,1.687321886896,-5.066315647918,-0.151117264840,-1.933988132952,-0.518915143090,-0.228463125114,-0.907838192978 &
            ,-1.865384989861,-0.360299822765,-1.270785390241,-1.188489682781,0.682053179898,-0.291664236732,0.082109619658,0.632582494775,-0.363614269494,-0.385257838939,1.335416337307,0.397151605856 &
            ,2.068101483326,-0.715472262563,-0.860721929528,0.963370751763,0.050414878251,-0.655398265078,1.152109041031,2.597194575480,1.450948759010,-0.613480909686,-0.287708505996,0.579211124010 &
            ,-0.574385477790,-1.575903505049,-0.717561345815,3.089638086300,0.416275940201,1.484216756444,0.065716584510,0.844187871896,-1.417098531182,0.037071210897,-1.876073915818,0.740294902852 &
            ,-0.680700762019,1.265417048037,2.383534357635,2.061811684964,-1.913665382215,0.712123054480,-0.639812113493,-0.095770156177,0.215480181436,-2.305245528915,-0.450550805648,3.359348412537 &
            ,-1.978206353472,0.173474935047,-0.298673510048,-0.954179946444,2.902323938986,-1.600187224666,1.321795092830,3.789074193560,-2.551133499482,1.941252993826,1.227911065784,-0.801564333031 &
            ,1.383674567281,-1.167765801921,0.054974127935,-1.623725969619,4.520829219870,1.030784871133,1.126258558847,-0.039421744283,2.604947314828,-0.409969199455,0.247624723816,-1.558679059294 &
            ,-1.267843533178,-0.944765416489,3.503697906798,-1.389422682142,2.388864384325,1.318640649416,1.677022494220,-1.320296631905,1.151031309848,-0.572637430789,0.817929702823,-1.231324688199 &
            ,-0.874620671805,0.498564581347,0.000522456897,-0.660759961217,5.213940082926,0.649492373392,-0.791133049935,0.894241979221,1.498209318154,-6.786951340362,-3.083090886492,2.266324337192 &
            ,5.341022267840,1.922220010802,5.855415763246,1.862519548825,-3.204953404033,1.201787248936,-0.529355192655,1.370806719955,6.426833487351,1.477935103567,4.675239555514,1.858622385420 &
            ,-7.984005086702,-2.453712744222,-6.032158651676,-2.395462817955,-0.426334146598,-2.080399320284,4.679744184546,4.463734130492,-2.171280070482,-2.209009184065,-1.226576710923,-3.072264505923 &
            ,1.348492641628,1.044639184885,18.011730652146,0.227248390031,1.879523342122,3.130231659161,5.050633986175,-3.043209629527,0.671842459421,-5.282973204660,3.735932392884,-1.718809960180 &
            ,-2.151667629309,4.182770785804,6.237426767208,-1.122900106773,2.858547075901,-11.142381138511,-13.005450152263,5.056926002883,-2.947736272041,3.445436355953,0.140613193080,-5.093413474192 &
            ,5.971506994600,-3.087513509634,-6.130440072254,2.850444398571,0.823945361852,2.228957594387,0.267598162617,-2.639390925353,5.463308043519,-4.370621246104,-1.967788990736,0.989813504702 &
            ,3.215540548503,1.365143816699,0.567708335405,-0.135949619843,3.690037930214,-3.369987426658,-0.913372800923,2.299257296612,-0.304205025204,2.294853023967,0.126636335370,-2.420057900577 &
            ,2.721443446981,-2.709271207907,-1.645363991540,-0.332911359032,0.211863134084,1.910546393463,1.024426145121,-3.192065211254,2.972582641365,-4.624611921753,0.819977334242,-2.041142790496 &
            ,0.304729590278,1.102304816623,1.094557705671,-1.731811283117,0.057723721396,-0.158644408954,3.707815457145,-3.679347815450,-0.893156429875,0.708906605104,-0.364470568107,0.741643744706 &
            ,-3.876222400724,-2.154039513912,-0.385648507802,0.932302682691,-2.094211951038,1.726617068023,0.125456626326,4.124175854113,-8.622208075845,0.079947268033,-0.250388957550,0.271306193226 &
            ,0.854156171523,0.943673058829,0.089037918793,-2.439137559167,3.763041605158,-0.935188052262,0.012088489656,-0.012130375262,-0.154315661736,-0.940195814577,0.137348709417,1.128246758624 &
            ,-1.960638868781,0.826609278822,-0.115607312955,-0.338658875775,-1.124568458100,-0.424830056548,-0.532496568020,-1.398525410065,0.434367959534,-0.003330827070,0.467943349516,-0.580339794849 &
            ,1.842806324967,-0.188187985876,0.461982762601,-0.311980427621,1.659649339402,0.199518778908,-0.198858836703,0.320495717816,-1.049240984414,1.562355483081,-0.144258589179,-0.305481340608 &
            ,-0.557157934958,-1.041015431441,-0.384303092995,0.227835783159,1.029284091587,-0.350166300778,0.256169132719,-1.383598306688,1.066585712890,-0.008870619346,-0.068515345191,-0.570143863285 &
            ,0.087070592181,0.530284750856,0.239855062005,0.131934603726,-0.943884026732,-0.304197761732,-0.063233995428,-0.450525223601,0.635296096154,-0.241251690658,0.327070523938,0.315565374807 &
            ,1.258498763614,0.321184697767,-1.194273569065,-0.137676046366,0.096362342587,0.235571540134,-0.096501895003,-0.685605257007,0.347601989103,0.046582265988,-0.275764561984,-0.175882327885 &
            ,0.726646114770,1.672083628444,-0.084410966259,-1.228198239059,0.210598086710,-1.030019545088,0.484211852409,-0.267657243212,0.519194504190,-0.259849926255,-0.162763705154,0.539732692197 &
            ,-0.467052610929,0.362545457680,0.162189333413,0.678340563433,0.604608410781,-0.109206781406,-0.132653820683,-0.176104496780,0.437773519133,0.084028863433,0.332180684837,0.351901935843 &
            ,-0.589934383920,0.115498109015,-0.091910509856,-0.741428559568,-0.310083437210,-0.132036900481,0.543553154057,-0.846619907526,0.103711423878,-0.307868538151,-0.116567754195,1.059844277605 &
            ,-1.070591285121,0.579699054025,0.237563752499,0.487306596617,0.320961186743,0.486928252581,-0.047621651404,-0.100763203159,0.888283484661,-0.313107905418,-0.179989220277,0.425324488208 &
            ,0.005775392984,-0.147787092319,-0.029036591822,-0.721468846901,1.016625221729,0.115886177066,0.195910355357,-0.407377187482,0.073084909303,0.669086518755,-0.243540676819,-0.704479123493 &
            ,0.679779508646,-0.615399134906,-0.085812493437,0.459635275047,-0.296456467366,-0.132903014680,0.064367962015,0.257602520582,-1.383157030475,0.147256665855,0.005591375391,-0.324175876799 &
            ,-0.657873212348,-0.082106155269,-0.066516566935,1.657084049432,-2.186841894798,0.221101826303,-0.368745612064,0.342156176868,-0.387519548281,0.245898982471,-0.193435364385,0.744646228590 &
            ,-0.432977054594,-0.181634069571,-0.181076510782,0.430269624308,0.201724148357,0.114669758924,0.042684109707,0.114705745937,0.363246352474,-0.027175044833,-0.268998090028,0.320837873439 &
            ,-0.124109020640,0.079462424681,-0.050855998689,0.187030313505,-0.524757964766,-0.080657325692,0.069573361454,0.046830757703,-0.132252576682,0.084977457933,0.011494487496,0.348805298815 &
            ,-0.377104689262,-0.048505795427,0.042467737348,-0.036889989013,0.076131197521,0.015366991317,0.004029004364,0.429517778399,-0.598789358627,0.040275705062,-0.044558715221,0.219974010908 &
            ,-0.403328758173,-0.233527727032,-0.108127563111,0.530062654250,-0.329365399206,0.218061415221,-0.162736173437,0.117753859824,0.166877781280,0.051012237613,-0.033676617748,0.582129246929 &
            ,-0.732963175114,0.016038913882,-0.083308894912,0.454834480265,-0.115316359087,-0.178893485232,-0.145672626911,-0.123869033947,0.399616799160,0.140553433131,0.066260021669,0.132503603728 &
            ,-0.383273383046,-0.126589078434,-0.137231596922,0.437053871685,-0.496120937020,0.108095053071,0.199455030709,0.016254947262,-0.013317169164,-0.038499586271,0.008945546337,-0.266602198550 &
            ,0.469947849494,0.029448235136,0.085619852497,-0.150974240109,-0.015727953683,-0.098488284496,0.002431199746,-0.022278532401,-0.153993277376,0.126717186883,0.111830123042,-0.052186178531 &
            ,-0.050501103057,-0.260908171170,0.076226808999,0.232294315410,-0.430194245387,0.247735283171,-0.052771998999,-0.155158380606,0.108926679123,-0.013672756422,0.058255865967,0.019613394369 &
            ,0.010499729056,0.000695264458,-0.074819267608,-0.004460268830,0.034699479974,-0.059589375989,0.043185751065,0.184609225944,-0.204478615765,0.078226083651,-0.046067837819,0.020829387891 &
            ,-0.002728457830,0.025814643871,-0.011771558008,0.060486023630,-0.170001108745,0.018479074861,0.038187653047,0.089680700263,-0.074812836321,-0.157299648351,-0.019814259359,0.116678325976 &
            ,-0.061734681107,0.114420124667,-0.002388909890,-0.004876634175,-0.106739947232,-0.079577081931,-0.015320895752,0.071396072193,-0.144717321132,0.093964621077,0.036852367455,-0.021672957415 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/-0.60873,7.0082 &
            ,-0.7098,11.1291,0.61185,-20.7084 &
            ,-0.087925,2.5766 &
            ,0.7788,-1.2921 &
            ,-0.77804,13.0463 &
            ,-0.33415,-8.2318 &
            ,-1.3423,-8.8904 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/0.17077,4.7124/),(/1,2/))
real, dimension(8) :: bias1 = &
  (/-1.907,-4.7449,-0.93351,-0.68873,3.2992,4.1726,1.6709,-5.7976/)
real, dimension(2) :: bias2 = &
  (/2.7826,7.1355/)
real, dimension(1) :: bias3 = &
  (/-0.034638/)
contains
subroutine fnet_JP_initall()
end subroutine fnet_JP_initall
subroutine fnet_JP_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  do i = 1, 126
    inarray2(i) = inarray(127-i)
  end do
  layer1 = MatMul(input,inarray2)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_JP_engine
end module fnet_JP
